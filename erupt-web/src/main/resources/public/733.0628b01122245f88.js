"use strict";(self.webpackChunkerupt=self.webpackChunkerupt||[]).push([[733],{7733:(te,oe,c)=>{c.r(oe),c.d(oe,{FlowModule:()=>Sa});var l=c(4341),be=c(1626),D=c(1391),v=c(513),x=c(1011),k=c(6122),R=c(7094),z=c(1951),ie=c(8852),Q=c(8927),y=c(1997),K=c(2986),I=c(3190),Z=c(8960),ve=c(2513),f=c(7481),G=c(1166),_=c(4327),w=c(2358),g=c(2096),N=c(2874),j=c(5154),xe=c(1236),re=c(5703),je=c(9448),_n=c(7685),Ve=c(7529),un=c(6351),we=c(1868),gn=c(3062),Y=c(9541),P=c(3359),mn=c(4331),Me=c(9438),De=c(3146),H=c(5699),fn=c(7064),ae=c(2983),hn=c(1912),Cn=c(3617),bn=c(6504),vn=c(2542),se=c(1672),xn=c(2e3),wn=c(7120),Mn=c(8182),zn=c(4696),yn=c(1217),On=c(512),Fn=c(3493),Tn=c(3069),En=c(8928),ze=c(2047),e=c(7705);const Nn=["nodeNameInput"];function Pn(t,a){if(1&t&&(e.qex(0),e.nrm(1,"span",16),e.bVm()),2&t){const n=e.XpG();e.R7$(1),e.Y8G("nzTooltipTitle",n.modelValue.error)("nzTwotoneColor","#FF4D4F")}}function kn(t,a){1&t&&e.nrm(0,"span",17)}function In(t,a){if(1&t){const n=e.RV6();e.j41(0,"input",18,19),e.bIt("blur",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.onBlur())})("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.modelValue.name=o)}),e.k0s()}if(2&t){const n=e.XpG();e.Y8G("ngModel",n.modelValue.name)}}function Gn(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",20),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.onEnableEdit())}),e.EFF(1),e.k0s()}if(2&t){const n=e.XpG();e.R7$(1),e.SpI("",n.modelValue.name," ")}}function Sn(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",21)(1,"span",22),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.onDelete())}),e.k0s()()}}function Rn(t,a){1&t&&e.nrm(0,"span",23)}function jn(t,a){if(1&t){const n=e.RV6();e.j41(0,"app-insert-btn",24),e.bIt("insertNode",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.onInsertNode(o))})("insertFlexNode",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.onInsertFlexNode(o))}),e.k0s()}}let Be=(()=>{class t{constructor(){this.insertFlexNode=new e.bkB,this.moveLn=!1,this.moveRn=!1,this.type="",this.color="",this.headerIcon="",this.content="",this.readonly=!1,this.showError=!1,this.errorInfo="",this.isDefault=!1,this.placeholder="\u8bf7\u8bbe\u7f6e",this.desc="",this.modelValueChange=new e.bkB,this.select=new e.bkB,this.delete=new e.bkB,this.insertNode=new e.bkB,this.copy=new e.bkB,this.moveL=new e.bkB,this.moveR=new e.bkB,this.enableEdit=!1}ngAfterViewInit(){}onEnableEdit(){this.readonly||(this.enableEdit=!0,setTimeout(()=>{this.nodeNameInput&&this.nodeNameInput.nativeElement.focus()}))}onBlur(){this.enableEdit=!1}onSelect(){this.modelValue.error=null,this.select.emit()}onDelete(){this.delete.emit()}onInsertNode(n){this.insertNode.emit(n)}onInsertFlexNode(n){this.insertFlexNode.emit(n)}onCopy(){this.copy.emit()}onMoveL(){this.moveL.emit()}onMoveR(){this.moveR.emit()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-branch-node"]],viewQuery:function(i,o){if(1&i&&e.GBs(Nn,5),2&i){let r;e.mGM(r=e.lsd())&&(o.nodeNameInput=r.first)}},inputs:{eruptBuild:"eruptBuild",moveLn:"moveLn",moveRn:"moveRn",type:"type",color:"color",headerIcon:"headerIcon",content:"content",readonly:"readonly",modelValue:"modelValue",showError:"showError",errorInfo:"errorInfo",isDefault:"isDefault",placeholder:"placeholder",desc:"desc",progress:"progress"},outputs:{insertFlexNode:"insertFlexNode",modelValueChange:"modelValueChange",select:"select",delete:"delete",insertNode:"insertNode",copy:"copy",moveL:"moveL",moveR:"moveR"},decls:20,vars:14,consts:[[1,"p-node"],[4,"ngIf"],[1,"p-node-body",3,"ngClass"],[1,"p-node-move",3,"click"],["nz-icon","","nzType","left",4,"ngIf"],[2,"flex","1"],[1,"p-node-header"],["autofocus","",3,"ngModel","blur","ngModelChange",4,"ngIf"],["class","row-text",3,"click",4,"ngIf"],["class","node-action",4,"ngIf"],["nzType","secondary","nzSize","small",1,"node-desc"],[1,"p-node-content",3,"click"],["nzEllipsis","","nzEllipsisRows","4"],["nz-icon","","nzType","right",4,"ngIf"],[1,"p-node-add"],[3,"insertNode","insertFlexNode",4,"ngIf"],["nz-tooltip","","nz-icon","","nzType","warning","nzTheme","twotone",1,"node-err-tip",3,"nzTooltipTitle","nzTwotoneColor"],["nz-icon","","nzType","left"],["autofocus","",3,"ngModel","blur","ngModelChange"],["nodeNameInput",""],[1,"row-text",3,"click"],[1,"node-action"],[1,"fa","fa-close",3,"click"],["nz-icon","","nzType","right"],[3,"insertNode","insertFlexNode"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.DNE(1,Pn,2,2,"ng-container",1),e.j41(2,"div",2)(3,"div",3),e.bIt("click",function(){return o.onMoveL()}),e.DNE(4,kn,1,0,"span",4),e.k0s(),e.j41(5,"div",5)(6,"div",6)(7,"div"),e.DNE(8,In,2,1,"input",7),e.DNE(9,Gn,2,1,"div",8),e.k0s(),e.DNE(10,Sn,2,0,"div",9),e.j41(11,"nz-typography",10),e.EFF(12),e.k0s()(),e.j41(13,"div",11),e.bIt("click",function(){return!o.readonly&&o.onSelect()}),e.j41(14,"nz-typography",12),e.EFF(15),e.k0s()()(),e.j41(16,"div",3),e.bIt("click",function(){return o.onMoveR()}),e.DNE(17,Rn,1,0,"span",13),e.k0s()(),e.j41(18,"div",14),e.DNE(19,jn,1,0,"app-insert-btn",15),e.k0s()()),2&i&&(e.R7$(1),e.Y8G("ngIf",null==o.modelValue?null:o.modelValue.error),e.R7$(1),e.xc7("--shadowColor",o.color),e.Y8G("ngClass",null==o.progress?null:o.progress[o.modelValue.id]),e.R7$(2),e.Y8G("ngIf",!o.readonly&&o.moveLn&&!o.isDefault),e.R7$(3),e.xc7("color",o.isDefault?"#898989":o.color),e.R7$(1),e.Y8G("ngIf",o.enableEdit),e.R7$(1),e.Y8G("ngIf",!o.enableEdit),e.R7$(1),e.Y8G("ngIf",!o.readonly&&!o.isDefault),e.R7$(2),e.JRh(o.desc),e.R7$(3),e.SpI(" ",o.content||o.placeholder," "),e.R7$(2),e.Y8G("ngIf",!o.readonly&&o.moveRn&&!o.isDefault),e.R7$(2),e.Y8G("ngIf",!o.readonly))},styles:['.p-node[_ngcontent-%COMP%]{width:200px;margin-bottom:8px;position:relative}.p-node[_ngcontent-%COMP%]   .node-err-tip[_ngcontent-%COMP%]{position:absolute;right:-30px;top:5px;color:#ff4d4f}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]{cursor:pointer;background:white;overflow:hidden;border-radius:5px;display:flex;align-items:center;justify-content:space-between;box-shadow:0 0 5px #d8d8d8}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-move[_ngcontent-%COMP%]{width:15px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-move[_ngcontent-%COMP%]:hover{background:#F5F6F6}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]:hover{box-shadow:0 0 5px 0 var(--shadowColor)}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]:hover   .node-action[_ngcontent-%COMP%]{display:inline!important}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]:hover   .node-desc[_ngcontent-%COMP%]{display:none}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child, .p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child{height:100%}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child:hover, .p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child:hover{background:#d9d9d9}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:25px;font-size:13px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   .node-action[_ngcontent-%COMP%]{color:#767676;display:none}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   .node-action[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin:2px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   .node-desc[_ngcontent-%COMP%]{position:absolute;right:8px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   .row-text[_ngcontent-%COMP%]:hover{text-decoration:underline}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:3px;width:115px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:115px;border:1px solid #d9d9d9;border-radius:5px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-content[_ngcontent-%COMP%]{padding:5px;min-height:50px;display:flex;justify-content:space-between;align-items:center;font-size:15px;color:#656363}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{word-wrap:break-word}.p-node[_ngcontent-%COMP%]   .p-node-add[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:80px}.p-node[_ngcontent-%COMP%]   .p-node-add[_ngcontent-%COMP%]:before{position:absolute;content:"";width:2px;height:80px;background:#d9d9d9}.p-node[_ngcontent-%COMP%]   .p-node-add[_ngcontent-%COMP%]:after{content:"";position:absolute;top:80px;left:50%;transform:translate(-50%);width:0;border-style:solid;border-width:8px 6px 4px;border-color:#d9d9d9 transparent transparent}']})}}return t})();class X{createBranch(a){throw new Error("Method not implemented.")}}var h=function(t){return t.START="START",t.END="END",t.SUB="SUB",t.CC="CC",t.APPROVAL="APPROVAL",t.FlEX="FLEX",t.GATEWAY_PARALLEL="GATEWAY_PARALLEL",t.GATEWAY_INCLUSIVE="GATEWAY_INCLUSIVE",t.GATEWAY_EXCLUSION="GATEWAY_EXCLUSION",t.GATEWAY_BRANCH="GATEWAY_BRANCH",t.GATEWAY_JOIN="GATEWAY_JOIN",t}(h||{}),B=function(t){return t.PARALLEL_CONDITION="PARALLEL_CONDITION",t.CONDITION="CONDITION",t.ELSE="ELSE",t}(B||{});function O(){return Math.random().toString(36).slice(2,10).toUpperCase()}function le(t){t&&"object"==typeof t&&(t.id&&(t.id=O()),t.branch&&Array.isArray(t.branch)&&t.branch.forEach(a=>le(a)),t.props&&t.props.branch&&Array.isArray(t.props.branch)&&t.props.branch.forEach(a=>le(a)))}function A(t,a,n){t.splice(a+1,0,{id:O(),type:h.FlEX,flex:n.code,name:n.name,color:n.color})}function Ae(t){const a=["#667eea","#764ba2","#f093fb","#f5576c","#4facfe","#00f2fe","#43e97b","#38f9d7","#fa709a","#fee140","#a8edea","#fed6e3","#ffecd2","#fcb69f","#ff9a9e","#fecfef"];return a[t.charCodeAt(0)%a.length]}var ce=function(t){return t.PRE_SIGN="PRE_SIGN",t.POST_SIGN="POST_SIGN",t}(ce||{}),J=function(t){return t.SUBMITTER_HIMSELF="SUBMITTER_HIMSELF",t.ROLE="ROLE",t.POST="POST",t.SPECIFIED_USER="SPECIFIED_USER",t.ORG_HEAD="ORG_HEAD",t}(J||{}),ye=function(t){return t.ALL_APPROVE="ALL_APPROVE",t.ANY_APPROVE="ANY_APPROVE",t}(ye||{}),Oe=function(t){return t.REDIRECT_TO_ADMIN="REDIRECT_TO_ADMIN",t.REDIRECT_TO_SPECIFIED_USER="REDIRECT_TO_SPECIFIED_USER",t}(Oe||{});class $e{constructor(){this.reviewUserModes=[{mode:J.SUBMITTER_HIMSELF,modeValue:null}],this.formAccesses={},this.approvalStrategy=ye.ANY_APPROVE,this.nobodyStrategy=Oe.REDIRECT_TO_ADMIN,this.allowTransfer=!0,this.allowAddSign=!0,this.allowCc=!0,this.allowReturn=!0,this.requireApprovalNote=!1,this.requireSignature=!1,this.approvalTimeoutEnabled=!1}}var Ye=function(t){return t.AUTO_PASS="AUTO_PASS",t.AUTO_REJECT="AUTO_REJECT",t}(Ye||{});class Xe{constructor(){this.reviewUserModes=[{mode:J.SUBMITTER_HIMSELF,modeValue:null}],this.formAccesses={}}}class Le{constructor(){this.formAccesses={}}}class Ue{constructor(){this.mappings=[],this.mappingsReverse=[]}}var He=function(t){return t.ORG="ORG",t.USER="USER",t.ROLE="ROLE",t.POST="POST",t}(He||{});class Vn{constructor(){this.users=[],this.posts=[],this.roles=[],this.orgs=[]}}var p=c(309),pe=c(4275);let Fe=(()=>{class t{constructor(n){this._http=n}posts(){return this._http.get(p.eY.erupt+"/flow/upms/posts")}roles(){return this._http.get(p.eY.erupt+"/flow/upms/roles")}users(){return this._http.get(p.eY.erupt+"/flow/upms/users")}org(){return this._http.get(p.eY.erupt+"/flow/upms/orgs")}static{this.\u0275fac=function(i){return new(i||t)(e.KVO(pe.p4))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac})}}return t})(),W=(()=>{class t{constructor(n){this.flowUpmsApiService=n,this.upmsData=new Vn,this.flowUpmsApiService.users().subscribe(i=>{this.upmsData.users=i.data}),this.flowUpmsApiService.posts().subscribe(i=>{this.upmsData.posts=i.data}),this.flowUpmsApiService.roles().subscribe(i=>{this.upmsData.roles=i.data}),this.flowUpmsApiService.org().subscribe(i=>{this.upmsData.orgs=i.data})}static{this.\u0275fac=function(i){return new(i||t)(e.KVO(Fe))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac})}}return t})();var Te=c(6447),d=c(177),M=c(6389),T=c(5930),$=c(9252),de=function(t){return t.ALL="ALL",t.MANAGER="MANAGER",t.SPECIFIC="SPECIFIC",t.NO="NO",t}(de||{});class Dn{constructor(){this.channels=[],this.icon="fa fa-user",this.color="#1890ff",this.permission=de.ALL,this.setting=new Bn}}class Bn{constructor(){this.subTitleFields=[]}}var C=function(t){return t.ORG="ORG",t.USER="USER",t.ROLE="ROLE",t.POST="POST",t}(C||{}),E=function(t){return t.DEFAULT="DEFAULT",t.READONLY="READONLY",t.READ_WRITE="READ_WRITE",t.NOT_NULL="NOT_NULL",t.HIDE="HIDE",t}(E||{});function An(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"tr")(2,"td"),e.EFF(3),e.k0s(),e.j41(4,"td")(5,"nz-radio-group",5),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG().$implicit,s=e.XpG();return e.Njj(s.formAccesses[r.fieldName]=o)}),e.j41(6,"div",2),e.nrm(7,"label",6)(8,"label",6)(9,"label",7)(10,"label",6),e.k0s()()()(),e.bVm()}if(2&t){const n=e.XpG().$implicit,i=e.XpG();e.R7$(3),e.JRh(n.eruptFieldJson.edit.title),e.R7$(2),e.Y8G("ngModel",i.formAccesses[n.fieldName])("nzDisabled",n.eruptFieldJson.edit.readOnly.add),e.R7$(2),e.Y8G("nzValue",i.FormAccessEnum.READONLY),e.R7$(1),e.Y8G("nzValue",i.FormAccessEnum.READ_WRITE),e.R7$(1),e.Y8G("nzValue",i.FormAccessEnum.NOT_NULL)("nzDisabled",n.eruptFieldJson.edit.type==i.EditType.DIVIDE||n.eruptFieldJson.edit.type==i.EditType.TPL||n.eruptFieldJson.edit.type==i.EditType.EMPTY),e.R7$(1),e.Y8G("nzValue",i.FormAccessEnum.HIDE)}}function $n(t,a){if(1&t&&(e.qex(0),e.DNE(1,An,11,8,"ng-container",4),e.bVm()),2&t){const n=a.$implicit;e.R7$(1),e.Y8G("ngIf",n.eruptFieldJson.edit.title&&n.eruptFieldJson.edit.show)}}const Yn=function(){return{}},Xn=function(t){return[t]},Ln=function(){return[]};let Ee=(()=>{class t{constructor(){this.formAccesses={},this.access=E.READONLY,this.FormAccessEnum=E,this.EditType=p.zl}ngOnInit(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-form-access"]],inputs:{eruptBuild:"eruptBuild",formAccesses:"formAccesses",access:"access"},decls:16,vars:8,consts:[["nzHideOnSinglePage","",3,"nzData","nzSize"],[3,"nzWidth"],[2,"display","flex","gap","50px","justify-content","space-evenly"],[4,"ngFor","ngForOf"],[4,"ngIf"],[2,"width","100%",3,"ngModel","nzDisabled","ngModelChange"],["nz-radio","",3,"nzValue"],["nz-radio","",3,"nzValue","nzDisabled"]],template:function(i,o){1&i&&(e.j41(0,"nz-table",0)(1,"thead")(2,"tr")(3,"th",1),e.EFF(4,"\u8868\u5355\u5b57\u6bb5"),e.k0s(),e.j41(5,"th",2)(6,"span"),e.EFF(7,"\u53ea\u8bfb"),e.k0s(),e.j41(8,"span"),e.EFF(9,"\u7f16\u8f91"),e.k0s(),e.j41(10,"span"),e.EFF(11,"\u5fc5\u586b"),e.k0s(),e.j41(12,"span"),e.EFF(13,"\u9690\u85cf"),e.k0s()()()(),e.j41(14,"tbody"),e.DNE(15,$n,2,1,"ng-container",3),e.k0s()()),2&i&&(e.Y8G("nzData",o.eruptBuild.eruptModel.eruptFieldModels.length?e.eq3(5,Xn,e.lJ4(4,Yn)):e.lJ4(7,Ln))("nzSize","small"),e.R7$(3),e.Y8G("nzWidth","260px"),e.R7$(12),e.Y8G("ngForOf",o.eruptBuild.eruptModel.eruptFieldModels))},dependencies:[d.Sq,d.bT,l.BC,l.vS,P.CP,P.SO,P._4,P.IL,P.aj,P.kt,I.lx,I.i3]})}}return t})();function Un(t,a){1&t&&e.nrm(0,"hr",7)}function Hn(t,a){if(1&t&&e.nrm(0,"nz-option",12),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function Jn(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",8)(1,"div",9),e.EFF(2,"\u63d0\u4ea4\u4eba\u7684"),e.k0s(),e.j41(3,"nz-select",10),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reviewUserMode.modeValue=o)}),e.DNE(4,Hn,1,2,"nz-option",11),e.k0s()()}if(2&t){const n=e.XpG();e.R7$(3),e.Y8G("ngModel",n.reviewUserMode.modeValue),e.R7$(1),e.Y8G("ngForOf",n.deptHeads)}}function Wn(t,a){if(1&t&&e.nrm(0,"nz-option",12),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function qn(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",8)(1,"div",9),e.EFF(2,"\u89d2\u8272"),e.k0s(),e.j41(3,"nz-select",10),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reviewUserMode.modeValue=o)}),e.DNE(4,Wn,1,2,"nz-option",11),e.k0s()()}if(2&t){const n=e.XpG();e.R7$(3),e.Y8G("ngModel",n.reviewUserMode.modeValue),e.R7$(1),e.Y8G("ngForOf",n.roles)}}function Qn(t,a){if(1&t&&e.nrm(0,"nz-option",12),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function Kn(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",8)(1,"div",9),e.EFF(2,"\u5c97\u4f4d"),e.k0s(),e.j41(3,"nz-select",10),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reviewUserMode.modeValue=o)}),e.DNE(4,Qn,1,2,"nz-option",11),e.k0s()()}if(2&t){const n=e.XpG();e.R7$(3),e.Y8G("ngModel",n.reviewUserMode.modeValue),e.R7$(1),e.Y8G("ngForOf",n.posts)}}function Zn(t,a){if(1&t&&e.nrm(0,"nz-option",12),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function et(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",8)(1,"div",9),e.EFF(2,"\u6307\u5b9a\u4eba\u5458"),e.k0s(),e.j41(3,"nz-select",10),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reviewUserMode.modeValue=o)}),e.DNE(4,Zn,1,2,"nz-option",11),e.k0s()()}if(2&t){const n=e.XpG();e.R7$(3),e.Y8G("ngModel",n.reviewUserMode.modeValue),e.R7$(1),e.Y8G("ngForOf",n.users)}}let Je=(()=>{class t{constructor(n){this.upmsDataService=n,this.ApprovalMode=J,this.users=[],this.posts=[],this.roles=[],this.deptHeads=[]}ngOnInit(){this.users=this.upmsDataService.upmsData.users,this.posts=this.upmsDataService.upmsData.posts,this.roles=this.upmsDataService.upmsData.roles;for(let n=0;n<=10;n++)this.deptHeads.push({key:n,value:"\u76f4\u5c5e\u7ec4\u7ec7\u8d1f\u8d23\u4eba"+(0==n?"":`\u52a0 ${n} \u7ea7\u8d1f\u8d23\u4eba`)})}changeReview(){this.reviewUserMode.modeValue=null}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(W))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-review-user"]],inputs:{reviewUserMode:"reviewUserMode"},decls:20,vars:11,consts:[[2,"display","flex","justify-content","space-between","align-items","center","margin-bottom","8px"],[2,"font-weight","500"],[1,"approval-mode"],[2,"width","100%",3,"ngModel","ngModelChange"],["nz-radio","",3,"nzValue"],["style","border: 1px solid #f0f0f0;margin: 8px 0;",4,"ngIf"],["style","display: flex;align-items:center",4,"ngIf"],[2,"border","1px solid #f0f0f0","margin","8px 0"],[2,"display","flex","align-items","center"],[2,"margin-right","12px"],["nzShowSearch","",2,"flex","1",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1),e.EFF(2,"\u5ba1\u6279\u4eba\u8bbe\u7f6e"),e.k0s()(),e.j41(3,"div",2)(4,"nz-radio-group",3),e.bIt("ngModelChange",function(s){return o.reviewUserMode.mode=s})("ngModelChange",function(){return o.changeReview()}),e.j41(5,"label",4),e.EFF(6,"\u7ec4\u7ec7\u8d1f\u8d23\u4eba"),e.k0s(),e.j41(7,"label",4),e.EFF(8,"\u89d2\u8272"),e.k0s(),e.j41(9,"label",4),e.EFF(10,"\u5c97\u4f4d"),e.k0s(),e.j41(11,"label",4),e.EFF(12,"\u6307\u5b9a\u4eba\u5458"),e.k0s(),e.j41(13,"label",4),e.EFF(14,"\u63d0\u4ea4\u4eba\u672c\u4eba"),e.k0s()()(),e.DNE(15,Un,1,0,"hr",5),e.DNE(16,Jn,5,2,"div",6),e.DNE(17,qn,5,2,"div",6),e.DNE(18,Kn,5,2,"div",6),e.DNE(19,et,5,2,"div",6)),2&i&&(e.R7$(4),e.Y8G("ngModel",o.reviewUserMode.mode),e.R7$(1),e.Y8G("nzValue",o.ApprovalMode.ORG_HEAD),e.R7$(2),e.Y8G("nzValue",o.ApprovalMode.ROLE),e.R7$(2),e.Y8G("nzValue",o.ApprovalMode.POST),e.R7$(2),e.Y8G("nzValue",o.ApprovalMode.SPECIFIED_USER),e.R7$(2),e.Y8G("nzValue",o.ApprovalMode.SUBMITTER_HIMSELF),e.R7$(2),e.Y8G("ngIf",o.reviewUserMode.mode!=o.ApprovalMode.SUBMITTER_HIMSELF),e.R7$(1),e.Y8G("ngIf",o.reviewUserMode.mode==o.ApprovalMode.ORG_HEAD),e.R7$(1),e.Y8G("ngIf",o.reviewUserMode.mode==o.ApprovalMode.ROLE),e.R7$(1),e.Y8G("ngIf",o.reviewUserMode.mode==o.ApprovalMode.POST),e.R7$(1),e.Y8G("ngIf",o.reviewUserMode.mode==o.ApprovalMode.SPECIFIED_USER))},dependencies:[d.Sq,d.bT,l.BC,l.vS,y.ld,y.WI,I.lx,I.i3],styles:["[_nghost-%COMP%]     .allow-item{margin-bottom:5px}  .approval-mode label{width:31%;margin-bottom:8px}"]})}}return t})();function nt(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){e.eBV(n);const o=e.XpG().index,r=e.XpG(2);return e.Njj(r.deleteReviewUser(o))}),e.nrm(1,"span",20),e.k0s()}2&t&&e.Y8G("nz-tooltip","\u5220\u9664\u5ba1\u6279\u4eba")}function tt(t,a){if(1&t&&(e.qex(0),e.j41(1,"nz-card",14)(2,"div",15)(3,"div",16),e.nrm(4,"app-review-user",17),e.k0s(),e.DNE(5,nt,2,1,"button",18),e.k0s()(),e.bVm()),2&t){const n=a.$implicit,i=e.XpG(2);e.R7$(4),e.Y8G("reviewUserMode",n),e.R7$(1),e.Y8G("ngIf",i.approveNode.reviewUserModes.length>1)}}function ot(t,a){if(1&t&&e.nrm(0,"nz-option",24),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function it(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",21)(1,"nz-select",22),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.approveNode.nobodyRedirectToUser=o)}),e.DNE(2,ot,1,2,"nz-option",23),e.k0s()()}if(2&t){const n=e.XpG(2);e.R7$(1),e.Y8G("ngModel",n.approveNode.nobodyRedirectToUser),e.R7$(1),e.Y8G("ngForOf",n.upmsDataService.upmsData.users)}}function rt(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",25)(1,"nz-input-number",26),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.approveNode.approvalTimeoutHours=o)}),e.k0s(),e.j41(2,"span",27),e.EFF(3," \u5c0f\u65f6\u540e \u2192 "),e.k0s(),e.j41(4,"nz-radio-group",8),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.approveNode.approvalTimeoutAction=o)}),e.j41(5,"label",9),e.EFF(6,"\u81ea\u52a8\u540c\u610f"),e.k0s(),e.j41(7,"label",9),e.EFF(8,"\u81ea\u52a8\u62d2\u7edd"),e.k0s()()()}if(2&t){const n=e.XpG(2);e.R7$(1),e.Y8G("ngModel",n.approveNode.approvalTimeoutHours)("nzMin",1)("nzStep",1),e.R7$(3),e.Y8G("ngModel",n.approveNode.approvalTimeoutAction),e.R7$(1),e.Y8G("nzValue",n.ApprovalTimeoutAction.AUTO_PASS),e.R7$(2),e.Y8G("nzValue",n.ApprovalTimeoutAction.AUTO_REJECT)}}function at(t,a){if(1&t){const n=e.RV6();e.qex(0),e.DNE(1,tt,6,2,"ng-container",4),e.j41(2,"button",5),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.addReviewUsers())}),e.nrm(3,"span",6),e.EFF(4," \u6dfb\u52a0\u5ba1\u6279\u4eba "),e.k0s(),e.nrm(5,"nz-divider",7),e.j41(6,"div")(7,"h4"),e.EFF(8,"\u5ba1\u6279\u4eba\u4e0d\u5b58\u5728\u65f6"),e.k0s(),e.j41(9,"nz-radio-group",8),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.approveNode.nobodyStrategy=o)}),e.j41(10,"label",9),e.EFF(11,"\u8f6c\u4ea4\u7ed9\u7ba1\u7406\u5458"),e.k0s(),e.j41(12,"label",9),e.EFF(13,"\u8f6c\u4ea4\u5230\u6307\u5b9a\u5ba1\u6279\u4eba"),e.k0s(),e.DNE(14,it,3,2,"div",10),e.k0s()(),e.nrm(15,"nz-divider",7),e.j41(16,"div")(17,"h4"),e.EFF(18,"\u591a\u4eba\u5ba1\u6279\u65f6\u4f7f\u7528\u7684\u5ba1\u6279\u65b9\u5f0f"),e.k0s(),e.j41(19,"nz-radio-group",8),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.approveNode.approvalStrategy=o)}),e.j41(20,"label",11),e.EFF(21,"\u6216\u7b7e\uff08\u4e00\u540d\u5ba1\u6279\u4eba\u540c\u610f\u5373\u53ef\uff09"),e.k0s(),e.j41(22,"label",12),e.EFF(23,"\u4f1a\u7b7e\uff08\u9700\u6240\u6709\u5ba1\u6279\u4eba\u540c\u610f\uff09"),e.k0s()()(),e.nrm(24,"nz-divider",7),e.j41(25,"div")(26,"h4"),e.EFF(27,"\u5ba1\u6279\u8d85\u65f6\u8bbe\u7f6e"),e.k0s(),e.j41(28,"nz-switch",8),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.approveNode.approvalTimeoutEnabled=o)}),e.k0s(),e.DNE(29,rt,9,6,"div",13),e.k0s(),e.bVm()}if(2&t){const n=e.XpG();e.R7$(1),e.Y8G("ngForOf",n.approveNode.reviewUserModes),e.R7$(8),e.Y8G("ngModel",n.approveNode.nobodyStrategy),e.R7$(1),e.Y8G("nzValue",n.NobodyStrategy.REDIRECT_TO_ADMIN),e.R7$(2),e.Y8G("nzValue",n.NobodyStrategy.REDIRECT_TO_SPECIFIED_USER),e.R7$(2),e.Y8G("ngIf",n.approveNode.nobodyStrategy==n.NobodyStrategy.REDIRECT_TO_SPECIFIED_USER),e.R7$(5),e.Y8G("ngModel",n.approveNode.approvalStrategy),e.R7$(1),e.Y8G("nzValue",n.ApprovalStrategy.ANY_APPROVE),e.R7$(2),e.Y8G("nzValue",n.ApprovalStrategy.ALL_APPROVE),e.R7$(6),e.Y8G("ngModel",n.approveNode.approvalTimeoutEnabled),e.R7$(1),e.Y8G("ngIf",n.approveNode.approvalTimeoutEnabled)}}function st(t,a){if(1&t&&(e.qex(0),e.nrm(1,"app-form-access",28),e.bVm()),2&t){const n=e.XpG();e.R7$(1),e.Y8G("eruptBuild",n.eruptBuild)("formAccesses",n.approveNode.formAccesses)}}function lt(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"div",29)(2,"label",30),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.approveNode.allowTransfer=o)}),e.EFF(3,"\u5141\u8bb8\u8f6c\u4ea4"),e.k0s()(),e.j41(4,"div",29)(5,"label",30),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.approveNode.allowAddSign=o)}),e.EFF(6,"\u5141\u8bb8\u52a0\u7b7e"),e.k0s()(),e.j41(7,"div",29)(8,"label",30),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.approveNode.allowCc=o)}),e.EFF(9,"\u5141\u8bb8\u6284\u9001"),e.k0s()(),e.j41(10,"div",29)(11,"label",30),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.approveNode.allowReturn=o)}),e.EFF(12,"\u5141\u8bb8\u9000\u56de"),e.k0s()(),e.j41(13,"div",29)(14,"label",30),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.approveNode.requireSignature=o)}),e.EFF(15,"\u5ba1\u6279\u540c\u610f\u65f6\u9700\u624b\u5199\u7b7e\u540d"),e.k0s()(),e.j41(16,"div",29)(17,"label",30),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.approveNode.requireApprovalNote=o)}),e.EFF(18,"\u63d0\u4ea4\u5ba1\u6279\u9700\u586b\u5199\u5ba1\u6279\u610f\u89c1"),e.k0s()(),e.bVm()}if(2&t){const n=e.XpG();e.R7$(2),e.Y8G("ngModel",n.approveNode.allowTransfer),e.R7$(3),e.Y8G("ngModel",n.approveNode.allowAddSign),e.R7$(3),e.Y8G("ngModel",n.approveNode.allowCc),e.R7$(3),e.Y8G("ngModel",n.approveNode.allowReturn),e.R7$(3),e.Y8G("ngModel",n.approveNode.requireSignature),e.R7$(3),e.Y8G("ngModel",n.approveNode.requireApprovalNote)}}const ct=function(){return["\u8bbe\u7f6e\u5ba1\u6838\u4eba","\u8868\u5355\u6743\u9650","\u64cd\u4f5c\u6743\u9650"]};let We=(()=>{class t extends X{constructor(n){super(),this.upmsDataService=n,this.readonly=!1,this.branch=[],this.index=0,this.modelValueChange=new e.bkB,this.select=new e.bkB,this.delete=new e.bkB,this.insertNode=new e.bkB,this.approveNode=new $e,this.selectTab=0,this.ApprovalStrategy=ye,this.NobodyStrategy=Oe,this.ApprovalTimeoutAction=Ye}ngOnInit(){this.modelValue.prop&&(this.approveNode=this.modelValue.prop)}addReviewUsers(){this.approveNode.reviewUserModes.push({mode:J.SPECIFIED_USER,modeValue:null})}deleteReviewUser(n){this.approveNode.reviewUserModes.length>1&&this.approveNode.reviewUserModes.splice(n,1)}type(){return h.APPROVAL}name(){return"\u5ba1\u6279\u4eba"}color(){return"#EC8151"}onSelect(){}onDelete(){this.delete.emit({branch:this.branch,index:this.index})}onInsertNode(n){this.insertNode.emit({branch:this.branch,index:this.index,type:n})}onInsertFlexNode(n){A(this.branch,this.index,n)}create(){return{id:O(),type:this.type(),name:this.name(),prop:new $e}}onSaveProp(){this.modelValue.prop=this.approveNode}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(W))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-approval-node"]],inputs:{readonly:"readonly",eruptBuild:"eruptBuild",modelValue:"modelValue",branch:"branch",index:"index",progress:"progress"},outputs:{modelValueChange:"modelValueChange",select:"select",delete:"delete",insertNode:"insertNode"},features:[e.Vt3],decls:7,vars:12,consts:[[3,"model","readonly","headerColor","eruptBuild","progress","modelChange","select","insertNode","insertFlexNode","saveProp","delete"],["config",""],[2,"margin-bottom","12px",3,"nzOptions","ngModel","ngModelChange"],[4,"ngIf"],[4,"ngFor","ngForOf"],["nz-button","",2,"margin-bottom","12px",3,"click"],["nz-icon","","nzType","plus","nzTheme","outline"],[2,"margin","12px 0"],[3,"ngModel","ngModelChange"],["nz-radio","",3,"nzValue"],["style","width: 100%;margin-top: 8px",4,"ngIf"],["nz-radio","",2,"width","100%",3,"nzValue"],["nz-radio","",2,"width","100%","margin-top","8px",3,"nzValue"],["style","margin-top: 12px",4,"ngIf"],["nzTitle","\u5ba1\u6279\u4eba","nzSize","small",2,"margin-bottom","12px"],[2,"display","flex","justify-content","space-between","align-items","flex-start"],[2,"flex","1"],[3,"reviewUserMode"],["nz-button","","nzType","text","nzDanger","","nzSize","small","style","margin-left: 8px;",3,"nz-tooltip","click",4,"ngIf"],["nz-button","","nzType","text","nzDanger","","nzSize","small",2,"margin-left","8px",3,"nz-tooltip","click"],["nz-icon","","nzType","delete","nzTheme","outline"],[2,"width","100%","margin-top","8px"],["nzShowSearch","",2,"width","100%",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[3,"nzValue","nzLabel"],[2,"margin-top","12px"],[2,"width","120px",3,"ngModel","nzMin","nzStep","ngModelChange"],[2,"margin","0 8px"],[3,"eruptBuild","formAccesses"],[1,"allow-item"],["nz-checkbox","",3,"ngModel","ngModelChange"]],template:function(i,o){1&i&&(e.j41(0,"erupt-node",0),e.bIt("modelChange",function(s){return o.modelValue=s})("select",function(){return o.onSelect()})("insertNode",function(s){return o.onInsertNode(s)})("insertFlexNode",function(s){return o.onInsertFlexNode(s)})("saveProp",function(){return o.onSaveProp()})("delete",function(){return o.onDelete()}),e.EFF(1),e.j41(2,"div",1)(3,"nz-segmented",2),e.bIt("ngModelChange",function(s){return o.selectTab=s}),e.k0s(),e.DNE(4,at,30,10,"ng-container",3),e.DNE(5,st,2,2,"ng-container",3),e.DNE(6,lt,19,6,"ng-container",3),e.k0s()()),2&i&&(e.Y8G("model",o.modelValue)("readonly",o.readonly)("headerColor",o.color())("eruptBuild",o.eruptBuild)("progress",o.progress),e.R7$(1),e.SpI(" ",o.name()," "),e.R7$(2),e.Y8G("nzOptions",e.lJ4(11,ct))("ngModel",o.selectTab),e.R7$(1),e.Y8G("ngIf",0==o.selectTab),e.R7$(1),e.Y8G("ngIf",1==o.selectTab),e.R7$(1),e.Y8G("ngIf",2==o.selectTab))},dependencies:[Te.sq,d.Sq,d.bT,l.BC,l.vS,v.aO,M.c,T.p,K.$g,j.LH,y.ld,y.WI,z.Dn,ze.FG,f.u,I.lx,I.i3,re.cK,je.j,$.Y,Ee,Je]})}}return t})();function pt(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",12),e.bIt("click",function(){e.eBV(n);const o=e.XpG().index,r=e.XpG(2);return e.Njj(r.deleteReviewUser(o))}),e.nrm(1,"span",13),e.k0s()}2&t&&e.Y8G("nz-tooltip","\u5220\u9664\u5ba1\u6279\u4eba")}function dt(t,a){if(1&t&&(e.qex(0),e.j41(1,"nz-card",7)(2,"div",8)(3,"div",9),e.nrm(4,"app-review-user",10),e.k0s(),e.DNE(5,pt,2,1,"button",11),e.k0s()(),e.bVm()),2&t){const n=a.$implicit,i=e.XpG(2);e.R7$(4),e.Y8G("reviewUserMode",n),e.R7$(1),e.Y8G("ngIf",i.ccNode.reviewUserModes.length>1)}}function _t(t,a){if(1&t){const n=e.RV6();e.qex(0),e.DNE(1,dt,6,2,"ng-container",4),e.j41(2,"button",5),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.addReviewUsers())}),e.nrm(3,"span",6),e.EFF(4," \u6dfb\u52a0\u6284\u9001 "),e.k0s(),e.bVm()}if(2&t){const n=e.XpG();e.R7$(1),e.Y8G("ngForOf",n.ccNode.reviewUserModes)}}function ut(t,a){if(1&t&&(e.qex(0),e.nrm(1,"app-form-access",14),e.bVm()),2&t){const n=e.XpG();e.R7$(1),e.Y8G("eruptBuild",n.eruptBuild)("formAccesses",n.ccNode.formAccesses)}}const gt=function(){return["\u8bbe\u7f6e\u6284\u9001\u4eba","\u8868\u5355\u6743\u9650"]};let qe=(()=>{class t extends X{constructor(){super(...arguments),this.readonly=!1,this.branch=[],this.index=0,this.modelValueChange=new e.bkB,this.select=new e.bkB,this.delete=new e.bkB,this.insertNode=new e.bkB,this.selectTab=0,this.ccNode=new Xe}ngOnInit(){this.modelValue.prop&&(this.ccNode=this.modelValue.prop)}deleteReviewUser(n){this.ccNode.reviewUserModes.length>1&&this.ccNode.reviewUserModes.splice(n,1)}addReviewUsers(){this.ccNode.reviewUserModes.push({mode:J.SPECIFIED_USER,modeValue:null})}onSelect(){this.select.emit(this.modelValue)}onDelete(){this.delete.emit({branch:this.branch,index:this.index})}onInsertNode(n){this.insertNode.emit({branch:this.branch,index:this.index,type:n})}type(){return h.CC}color(){return"#5994F3"}name(){return"\u6284\u9001\u4eba"}create(){return{id:O(),type:this.type(),name:this.name(),prop:new Xe}}onInsertFlexNode(n){A(this.branch,this.index,n)}onSaveProp(){this.modelValue.prop=this.ccNode}static{this.\u0275fac=function(){let n;return function(o){return(n||(n=e.xGo(t)))(o||t)}}()}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-cc-node"]],inputs:{readonly:"readonly",eruptBuild:"eruptBuild",modelValue:"modelValue",branch:"branch",index:"index",progress:"progress"},outputs:{modelValueChange:"modelValueChange",select:"select",delete:"delete",insertNode:"insertNode"},features:[e.Vt3],decls:6,vars:10,consts:[[3,"model","readonly","headerColor","eruptBuild","progress","modelChange","select","insertNode","insertFlexNode","saveProp","delete"],["config",""],[2,"margin-bottom","12px",3,"nzOptions","ngModel","ngModelChange"],[4,"ngIf"],[4,"ngFor","ngForOf"],["nz-button","",2,"margin-bottom","12px",3,"click"],["nz-icon","","nzType","plus","nzTheme","outline"],["nzTitle","\u6284\u9001\u4eba","nzSize","small",2,"margin-bottom","12px"],[2,"display","flex","justify-content","space-between","align-items","flex-start"],[2,"flex","1"],[3,"reviewUserMode"],["nz-button","","nzType","text","nzDanger","","nzSize","small","style","margin-left: 8px;",3,"nz-tooltip","click",4,"ngIf"],["nz-button","","nzType","text","nzDanger","","nzSize","small",2,"margin-left","8px",3,"nz-tooltip","click"],["nz-icon","","nzType","delete","nzTheme","outline"],[3,"eruptBuild","formAccesses"]],template:function(i,o){1&i&&(e.j41(0,"erupt-node",0),e.bIt("modelChange",function(s){return o.modelValue=s})("select",function(){return o.onSelect()})("insertNode",function(s){return o.onInsertNode(s)})("insertFlexNode",function(s){return o.onInsertFlexNode(s)})("saveProp",function(){return o.onSaveProp()})("delete",function(){return o.onDelete()}),e.EFF(1," \u6284\u9001\u4eba "),e.j41(2,"div",1)(3,"nz-segmented",2),e.bIt("ngModelChange",function(s){return o.selectTab=s}),e.k0s(),e.DNE(4,_t,5,1,"ng-container",3),e.DNE(5,ut,2,2,"ng-container",3),e.k0s()()),2&i&&(e.Y8G("model",o.modelValue)("readonly",o.readonly)("headerColor",o.color())("eruptBuild",o.eruptBuild)("progress",o.progress),e.R7$(3),e.Y8G("nzOptions",e.lJ4(9,gt))("ngModel",o.selectTab),e.R7$(1),e.Y8G("ngIf",0==o.selectTab),e.R7$(1),e.Y8G("ngIf",1==o.selectTab))},dependencies:[Te.sq,d.Sq,d.bT,l.BC,l.vS,v.aO,M.c,T.p,j.LH,z.Dn,re.cK,$.Y,Ee,Je]})}}return t})();var m=function(t){return t.STRING="STRING",t.NUMBER="NUMBER",t.DATE="DATE",t.BOOLEAN="BOOLEAN",t.CHOICE="CHOICE",t.REFERENCE="REFERENCE",t.UPMS="UPMS",t}(m||{}),_e=function(t){return t.EQ="EQ",t.NEQ="NEQ",t.LIKE="LIKE",t.NOT_LIKE="NOT_LIKE",t.START_WITH="START_WITH",t.END_WITH="END_WITH",t.IN="IN",t.NOT_IN="NOT_IN",t.NULL="NULL",t.NOT_NULL="NOT_NULL",t}(_e||{}),ue=function(t){return t.EQ="EQ",t.NEQ="NEQ",t.GT="GT",t.LT="LT",t.EGT="EGT",t.ELT="ELT",t.RANGE="RANGE",t.NULL="NULL",t.NOT_NULL="NOT_NULL",t}(ue||{}),ee=function(t){return t.TODAY="TODAY",t.FEW_DAYS="FEW_DAYS",t.FUTURE_DAYS="FUTURE_DAYS",t.RANGE="RANGE",t.GT="GT",t.LT="LT",t.EGT="EGT",t.ELT="ELT",t.NULL="NULL",t.NOT_NULL="NOT_NULL",t}(ee||{}),Ne=function(t){return t.EQ="EQ",t.NEQ="NEQ",t.NULL="NULL",t.NOT_NULL="NOT_NULL",t}(Ne||{}),Qe=function(t){return t.EQ="EQ",t.NEQ="NEQ",t}(Qe||{}),mt=c(9062),Ke=c(5566),q=c(7197);function ft(t,a){1&t&&(e.j41(0,"div",20)(1,"span",21),e.EFF(2,"\u6216"),e.k0s()())}function ht(t,a){if(1&t&&(e.j41(0,"span",22),e.EFF(1),e.k0s()),2&t){const n=e.XpG().index;e.R7$(1),e.SpI("\u6761\u4ef6\u7ec4 ",n+1,"")}}function Ct(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){e.eBV(n);const o=e.XpG(2).index,r=e.XpG();return e.Njj(r.removeConditionGroup(o))}),e.nrm(1,"i",25),e.k0s()}}function bt(t,a){if(1&t&&e.DNE(0,Ct,2,0,"button",23),2&t){const n=e.XpG(2);e.Y8G("ngIf",!n.requiredHasCondition||n.search.length>1)}}function vt(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",36)(1,"span",37),e.EFF(2,"\u4e14"),e.k0s(),e.j41(3,"button",24),e.bIt("click",function(){e.eBV(n);const o=e.XpG().index,r=e.XpG().index,s=e.XpG();return e.Njj(s.removeCondition(r,o))}),e.nrm(4,"i",25),e.k0s()()}}function xt(t,a){if(1&t&&e.nrm(0,"nz-option",38),2&t){const n=e.XpG(3);e.Y8G("nzValue",n.SUBMITTER)("nzLabel","\u63d0\u4ea4\u4eba")}}function wt(t,a){if(1&t&&(e.qex(0),e.nrm(1,"nz-option",38),e.bVm()),2&t){const n=e.XpG().$implicit;e.R7$(1),e.Y8G("nzValue",n.fieldName)("nzLabel",n.eruptFieldJson.edit.title)}}function Mt(t,a){if(1&t&&(e.qex(0),e.DNE(1,wt,2,2,"ng-container",39),e.bVm()),2&t){const n=a.$implicit,i=e.XpG(3);e.R7$(1),e.Y8G("ngIf",i.searchTypeMapping[n.eruptFieldJson.edit.type]&&(null==n.eruptFieldJson.edit?null:n.eruptFieldJson.edit.title))}}function zt(t,a){if(1&t&&(e.nrm(0,"nz-option",38),e.nI1(1,"translate")),2&t){const n=a.$implicit;e.Y8G("nzValue",n)("nzLabel",e.bMT(1,2,n))}}function yt(t,a){if(1&t&&(e.qex(0),e.DNE(1,zt,2,4,"nz-option",40),e.nI1(2,"enumToArray"),e.bVm()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,n.OperatorStringType))}}function Ot(t,a){if(1&t&&(e.nrm(0,"nz-option",38),e.nI1(1,"translate")),2&t){const n=a.$implicit;e.Y8G("nzValue",n)("nzLabel",e.bMT(1,2,n))}}function Ft(t,a){if(1&t&&(e.qex(0),e.DNE(1,Ot,2,4,"nz-option",40),e.nI1(2,"enumToArray"),e.bVm()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,n.OperatorNumberType))}}function Tt(t,a){if(1&t&&(e.nrm(0,"nz-option",38),e.nI1(1,"translate")),2&t){const n=a.$implicit;e.Y8G("nzValue",n)("nzLabel",e.bMT(1,2,n))}}function Et(t,a){if(1&t&&(e.qex(0),e.DNE(1,Tt,2,4,"nz-option",40),e.nI1(2,"enumToArray"),e.bVm()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,n.OperatorDateType))}}function Nt(t,a){if(1&t&&(e.nrm(0,"nz-option",38),e.nI1(1,"translate")),2&t){const n=a.$implicit;e.Y8G("nzValue",n)("nzLabel",e.bMT(1,2,n))}}function Pt(t,a){if(1&t&&(e.qex(0),e.DNE(1,Nt,2,4,"nz-option",40),e.nI1(2,"enumToArray"),e.bVm()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,n.OperatorReferenceType))}}function kt(t,a){if(1&t&&(e.nrm(0,"nz-option",38),e.nI1(1,"translate")),2&t){const n=a.$implicit;e.Y8G("nzValue",n)("nzLabel",e.bMT(1,2,n))}}function It(t,a){if(1&t&&(e.qex(0),e.DNE(1,kt,2,4,"nz-option",40),e.nI1(2,"enumToArray"),e.bVm()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,n.OperatorReferenceType))}}function Gt(t,a){if(1&t&&(e.nrm(0,"nz-option",38),e.nI1(1,"translate")),2&t){const n=a.$implicit;e.Y8G("nzValue",n)("nzLabel",e.bMT(1,2,n))}}function St(t,a){if(1&t&&(e.qex(0),e.DNE(1,Gt,2,4,"nz-option",40),e.nI1(2,"enumToArray"),e.bVm()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,n.OperatorReferenceType))}}function Rt(t,a){if(1&t&&(e.nrm(0,"nz-option",38),e.nI1(1,"translate")),2&t){const n=a.$implicit;e.Y8G("nzValue",n)("nzLabel",e.bMT(1,2,n))}}function jt(t,a){if(1&t&&(e.qex(0),e.DNE(1,Rt,2,4,"nz-option",40),e.nI1(2,"enumToArray"),e.bVm()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,n.OperatorUpmsType))}}const F=function(){return{standalone:!0}};function Vt(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"nz-input-number",43),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(3).$implicit;e.R7$(1),e.Y8G("ngModelOptions",e.lJ4(2,F))("ngModel",n.value)}}function Dt(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"div",44)(2,"nz-input-number",45),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value[0]=o)}),e.k0s(),e.j41(3,"span",46),e.EFF(4,"\u81f3"),e.k0s(),e.j41(5,"nz-input-number",47),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value[1]=o)}),e.k0s()(),e.bVm()}if(2&t){const n=e.XpG(3).$implicit;e.R7$(2),e.Y8G("ngModelOptions",e.lJ4(4,F))("ngModel",n.value[0]),e.R7$(3),e.Y8G("ngModelOptions",e.lJ4(5,F))("ngModel",n.value[1])}}function Bt(t,a){if(1&t&&(e.qex(0),e.DNE(1,Vt,2,3,"ng-container",39),e.DNE(2,Dt,6,6,"ng-container",39),e.bVm()),2&t){const n=e.XpG(2).$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",n.operator===i.OperatorNumberType.EQ||n.operator===i.OperatorNumberType.NEQ||n.operator===i.OperatorNumberType.GT||n.operator===i.OperatorNumberType.LT||n.operator===i.OperatorNumberType.EGT||n.operator===i.OperatorNumberType.ELT),e.R7$(1),e.Y8G("ngIf",n.operator===i.OperatorNumberType.RANGE)}}function At(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"input",48),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(3).$implicit;e.R7$(1),e.Y8G("ngModelOptions",e.lJ4(2,F))("ngModel",n.value)}}const $t=function(){return[]};function Yt(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"nz-select",49),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(3).$implicit;e.R7$(1),e.Y8G("ngModelOptions",e.lJ4(4,F))("nzPlaceHolder","\u8bf7\u9009\u62e9")("ngModel",n.value)("nzOptions",e.lJ4(5,$t))}}function Xt(t,a){if(1&t&&(e.qex(0),e.DNE(1,At,2,3,"ng-container",39),e.DNE(2,Yt,2,6,"ng-container",39),e.bVm()),2&t){const n=e.XpG(2).$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",n.operator===i.OperatorStringType.EQ||n.operator===i.OperatorStringType.NEQ||n.operator===i.OperatorStringType.NOT_LIKE||n.operator===i.OperatorStringType.LIKE||n.operator===i.OperatorStringType.START_WITH||n.operator===i.OperatorStringType.END_WITH),e.R7$(1),e.Y8G("ngIf",n.operator===i.OperatorStringType.IN||n.operator===i.OperatorStringType.NOT_IN)}}function Lt(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"nz-date-picker",43),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(3).$implicit;e.R7$(1),e.Y8G("ngModelOptions",e.lJ4(2,F))("ngModel",n.value)}}function Ut(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"nz-range-picker",50),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(3).$implicit;e.R7$(1),e.Y8G("nzShowTime",!0)("ngModel",n.value)}}function Ht(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"nz-input-number",51),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(3).$implicit;e.R7$(1),e.Y8G("ngModelOptions",e.lJ4(3,F))("ngModel",n.value)("nzMin",0)}}function Jt(t,a){if(1&t&&(e.qex(0),e.DNE(1,Lt,2,3,"ng-container",39),e.DNE(2,Ut,2,2,"ng-container",39),e.DNE(3,Ht,2,4,"ng-container",39),e.bVm()),2&t){const n=e.XpG(2).$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",n.operator===i.OperatorDateType.GT||n.operator===i.OperatorDateType.LT||n.operator===i.OperatorDateType.EGT||n.operator===i.OperatorDateType.ELT),e.R7$(1),e.Y8G("ngIf",n.operator===i.OperatorDateType.RANGE),e.R7$(1),e.Y8G("ngIf",n.operator===i.OperatorDateType.FEW_DAYS||n.operator===i.OperatorDateType.FUTURE_DAYS)}}function Wt(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"nz-select",52),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(2).$implicit;return e.Njj(r.value=o)}),e.nrm(2,"nz-option",38)(3,"nz-option",38),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(2).$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngModelOptions",e.lJ4(7,F))("nzPlaceHolder","\u8bf7\u9009\u62e9")("ngModel",n.value),e.R7$(1),e.Y8G("nzValue",!0)("nzLabel",i.eruptModel.eruptFieldModelMap.get(n.field).eruptFieldJson.edit.boolType.trueText),e.R7$(1),e.Y8G("nzValue",!1)("nzLabel",i.eruptModel.eruptFieldModelMap.get(n.field).eruptFieldJson.edit.boolType.falseText)}}function qt(t,a){if(1&t&&e.nrm(0,"nz-option",38),2&t){const n=a.$implicit;e.Y8G("nzValue",n.value)("nzLabel",n.label)}}function Qt(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"nz-select",53),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.DNE(2,qt,1,2,"nz-option",40),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(3).$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngModelOptions",e.lJ4(4,F))("nzPlaceHolder","\u8bf7\u9009\u62e9")("ngModel",n.value),e.R7$(1),e.Y8G("ngForOf",i.eruptModel.eruptFieldModelMap.get(n.field).componentValue)}}function Kt(t,a){if(1&t&&(e.qex(0),e.DNE(1,Qt,3,5,"ng-container",39),e.bVm()),2&t){const n=e.XpG(2).$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",n.operator===i.OperatorReferenceType.EQ||n.operator===i.OperatorReferenceType.NEQ)}}function Zt(t,a){if(1&t&&(e.qex(0),e.nrm(1,"erupt-reference",54),e.bVm()),2&t){const n=e.XpG(3).$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("eruptModel",i.eruptModel)("field",i.eruptModel.eruptFieldModelMap.get(n.field))("size","default")("readonly",!1)}}function eo(t,a){if(1&t&&(e.qex(0),e.DNE(1,Zt,2,4,"ng-container",39),e.bVm()),2&t){const n=e.XpG(2).$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",n.operator===i.OperatorReferenceType.EQ||n.operator===i.OperatorReferenceType.NEQ)}}function no(t,a){if(1&t&&(e.nrm(0,"nz-option",38),e.nI1(1,"translate")),2&t){const n=a.$implicit;e.Y8G("nzValue",n)("nzLabel",e.bMT(1,2,n))}}function to(t,a){if(1&t&&e.nrm(0,"nz-option",38),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function oo(t,a){if(1&t){const n=e.RV6();e.j41(0,"nz-select",58),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.DNE(1,to,1,2,"nz-option",40),e.k0s()}if(2&t){const n=e.XpG(3).$implicit,i=e.XpG(2);e.Y8G("ngModelOptions",e.lJ4(4,F))("nzPlaceHolder","\u8bf7\u9009\u62e9")("ngModel",n.value),e.R7$(1),e.Y8G("ngForOf",null==i.upmsData?null:i.upmsData.users)}}function io(t,a){if(1&t&&e.nrm(0,"nz-option",38),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function ro(t,a){if(1&t){const n=e.RV6();e.j41(0,"nz-select",58),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.DNE(1,io,1,2,"nz-option",40),e.k0s()}if(2&t){const n=e.XpG(3).$implicit,i=e.XpG(2);e.Y8G("ngModelOptions",e.lJ4(4,F))("nzPlaceHolder","\u8bf7\u9009\u62e9")("ngModel",n.value),e.R7$(1),e.Y8G("ngForOf",null==i.upmsData?null:i.upmsData.orgs)}}function ao(t,a){if(1&t&&e.nrm(0,"nz-option",38),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function so(t,a){if(1&t){const n=e.RV6();e.j41(0,"nz-select",58),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.DNE(1,ao,1,2,"nz-option",40),e.k0s()}if(2&t){const n=e.XpG(3).$implicit,i=e.XpG(2);e.Y8G("ngModelOptions",e.lJ4(4,F))("nzPlaceHolder","\u8bf7\u9009\u62e9")("ngModel",n.value),e.R7$(1),e.Y8G("ngForOf",null==i.upmsData?null:i.upmsData.posts)}}function lo(t,a){if(1&t&&e.nrm(0,"nz-option",38),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function co(t,a){if(1&t){const n=e.RV6();e.j41(0,"nz-select",58),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3).$implicit;return e.Njj(r.value=o)}),e.DNE(1,lo,1,2,"nz-option",40),e.k0s()}if(2&t){const n=e.XpG(3).$implicit,i=e.XpG(2);e.Y8G("ngModelOptions",e.lJ4(4,F))("nzPlaceHolder","\u8bf7\u9009\u62e9")("ngModel",n.value),e.R7$(1),e.Y8G("ngForOf",null==i.upmsData?null:i.upmsData.roles)}}function po(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"div",55)(2,"nz-select",56),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(2).$implicit;return e.Njj(r.upmsScope=o)}),e.DNE(3,no,2,4,"nz-option",40),e.nI1(4,"enumToArray"),e.k0s(),e.DNE(5,oo,2,5,"nz-select",57),e.DNE(6,ro,2,5,"nz-select",57),e.DNE(7,so,2,5,"nz-select",57),e.DNE(8,co,2,5,"nz-select",57),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(2).$implicit,i=e.XpG(2);e.R7$(2),e.Y8G("ngModelOptions",e.lJ4(10,F))("nzPlaceHolder","\u8bf7\u9009\u62e9")("ngModel",n.upmsScope),e.R7$(1),e.Y8G("ngForOf",e.bMT(4,8,i.UpmsScope)),e.R7$(2),e.Y8G("ngIf",n.upmsScope===i.UpmsScope.USER),e.R7$(1),e.Y8G("ngIf",n.upmsScope===i.UpmsScope.ORG),e.R7$(1),e.Y8G("ngIf",n.upmsScope===i.UpmsScope.POST),e.R7$(1),e.Y8G("ngIf",n.upmsScope===i.UpmsScope.ROLE)}}function _o(t,a){if(1&t&&(e.j41(0,"div",41)(1,"nz-form-item",42),e.DNE(2,Bt,3,2,"ng-container",39),e.DNE(3,Xt,3,2,"ng-container",39),e.DNE(4,Jt,4,3,"ng-container",39),e.DNE(5,Wt,4,8,"ng-container",39),e.DNE(6,Kt,2,1,"ng-container",39),e.DNE(7,eo,2,1,"ng-container",39),e.DNE(8,po,9,11,"ng-container",39),e.k0s()()),2&t){const n=e.XpG().$implicit,i=e.XpG(2);e.R7$(2),e.Y8G("ngIf",n.operatorType===i.OperatorType.NUMBER),e.R7$(1),e.Y8G("ngIf",n.operatorType===i.OperatorType.STRING),e.R7$(1),e.Y8G("ngIf",n.operatorType===i.OperatorType.DATE),e.R7$(1),e.Y8G("ngIf",n.operatorType===i.OperatorType.BOOLEAN),e.R7$(1),e.Y8G("ngIf",n.operatorType===i.OperatorType.CHOICE),e.R7$(1),e.Y8G("ngIf",n.operatorType===i.OperatorType.REFERENCE),e.R7$(1),e.Y8G("ngIf",n.operatorType===i.OperatorType.UPMS)}}function uo(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",26),e.DNE(1,vt,5,0,"div",27),e.j41(2,"div",28)(3,"nz-form-item")(4,"nz-select",29),e.bIt("ngModelChange",function(o){const s=e.eBV(n).$implicit;return e.Njj(s.field=o)})("ngModelChange",function(){const r=e.eBV(n).$implicit,s=e.XpG(2);return e.Njj(s.onFieldChange(r))}),e.DNE(5,xt,1,2,"nz-option",30),e.DNE(6,Mt,2,1,"ng-container",31),e.k0s()(),e.j41(7,"nz-form-item")(8,"nz-select",32),e.bIt("ngModelChange",function(o){const s=e.eBV(n).$implicit;return e.Njj(s.operator=o)})("ngModelChange",function(){const r=e.eBV(n).$implicit,s=e.XpG(2);return e.Njj(s.onOperatorChange(r))}),e.qex(9,33),e.DNE(10,yt,3,3,"ng-container",34),e.DNE(11,Ft,3,3,"ng-container",34),e.DNE(12,Et,3,3,"ng-container",34),e.DNE(13,Pt,3,3,"ng-container",34),e.DNE(14,It,3,3,"ng-container",34),e.DNE(15,St,3,3,"ng-container",34),e.DNE(16,jt,3,3,"ng-container",34),e.bVm(),e.k0s()(),e.DNE(17,_o,9,7,"div",35),e.k0s()()}if(2&t){const n=a.$implicit,i=a.index,o=e.XpG(2);e.R7$(1),e.Y8G("ngIf",i>0),e.R7$(3),e.Y8G("ngModel",n.field)("ngModelOptions",e.lJ4(16,F)),e.R7$(1),e.Y8G("ngIf",o.upmsData),e.R7$(1),e.Y8G("ngForOf",o.eruptModel.eruptFieldModels),e.R7$(2),e.Y8G("ngModel",n.operator)("ngModelOptions",e.lJ4(17,F)),e.R7$(1),e.Y8G("ngSwitch",n.operatorType),e.R7$(1),e.Y8G("ngSwitchCase",o.OperatorType.STRING),e.R7$(1),e.Y8G("ngSwitchCase",o.OperatorType.NUMBER),e.R7$(1),e.Y8G("ngSwitchCase",o.OperatorType.DATE),e.R7$(1),e.Y8G("ngSwitchCase",o.OperatorType.BOOLEAN),e.R7$(1),e.Y8G("ngSwitchCase",o.OperatorType.CHOICE),e.R7$(1),e.Y8G("ngSwitchCase",o.OperatorType.REFERENCE),e.R7$(1),e.Y8G("ngSwitchCase",o.OperatorType.UPMS),e.R7$(1),e.Y8G("ngIf",n.operator)}}function go(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",12),e.DNE(1,ft,3,0,"div",13),e.j41(2,"nz-card",14),e.DNE(3,ht,2,1,"ng-template",null,15,e.C5r),e.DNE(5,bt,1,1,"ng-template",null,16,e.C5r),e.j41(7,"div",17),e.DNE(8,uo,18,18,"div",18),e.j41(9,"button",19),e.bIt("click",function(){const r=e.eBV(n).index,s=e.XpG();return e.Njj(s.addCondition(r))}),e.nrm(10,"i",11),e.EFF(11," \u6dfb\u52a0\u6761\u4ef6 "),e.k0s()()()()}if(2&t){const n=a.$implicit,i=a.index,o=e.sdS(4),r=e.sdS(6);e.R7$(1),e.Y8G("ngIf",i>0),e.R7$(1),e.Y8G("nzTitle",o)("nzExtra",r)("nzSize","small"),e.R7$(6),e.Y8G("ngForOf",n)}}let Ze=(()=>{class t{constructor(n){this.msg=n,this.search=[],this.searchChange=new e.bkB,this.requiredHasCondition=!1,this.SUBMITTER="SUBMITTER",this.searchTypeMapping={[p.zl.INPUT]:m.STRING,[p.zl.COLOR]:m.STRING,[p.zl.TEXTAREA]:m.STRING,[p.zl.MARKDOWN]:m.STRING,[p.zl.HTML_EDITOR]:m.STRING,[p.zl.CODE_EDITOR]:m.STRING,[p.zl.AUTO_COMPLETE]:m.STRING,[p.zl.NUMBER]:m.NUMBER,[p.zl.SLIDER]:m.NUMBER,[p.zl.RATE]:m.NUMBER,[p.zl.DATE]:m.DATE,[p.zl.BOOLEAN]:m.BOOLEAN,[p.zl.CHOICE]:m.CHOICE,[p.zl.MULTI_CHOICE]:m.CHOICE,[p.zl.REFERENCE_TABLE]:m.REFERENCE,[p.zl.REFERENCE_TREE]:m.REFERENCE},this.saveCondition=()=>{for(let i of this.search)for(let o of i){if(!o.field)return this.msg.error("\u8bf7\u9009\u62e9\u5b57\u6bb5"),!1;if(!o.operator)return this.msg.error("\u8bf7\u9009\u62e9\u8fd0\u7b97\u7b26"),!1;if(o.operator!=ee.NOT_NULL&&o.operator!=ee.NULL&&null==o.value)return this.msg.error("\u8bf7\u8f93\u5165\u503c"),!1}return this.searchChange.emit(this.search),!0},this.editType=p.zl,this.OperatorType=m,this.OperatorStringType=_e,this.OperatorNumberType=ue,this.OperatorDateType=ee,this.OperatorReferenceType=Ne,this.OperatorUpmsType=Qe,this.UpmsScope=He}ngOnInit(){this.requiredHasCondition&&(!this.search||0===this.search.length)&&(this.search=[[this.createEmptyCondition()]])}createEmptyCondition(){return{field:"",operatorType:null,operator:null,value:null,upmsScope:null}}onFieldChange(n){if(n.field===this.SUBMITTER)return n.operatorType=m.UPMS,void(n.operator=_e.EQ);switch(n.operatorType=this.searchTypeMapping[this.eruptModel.eruptFieldModelMap.get(n.field)?.eruptFieldJson.edit.type]||m.STRING,n.operatorType){case m.STRING:n.operator=_e.EQ;break;case m.NUMBER:n.operator=ue.EQ;break;case m.DATE:n.operator=ee.TODAY;break;case m.REFERENCE:case m.BOOLEAN:case m.CHOICE:case m.UPMS:n.operator=Ne.EQ}n.value=null,n.upmsScope=null}onOperatorChange(n){n.value=n.operatorType===m.NUMBER&&n.operator===ue.RANGE||n.operatorType===m.CHOICE||n.operatorType===m.UPMS?[]:null}addConditionGroup(){this.search.push([this.createEmptyCondition()])}removeConditionGroup(n){n>=0&&n<this.search.length&&this.search.splice(n,1)}addCondition(n){this.search[n]||(this.search[n]=[]),this.search[n].push(this.createEmptyCondition())}removeCondition(n,i){this.search[n]&&this.search[n].splice(i,1)}resetForm(){this.search=[[this.createEmptyCondition()]]}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(R.xh))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["erupt-smart-search"]],inputs:{eruptModel:"eruptModel",search:"search",requiredHasCondition:"requiredHasCondition",upmsData:"upmsData"},outputs:{searchChange:"searchChange"},decls:15,vars:1,consts:[[1,"smart-search-container"],[1,"header-section"],[1,"title-area"],[1,"main-title"],["nz-button","","nzType","default",2,"margin-left","auto",3,"click"],["nz-form","",1,"condition-builder"],[1,"condition-panel"],[1,"condition-groups"],["class","condition-group-wrapper",4,"ngFor","ngForOf"],[1,"add-group-section"],["nz-button","","nzType","dashed","nzBlock","",3,"click"],["nz-icon","","nzType","plus"],[1,"condition-group-wrapper"],["class","or-divider",4,"ngIf"],[1,"condition-group-card",3,"nzTitle","nzExtra","nzSize"],["cardTitle",""],["cardExtra",""],[1,"conditions-list"],["class","condition-item",4,"ngFor","ngForOf"],["nz-button","","nzType","dashed","nzSize","small",1,"add-condition-btn",3,"click"],[1,"or-divider"],[1,"or-text"],[1,"card-title-text"],["nz-button","","nzType","text","nzSize","small","nzDanger","",3,"click",4,"ngIf"],["nz-button","","nzType","text","nzSize","small","nzDanger","",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline"],[1,"condition-item"],["class","logic-label",4,"ngIf"],[1,"condition-content"],["nzPlaceHolder","\u8bf7\u9009\u62e9\u5b57\u6bb5","nzShowSearch","",1,"field-select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"nzValue","nzLabel",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"operator-select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngSwitch"],[4,"ngSwitchCase"],["class","value-row",4,"ngIf"],[1,"logic-label"],[1,"logic-text"],[3,"nzValue","nzLabel"],[4,"ngIf"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],[1,"value-row"],[1,"value-input-container"],[2,"width","100%",3,"ngModelOptions","ngModel","ngModelChange"],[2,"display","flex","align-items","center","gap","12px","width","100%"],["placeholder","\u6700\u5c0f\u503c",2,"flex","1",3,"ngModelOptions","ngModel","ngModelChange"],[1,"range-separator"],["placeholder","\u6700\u5927\u503c",2,"flex","1",3,"ngModelOptions","ngModel","ngModelChange"],["nz-input","","type","text","placeholder","\u8bf7\u8f93\u5165",3,"ngModelOptions","ngModel","ngModelChange"],["nzMode","tags",2,"width","100%",3,"ngModelOptions","nzPlaceHolder","ngModel","nzOptions","ngModelChange"],[2,"width","100%",3,"nzShowTime","ngModel","ngModelChange"],[2,"width","100%",3,"ngModelOptions","ngModel","nzMin","ngModelChange"],[2,"width","100%",3,"ngModelOptions","nzPlaceHolder","ngModel","ngModelChange"],["nzMode","multiple",2,"width","100%",3,"ngModelOptions","nzPlaceHolder","ngModel","ngModelChange"],[2,"width","100%",3,"eruptModel","field","size","readonly"],[2,"gap","12px","display","flex","width","100%"],[2,"width","30%",3,"ngModelOptions","nzPlaceHolder","ngModel","ngModelChange"],["style","width: 70%","nzMode","multiple",3,"ngModelOptions","nzPlaceHolder","ngModel","ngModelChange",4,"ngIf"],["nzMode","multiple",2,"width","70%",3,"ngModelOptions","nzPlaceHolder","ngModel","ngModelChange"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),e.EFF(4," \u5f53\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u65f6\u8fdb\u5165\u5f53\u524d\u5206\u652f "),e.k0s(),e.j41(5,"button",4),e.bIt("click",function(){return o.resetForm()}),e.EFF(6," \u91cd\u7f6e "),e.k0s()()(),e.j41(7,"form",5)(8,"div",6)(9,"div",7),e.DNE(10,go,12,5,"div",8),e.k0s(),e.j41(11,"div",9)(12,"button",10),e.bIt("click",function(){return o.addConditionGroup()}),e.nrm(13,"i",11),e.EFF(14," \u6dfb\u52a0\u6761\u4ef6\u7ec4 "),e.k0s()()()()()),2&i&&(e.R7$(10),e.Y8G("ngForOf",o.search))},dependencies:[d.Sq,d.bT,d.ux,d.e1,l.qT,l.me,l.BC,l.cb,l.vS,l.cV,v.aO,M.c,T.p,Ve.e,y.ld,y.WI,z.Dn,x.Sy,Z.SN,Z.vw,ze.FG,Q.CA,Q.Ls,re.cK,mt.t,Ke.y,q.$],styles:['.smart-search-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.header-section[_ngcontent-%COMP%]{margin-bottom:16px}.header-section[_ngcontent-%COMP%]   .title-area[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.header-section[_ngcontent-%COMP%]   .title-area[_ngcontent-%COMP%]   .main-title[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:500;color:#646464;display:flex;align-items:center;gap:8px}.header-section[_ngcontent-%COMP%]   .title-area[_ngcontent-%COMP%]   .main-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#00000073;font-size:14px}.condition-group-wrapper[_ngcontent-%COMP%]{margin-bottom:16px}.condition-group-wrapper[_ngcontent-%COMP%]:last-child{margin-bottom:0}.or-divider[_ngcontent-%COMP%]{text-align:center;margin:16px 0;position:relative}.or-divider[_ngcontent-%COMP%]:before{content:"";position:absolute;top:50%;left:0;right:0;height:1px;background:#f0f0f0;z-index:1}.or-divider[_ngcontent-%COMP%]   .or-text[_ngcontent-%COMP%]{background:#fff;padding:0 16px;color:#00000073;font-size:12px;font-weight:500;position:relative;z-index:2;border:1px solid #f0f0f0;border-radius:12px}.condition-group-card[_ngcontent-%COMP%]{border:1px solid #f0f0f0;border-radius:6px}.condition-group-card[_ngcontent-%COMP%]     .ant-card-head{min-height:48px;padding:0 16px}.condition-group-card[_ngcontent-%COMP%]     .ant-card-head .ant-card-head-title{padding:12px 0;font-size:14px;font-weight:500}.condition-group-card[_ngcontent-%COMP%]     .ant-card-head .ant-card-extra{padding:12px 0}.condition-group-card[_ngcontent-%COMP%]     .ant-card-body{padding:16px}.condition-group-card[_ngcontent-%COMP%]   .card-title-text[_ngcontent-%COMP%]{color:#000000d9}.conditions-list[_ngcontent-%COMP%]   .condition-item[_ngcontent-%COMP%]{margin-bottom:12px}.conditions-list[_ngcontent-%COMP%]   .condition-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.logic-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:8px}.logic-label[_ngcontent-%COMP%]   .logic-text[_ngcontent-%COMP%]{font-size:12px;color:#00000073;font-weight:500}.condition-content[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:flex-start;flex-wrap:wrap}.condition-content[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]{margin-bottom:0;flex:1;min-width:150px}.condition-content[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]   .field-select[_ngcontent-%COMP%], .condition-content[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]   .operator-select[_ngcontent-%COMP%], .condition-content[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]   .value-select[_ngcontent-%COMP%]{width:100%}.condition-content[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]   .value-input[_ngcontent-%COMP%]{width:100%}.condition-content[_ngcontent-%COMP%]   .value-row[_ngcontent-%COMP%]{width:100%}.add-condition-btn[_ngcontent-%COMP%]{margin-top:8px}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:12px;margin-top:24px}@media (max-width: 768px){.smart-search-container[_ngcontent-%COMP%]{padding:16px}.condition-content[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.condition-content[_ngcontent-%COMP%]   nz-form-item[_ngcontent-%COMP%]{min-width:auto}.header-section[_ngcontent-%COMP%]   .title-area[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px}.or-divider[_ngcontent-%COMP%]{margin:12px 0}.or-divider[_ngcontent-%COMP%]   .or-text[_ngcontent-%COMP%]{padding:0 12px;font-size:11px}}']})}}return t})();function mo(t,a){if(1&t){const n=e.RV6();e.qex(0)(1),e.j41(2,"erupt-smart-search",5),e.bIt("searchChange",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.gatewayNode.conditions=o)}),e.k0s(),e.bVm()()}if(2&t){const n=e.XpG(2);e.R7$(2),e.Y8G("requiredHasCondition",n.gatewayType!=n.GatewayType.PARALLEL)("upmsData",n.upmsData)("eruptModel",n.eruptBuild.eruptModel)("search",n.gatewayNode.conditions)}}function fo(t,a){if(1&t){const n=e.RV6();e.j41(0,"nz-drawer",3),e.bIt("nzOnClose",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.closeDrawer())}),e.DNE(1,mo,3,4,"ng-container",4),e.k0s()}if(2&t){const n=e.XpG(),i=e.sdS(3);e.Y8G("nzVisible",n.showDrawer)("nzMaskClosable",!1)("nzTitle",n.modelValue.name)("nzFooter",i)("nzWidth",600)}}function ho(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",6)(1,"button",7),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.closeDrawer())}),e.EFF(2,"Cancel"),e.k0s(),e.j41(3,"button",8),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.onSaveProp())}),e.EFF(4,"Save"),e.k0s()()}}var b=function(t){return t.EXCLUSIVE="EXCLUSIVE",t.PARALLEL="PARALLEL",t.INCLUSIVE="INCLUSIVE",t}(b||{});let ge=(()=>{class t extends X{constructor(n){super(),this.upmsDataService=n,this.readonly=!1,this.branch=[],this.index=0,this.moveLn=!1,this.moveRn=!1,this.isDefault=!1,this.gatewayType=b.EXCLUSIVE,this.modelValueChange=new e.bkB,this.select=new e.bkB,this.delete=new e.bkB,this.insertNode=new e.bkB,this.moveL=new e.bkB,this.moveR=new e.bkB,this.gatewayNode={},this.showErr=!1,this.errInfo=null,this.showDrawer=!1,this.GatewayType=b,this.upmsData=this.upmsDataService?.upmsData}ngOnInit(){this.gatewayNode=this.modelValue.prop}onSelect(){this.isDefault||(this.showDrawer=!0)}onDelete(){this.delete.emit({branch:this.branch,index:this.index})}closeDrawer(){this.showDrawer=!1}onInsertNode(n){this.insertNode.emit({branch:this.branch,index:this.index,type:n})}onInsertFlexNode(n){A(this.branch,-1,n)}onMoveL(){this.moveL.emit()}onMoveR(){this.moveR.emit()}type(){return this.gatewayType===b.EXCLUSIVE?h.GATEWAY_EXCLUSION:this.gatewayType===b.PARALLEL?h.GATEWAY_PARALLEL:h.GATEWAY_INCLUSIVE}color(){return this.gatewayType===b.EXCLUSIVE?"#59B9A4":this.gatewayType===b.PARALLEL?"#718dff":"#FF9800"}name(){return this.gatewayType===b.EXCLUSIVE?"\u4e92\u65a5\u5206\u652f":this.gatewayType===b.PARALLEL?"\u5e76\u884c\u5206\u652f":"\u5305\u5bb9\u5206\u652f"}create(){return this.gatewayType===b.EXCLUSIVE?{id:O(),type:h.GATEWAY_EXCLUSION,name:this.name(),branches:[this.createBranch(0),{id:O(),type:h.GATEWAY_BRANCH,name:"\u9ed8\u8ba4\u6761\u4ef6",prop:{type:B.ELSE,conditions:[]},branches:[]}]}:this.gatewayType===b.PARALLEL?{id:O(),type:h.GATEWAY_PARALLEL,name:this.name(),branches:[this.createBranch(0),this.createBranch(1)]}:{id:O(),type:h.GATEWAY_INCLUSIVE,name:this.name(),branches:[this.createBranch(0),{id:O(),type:h.GATEWAY_BRANCH,name:"\u9ed8\u8ba4\u6761\u4ef6\uff08\u5305\u5bb9\uff09",prop:{type:B.ELSE,conditions:[]},branches:[]}]}}onSaveProp(){this.smartSearchComponent.saveCondition()&&(this.modelValue.prop=this.gatewayNode,this.showDrawer=!1)}createBranch(n){return this.gatewayType===b.EXCLUSIVE?{id:O(),type:h.GATEWAY_BRANCH,name:"\u4e92\u65a5\u6761\u4ef6"+(n+1),prop:{type:B.CONDITION,conditions:[]},branches:[]}:this.gatewayType===b.PARALLEL?{id:O(),type:h.GATEWAY_BRANCH,name:"\u5e76\u884c\u8def\u5f84"+(n+1),prop:{type:B.PARALLEL_CONDITION,conditions:[]},branches:[]}:{id:O(),type:h.GATEWAY_BRANCH,name:"\u5305\u5bb9\u6761\u4ef6"+(n+1),prop:{type:B.CONDITION,conditions:[]},branches:[]}}getHeaderIcon(){return this.gatewayType===b.EXCLUSIVE?"share":this.gatewayType===b.PARALLEL?"apartment":"fork"}getDescription(){return this.gatewayType===b.EXCLUSIVE?"\u4f18\u5148\u7ea7 "+(this.index+1):this.gatewayType===b.PARALLEL?"\u5e76\u884c\u6267\u884c":"\u5305\u5bb9\u6267\u884c"}getContent(){return this.gatewayType===b.EXCLUSIVE?"":this.gatewayType===b.PARALLEL?"\u5e76\u884c\u6d41\u7a0b\u5206\u652f":"\u5305\u5bb9\u6d41\u7a0b\u5206\u652f"}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(W))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-gateway-node"]],viewQuery:function(i,o){if(1&i&&e.GBs(Ze,5),2&i){let r;e.mGM(r=e.lsd())&&(o.smartSearchComponent=r.first)}},inputs:{readonly:"readonly",eruptBuild:"eruptBuild",modelValue:"modelValue",branch:"branch",index:"index",moveLn:"moveLn",moveRn:"moveRn",isDefault:"isDefault",gatewayType:"gatewayType",gatewayNode:"gatewayNode",progress:"progress"},outputs:{modelValueChange:"modelValueChange",select:"select",delete:"delete",insertNode:"insertNode",moveL:"moveL",moveR:"moveR"},features:[e.Vt3],decls:4,vars:14,consts:[[3,"modelValue","readonly","showError","errorInfo","color","headerIcon","eruptBuild","isDefault","moveRn","moveLn","desc","content","progress","modelValueChange","insertNode","insertFlexNode","moveL","moveR","delete","select"],["nzPlacement","right",3,"nzVisible","nzMaskClosable","nzTitle","nzFooter","nzWidth","nzOnClose",4,"ngIf"],["footerTpl",""],["nzPlacement","right",3,"nzVisible","nzMaskClosable","nzTitle","nzFooter","nzWidth","nzOnClose"],[4,"nzDrawerContent"],[3,"requiredHasCondition","upmsData","eruptModel","search","searchChange"],[2,"float","right"],["nz-button","",2,"margin-right","8px",3,"click"],["nz-button","","nzType","primary",3,"click"]],template:function(i,o){1&i&&(e.j41(0,"app-branch-node",0),e.bIt("modelValueChange",function(s){return o.modelValue=s})("insertNode",function(s){return o.onInsertNode(s)})("insertFlexNode",function(s){return o.onInsertFlexNode(s)})("moveL",function(){return o.onMoveL()})("moveR",function(){return o.onMoveR()})("delete",function(){return o.onDelete()})("select",function(){return o.onSelect()}),e.k0s(),e.DNE(1,fo,2,5,"nz-drawer",1),e.DNE(2,ho,5,0,"ng-template",null,2,e.C5r)),2&i&&(e.Y8G("modelValue",o.modelValue)("readonly",o.readonly)("showError",o.showErr)("errorInfo",o.errInfo)("color",o.color())("headerIcon",o.getHeaderIcon())("eruptBuild",o.eruptBuild)("isDefault",o.isDefault)("moveRn",o.moveRn)("moveLn",o.moveLn)("desc",o.getDescription())("content",o.getContent())("progress",o.progress),e.R7$(1),e.Y8G("ngIf",o.showDrawer))},dependencies:[d.bT,v.aO,M.c,T.p,k.vg,k.wk,Ze,Be]})}}return t})(),Pe=(()=>{class t extends X{constructor(){super(...arguments),this.readonly=!1,this.branch=[],this.index=0,this.modelChange=new e.bkB,this.select=new e.bkB,this.delete=new e.bkB,this.insertNode=new e.bkB,this.startNode=new Le,this.FormAccessEnum=E}ngOnInit(){this.model.prop&&(this.startNode=this.model.prop,this.startNode.formAccesses||(this.startNode.formAccesses={}))}onSelect(){this.select.emit(this.model)}onInsertNode(n){this.insertNode.emit({branch:this.branch,index:this.index,type:n})}onInsertFlexNode(n){A(this.branch,this.index,n)}type(){return h.START}color(){return"#80929C"}name(){return"\u53d1\u8d77\u4eba"}create(){return{id:O(),type:this.type(),name:this.name(),prop:new Le}}onDelete(){}onSaveProp(){this.model.prop=this.startNode}static{this.\u0275fac=function(){let n;return function(o){return(n||(n=e.xGo(t)))(o||t)}}()}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-start-node"]],inputs:{readonly:"readonly",model:"model",eruptBuild:"eruptBuild",branch:"branch",index:"index",progress:"progress"},outputs:{modelChange:"modelChange",select:"select",delete:"delete",insertNode:"insertNode"},features:[e.Vt3],decls:4,vars:10,consts:[[3,"model","readonly","showClose","eruptBuild","headerColor","progress","hasConfig","modelChange","select","saveProp","insertNode","insertFlexNode"],["config",""],[3,"eruptBuild","formAccesses","access"]],template:function(i,o){1&i&&(e.j41(0,"erupt-node",0),e.bIt("modelChange",function(s){return o.model=s})("select",function(){return o.onSelect()})("saveProp",function(){return o.onSaveProp()})("insertNode",function(s){return o.onInsertNode(s)})("insertFlexNode",function(s){return o.onInsertFlexNode(s)}),e.EFF(1," \u6d41\u7a0b\u4ece\u672c\u8282\u70b9\u5f00\u59cb "),e.j41(2,"div",1),e.nrm(3,"app-form-access",2),e.k0s()()),2&i&&(e.Y8G("model",o.model)("readonly",o.readonly)("showClose",!1)("eruptBuild",o.eruptBuild)("headerColor",o.color())("progress",o.progress)("hasConfig",!0),e.R7$(3),e.Y8G("eruptBuild",o.eruptBuild)("formAccesses",o.startNode.formAccesses)("access",o.FormAccessEnum.READ_WRITE))},dependencies:[$.Y,Ee]})}}return t})(),S=(()=>{class t{constructor(n){this._http=n}groupList(){return this._http.get(p.eY.erupt+"/flow/group/list",null,{observe:"body"})}groupAdd(n){return this._http.post(p.eY.erupt+"/flow/group/add",null,{name:n})}groupEdit(n,i){return this._http.post(p.eY.erupt+"/flow/group/edit",null,{id:n,name:i})}groupDelete(n){return this._http.post(p.eY.erupt+"/flow/group/delete",null,{id:n})}groupSort(n){return this._http.post(p.eY.erupt+"/flow/group/sort",n)}flowSort(n,i){return this._http.post(p.eY.erupt+"/flow/sort/"+i,n)}eruptFlows(){return this._http.get(p.eY.erupt+"/flow/flex/erupts")}eruptFlowBuild(n){return this._http.get(p.eY.erupt+"/flow/flex/erupt-build/"+n)}flexEruptFlowBuild(n){return this._http.get(p.eY.erupt+"/flow/flex/flex-erupt-build/"+n)}flexNodes(){return this._http.get(p.eY.erupt+"/flow/flex/flex-nodes")}configList(){return this._http.get(p.eY.erupt+"/flow/list",null)}configCreate(n){return this._http.post(p.eY.erupt+"/flow/create",n)}configUpdate(n){return this._http.post(p.eY.erupt+"/flow/update",n)}configCopy(n){return this._http.post(p.eY.erupt+"/flow/copy",null,{id:n})}configDelete(n){return this._http.post(p.eY.erupt+"/flow/delete",null,{id:n})}configSwitchEnable(n){return this._http.post(p.eY.erupt+"/flow/switch-enable",null,{id:n})}configGet(n){return this._http.get(p.eY.erupt+"/flow/get/"+n)}ruleCheck(n){return this._http.post(p.eY.erupt+"/flow/rule-check",n)}static{this.\u0275fac=function(i){return new(i||t)(e.KVO(pe.p4))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac})}}return t})(),me=(()=>{class t{constructor(n){this.flexNodes=[],n.flexNodes().subscribe(i=>{this.flexNodes=i.data})}static{this.\u0275fac=function(i){return new(i||t)(e.KVO(S))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac})}}return t})();var ne=c(8614),en=c(2617),Co=c(4199);function bo(t,a){if(1&t&&(e.qex(0),e.nrm(1,"erupt-edit-type",1),e.bVm()),2&t){const n=e.XpG();e.R7$(1),e.Y8G("eruptBuildModel",n.eruptBuild)("readonly",n.readonly)("mode",null)}}let fe=(()=>{class t{constructor(n,i,o){this.dataService=n,this.flowApiService=i,this.dataHandlerService=o,this.loading=!1,this.readonly=!1,this.initValue=!0,this.defaultFormAccess=E.DEFAULT}ngOnInit(){if(this.loading=!0,this.erupt?this.flowApiService.eruptFlowBuild(this.erupt).subscribe({next:n=>{n.data.eruptModel.eruptJson.layout.formSize=p.c8.FULL_LINE,this.dataHandlerService.initErupt(n.data),this.eruptBuild=n.data,this.initEruptValue()},complete:()=>{this.loading=!1}}):this.initValue&&this.initEruptValue(),this.formAccesses&&this.eruptBuild)for(let n of this.eruptBuild.eruptModel.eruptFieldModels){let i=this.formAccesses[n.fieldName];if(i)switch(i){case E.READONLY:n.eruptFieldJson.edit.readOnly={add:!0,edit:!0};break;case E.READ_WRITE:n.eruptFieldJson.edit.readOnly={add:!1,edit:!1};break;case E.HIDE:n.eruptFieldJson.edit.show=!1;break;case E.NOT_NULL:n.eruptFieldJson.edit.notNull=!0}else switch(this.defaultFormAccess){case E.READ_WRITE:n.eruptFieldJson.edit.readOnly={add:!1,edit:!1};break;case E.NOT_NULL:n.eruptFieldJson.edit.notNull=!0;break;case E.HIDE:n.eruptFieldJson.edit.show=!1;break;case E.READONLY:n.eruptFieldJson.edit.readOnly={add:!0,edit:!0}}}}initEruptValue(){this.dataService.getInitValue(this.eruptBuild.eruptModel.eruptName).subscribe(n=>{this.dataHandlerService.objectToEruptValue(n,this.eruptBuild)})}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(en.u),e.rXU(S),e.rXU(ne.u))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["erupt-flow-form"]],inputs:{readonly:"readonly",eruptBuild:"eruptBuild",erupt:"erupt",initValue:"initValue",formAccesses:"formAccesses",defaultFormAccess:"defaultFormAccess"},decls:1,vars:1,consts:[[4,"ngIf"],["size","default",3,"eruptBuildModel","readonly","mode"]],template:function(i,o){1&i&&e.DNE(0,bo,2,3,"ng-container",0),2&i&&e.Y8G("ngIf",o.eruptBuild)},dependencies:[d.bT,Co.k]})}}return t})();function vo(t,a){if(1&t&&e.nrm(0,"erupt-flow-form",3),2&t){const n=e.XpG();e.Y8G("eruptBuild",n.flexErupt)("initValue",!1)("readonly",!1)}}let nn=(()=>{class t extends X{constructor(n,i,o){super(),this.flowApiService=n,this.flowDataService=i,this.dataHandlerService=o,this.readonly=!1,this.branch=[],this.index=0,this.modelValueChange=new e.bkB,this.select=new e.bkB,this.delete=new e.bkB,this.insertNode=new e.bkB}ngOnInit(){}onInsertNode(n){this.insertNode.emit({branch:this.branch,index:this.index,type:n})}onInsertFlexNode(n){A(this.branch,this.index,n)}color(){if(this.modelValue?.flex)for(let n of this.flowDataService.flexNodes)if(n.code===this.modelValue.flex)return n.color;return"#000"}create(n){return{id:O(),type:this.type(),flex:n.code,name:n.name}}onSelect(){this.modelValue?.flex&&this.flowApiService.flexEruptFlowBuild(this.modelValue.flex).subscribe(n=>{n.data.eruptModel.eruptJson.layout.formSize=p.c8.FULL_LINE,this.dataHandlerService.initErupt(n.data),this.modelValue.prop&&this.dataHandlerService.objectToEruptValue(this.modelValue.prop,n.data),this.flexErupt=n.data})}onSaveProp(){this.modelValue.prop={...this.dataHandlerService.eruptValueToObject(this.flexErupt)}}onDelete(){this.delete.emit({branch:this.branch,index:this.index})}type(){return h.FlEX}name(){return"Flex"}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(S),e.rXU(me),e.rXU(ne.u))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["erupt-flex-node"]],inputs:{readonly:"readonly",eruptBuild:"eruptBuild",modelValue:"modelValue",branch:"branch",index:"index",progress:"progress"},outputs:{modelValueChange:"modelValueChange",select:"select",delete:"delete",insertNode:"insertNode"},features:[e.Vt3],decls:5,vars:7,consts:[[3,"model","readonly","headerColor","eruptBuild","progress","modelChange","select","insertNode","insertFlexNode","saveProp","delete"],["config",""],[3,"eruptBuild","initValue","readonly",4,"ngIf"],[3,"eruptBuild","initValue","readonly"]],template:function(i,o){1&i&&(e.j41(0,"erupt-node",0),e.bIt("modelChange",function(s){return o.modelValue=s})("select",function(){return o.onSelect()})("insertNode",function(s){return o.onInsertNode(s)})("insertFlexNode",function(s){return o.onInsertFlexNode(s)})("saveProp",function(){return o.onSaveProp()})("delete",function(){return o.onDelete()}),e.j41(1,"div",1),e.DNE(2,vo,1,3,"erupt-flow-form",2),e.k0s(),e.j41(3,"div"),e.EFF(4),e.k0s()()),2&i&&(e.Y8G("model",o.modelValue)("readonly",o.readonly)("headerColor",o.color())("eruptBuild",o.eruptBuild)("progress",o.progress),e.R7$(2),e.Y8G("ngIf",o.flexErupt),e.R7$(2),e.SpI(" ",null==o.modelValue?null:o.modelValue.name," "))},dependencies:[d.bT,$.Y,fe]})}}return t})();function xo(t,a){if(1&t&&e.nrm(0,"nz-option",6),2&t){const n=a.$implicit;e.Y8G("nzValue",n.id)("nzLabel",n.name)}}function wo(t,a){if(1&t&&e.nrm(0,"nz-option",6),2&t){const n=e.XpG().$implicit;e.Y8G("nzValue",n.fieldName)("nzLabel",n.eruptFieldJson.edit.title)}}function Mo(t,a){if(1&t&&(e.qex(0),e.DNE(1,wo,1,2,"nz-option",17),e.bVm()),2&t){const n=a.$implicit;e.R7$(1),e.Y8G("ngIf",n.eruptFieldJson.edit.title)}}function zo(t,a){if(1&t&&(e.qex(0),e.nrm(1,"nz-option",6),e.bVm()),2&t){const n=e.XpG().$implicit;e.R7$(1),e.Y8G("nzValue",n.fieldName)("nzLabel",n.eruptFieldJson.edit.title)}}function yo(t,a){if(1&t&&(e.qex(0),e.DNE(1,zo,2,2,"ng-container",18),e.bVm()),2&t){const n=a.$implicit,i=e.XpG().$implicit,o=e.XpG(3);let r;e.R7$(1),e.Y8G("ngIf",n.eruptFieldJson.edit.title&&n.eruptFieldJson.edit.type==(null==o.eruptBuild.eruptModel.eruptFieldModelMap||null==(r=o.eruptBuild.eruptModel.eruptFieldModelMap.get(i.source))?null:r.eruptFieldJson.edit.type))}}function Oo(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"div",12)(2,"nz-select",13),e.bIt("ngModelChange",function(o){const s=e.eBV(n).$implicit;return e.Njj(s.source=o)})("ngModelChange",function(){const r=e.eBV(n).$implicit;return e.Njj(r.target=null)}),e.DNE(3,Mo,2,1,"ng-container",9),e.k0s(),e.EFF(4," \u2192 "),e.j41(5,"nz-select",14),e.bIt("ngModelChange",function(o){const s=e.eBV(n).$implicit;return e.Njj(s.target=o)}),e.DNE(6,yo,2,1,"ng-container",9),e.k0s(),e.j41(7,"button",15),e.bIt("click",function(){const r=e.eBV(n).index,s=e.XpG(3);return e.Njj(s.subNode.mappings.splice(r,1))}),e.nrm(8,"span",16),e.k0s()(),e.bVm()}if(2&t){const n=a.$implicit,i=e.XpG(3);e.R7$(2),e.Y8G("ngModel",n.source),e.R7$(1),e.Y8G("ngForOf",i.eruptBuild.eruptModel.eruptFieldModels),e.R7$(2),e.Y8G("disabled",!n.source)("ngModel",n.target),e.R7$(1),e.Y8G("ngForOf",i.subEruptBuild.eruptModel.eruptFieldModels)}}function Fo(t,a){if(1&t&&e.nrm(0,"nz-option",6),2&t){const n=e.XpG().$implicit;e.Y8G("nzValue",n.fieldName)("nzLabel",n.eruptFieldJson.edit.title)}}function To(t,a){if(1&t&&(e.qex(0),e.DNE(1,Fo,1,2,"nz-option",17),e.bVm()),2&t){const n=a.$implicit;e.R7$(1),e.Y8G("ngIf",n.eruptFieldJson.edit.title)}}function Eo(t,a){if(1&t&&(e.qex(0),e.nrm(1,"nz-option",6),e.bVm()),2&t){const n=e.XpG().$implicit;e.R7$(1),e.Y8G("nzValue",n.fieldName)("nzLabel",n.eruptFieldJson.edit.title)}}function No(t,a){if(1&t&&(e.qex(0),e.DNE(1,Eo,2,2,"ng-container",18),e.bVm()),2&t){const n=a.$implicit,i=e.XpG().$implicit,o=e.XpG(3);let r;e.R7$(1),e.Y8G("ngIf",n.eruptFieldJson.edit.title&&n.eruptFieldJson.edit.type==(null==o.eruptBuild.eruptModel.eruptFieldModelMap||null==(r=o.eruptBuild.eruptModel.eruptFieldModelMap.get(i.source))?null:r.eruptFieldJson.edit.type))}}function Po(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"div",12)(2,"nz-select",19),e.bIt("ngModelChange",function(o){const s=e.eBV(n).$implicit;return e.Njj(s.source=o)})("ngModelChange",function(){const r=e.eBV(n).$implicit;return e.Njj(r.target=null)}),e.DNE(3,To,2,1,"ng-container",9),e.k0s(),e.EFF(4," \u2192 "),e.j41(5,"nz-select",20),e.bIt("ngModelChange",function(o){const s=e.eBV(n).$implicit;return e.Njj(s.target=o)}),e.DNE(6,No,2,1,"ng-container",9),e.k0s(),e.j41(7,"button",15),e.bIt("click",function(){const r=e.eBV(n).index,s=e.XpG(3);return e.Njj(s.subNode.mappingsReverse.splice(r,1))}),e.nrm(8,"span",16),e.k0s()(),e.bVm()}if(2&t){const n=a.$implicit,i=e.XpG(3);e.R7$(2),e.Y8G("ngModel",n.source),e.R7$(1),e.Y8G("ngForOf",i.subEruptBuild.eruptModel.eruptFieldModels),e.R7$(2),e.Y8G("disabled",!n.source)("ngModel",n.target),e.R7$(1),e.Y8G("ngForOf",i.eruptBuild.eruptModel.eruptFieldModels)}}function ko(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",7)(1,"nz-tabset")(2,"nz-tab",8),e.DNE(3,Oo,9,5,"ng-container",9),e.j41(4,"div",7)(5,"button",10),e.bIt("click",function(){e.eBV(n);const o=e.XpG(2);return e.Njj(o.addMapping())}),e.EFF(6,"\u6dfb\u52a0\u6620\u5c04"),e.k0s()()(),e.j41(7,"nz-tab",11),e.DNE(8,Po,9,5,"ng-container",9),e.j41(9,"div",7)(10,"button",10),e.bIt("click",function(){e.eBV(n);const o=e.XpG(2);return e.Njj(o.addMappingForParent())}),e.EFF(11,"\u6dfb\u52a0\u6620\u5c04"),e.k0s()()()()()}if(2&t){const n=e.XpG(2);e.R7$(3),e.Y8G("ngForOf",n.subNode.mappings),e.R7$(5),e.Y8G("ngForOf",n.subNode.mappingsReverse)}}function Io(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",2)(1,"nz-select",3),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.subNode.subFlowId=o)})("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.changeSubFlow(o))}),e.DNE(2,xo,1,2,"nz-option",4),e.k0s(),e.DNE(3,ko,12,2,"div",5),e.k0s()}if(2&t){const n=e.XpG();e.R7$(1),e.Y8G("ngModel",n.subNode.subFlowId),e.R7$(1),e.Y8G("ngForOf",n.flowConfigs),e.R7$(1),e.Y8G("ngIf",n.subEruptBuild)}}let tn=(()=>{class t extends X{constructor(n){super(),this.flowApi=n,this.readonly=!1,this.branch=[],this.index=0,this.modelValueChange=new e.bkB,this.select=new e.bkB,this.delete=new e.bkB,this.insertNode=new e.bkB,this.flowConfigs=[]}ngOnInit(){this.flowApi.configList().subscribe(n=>{this.flowConfigs=n.data,this.modelValue.prop?(this.subNode=this.modelValue.prop,this.subNode.subFlowId&&this.changeSubFlow(this.subNode.subFlowId,!1)):this.subNode=new Ue})}color(){return"#5bc2f9"}create(){return{id:O(),type:this.type(),name:this.name()}}name(){return"\u5b50\u6d41\u7a0b"}onDelete(){this.delete.emit({branch:this.branch,index:this.index})}onInsertFlexNode(n){A(this.branch,this.index,n)}onInsertNode(n){this.insertNode.emit({branch:this.branch,index:this.index,type:n,prop:new Ue})}onSaveProp(){this.modelValue.prop=this.subNode}onSelect(){this.select.emit(this.modelValue)}type(){return h.SUB}changeSubFlow(n,i=!0){let o=this.flowConfigs.find(r=>r.id===n);i&&(this.subNode.mappings=[{source:null,target:null}],this.subNode.mappingsReverse=[]),this.flowApi.eruptFlowBuild(o.erupt).subscribe(r=>{this.subEruptBuild=r.data})}addMapping(){this.subNode.mappings.push({source:null,target:null})}addMappingForParent(){this.subNode.mappingsReverse.push({source:null,target:null})}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(S))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-sub-node"]],inputs:{readonly:"readonly",eruptBuild:"eruptBuild",modelValue:"modelValue",branch:"branch",index:"index",progress:"progress"},outputs:{modelValueChange:"modelValueChange",select:"select",delete:"delete",insertNode:"insertNode"},features:[e.Vt3],decls:4,vars:9,consts:[[3,"model","readonly","headerColor","eruptBuild","progress","modelChange","select","insertNode","insertFlexNode","saveProp","delete"],["config","",4,"ngIf"],["config",""],["nzShowSearch","","nzPlaceHolder","\u9009\u62e9\u5b50\u6d41\u7a0b",2,"width","100%",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["style","margin: 12px 0",4,"ngIf"],[3,"nzValue","nzLabel"],[2,"margin","12px 0"],["nzTitle","\u7236\u6d41\u7a0b \u2192 \u5b50\u6d41\u7a0b"],[4,"ngFor","ngForOf"],["nz-button","","nzType","primary",3,"click"],["nzTitle","\u5b50\u6d41\u7a0b \u2192 \u7236\u6d41\u7a0b"],[2,"display","flex","align-items","center","gap","8px","margin-bottom","12px"],["nzShowSearch","","nzPlaceHolder","\u4e3b\u6d41\u7a0b\u5b57\u6bb5",2,"flex","1",3,"ngModel","ngModelChange"],["nzShowSearch","","nzPlaceHolder","\u5b50\u6d41\u7a0b\u5b57\u6bb5",2,"flex","1",3,"disabled","ngModel","ngModelChange"],["nz-button","","nzType","text","nzDanger","",3,"click"],["nz-icon","","nzType","minus-circle","nzTheme","outline"],[3,"nzValue","nzLabel",4,"ngIf"],[4,"ngIf"],["nzShowSearch","","nzPlaceHolder","\u5b50\u6d41\u7a0b\u5b57\u6bb5",2,"flex","1",3,"ngModel","ngModelChange"],["nzShowSearch","","nzPlaceHolder","\u4e3b\u6d41\u7a0b\u5b57\u6bb5",2,"flex","1",3,"disabled","ngModel","ngModelChange"]],template:function(i,o){1&i&&(e.j41(0,"erupt-node",0),e.bIt("modelChange",function(s){return o.modelValue=s})("select",function(){return o.onSelect()})("insertNode",function(s){return o.onInsertNode(s)})("insertFlexNode",function(s){return o.onInsertFlexNode(s)})("saveProp",function(){return o.onSaveProp()})("delete",function(){return o.onDelete()}),e.EFF(1),e.nI1(2,"translate"),e.DNE(3,Io,4,3,"div",1),e.k0s()),2&i&&(e.Y8G("model",o.modelValue)("readonly",o.readonly)("headerColor",o.color())("eruptBuild",o.eruptBuild)("progress",o.progress),e.R7$(1),e.SpI(" ",e.bMT(2,7,"SUB_FLOW")," "),e.R7$(2),e.Y8G("ngIf",o.subNode))},dependencies:[d.Sq,d.bT,l.BC,l.vS,v.aO,M.c,T.p,y.ld,y.WI,z.Dn,Y.JZ,Y.rE,$.Y,q.$]})}}return t})();const on=[(()=>{const t=new ge;return t.gatewayType=b.EXCLUSIVE,t})(),(()=>{const t=new ge;return t.gatewayType=b.PARALLEL,t})(),(()=>{const t=new ge;return t.gatewayType=b.INCLUSIVE,t})(),new Pe,new We,new qe,new tn,new nn],ke=new Map;for(let t of on)ke[t.type()]=t;function Go(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",6),e.bIt("click",function(){e.eBV(n);const o=e.XpG().$implicit,r=e.XpG(2);return e.Njj(r.onInsertNode(o.type()))}),e.EFF(1),e.k0s()}if(2&t){const n=e.XpG().$implicit;e.xc7("color",n.color()),e.R7$(1),e.SpI(" ",n.name()," ")}}function So(t,a){if(1&t&&(e.qex(0),e.DNE(1,Go,2,3,"div",5),e.bVm()),2&t){const n=a.$implicit,i=e.XpG(2);e.R7$(1),e.Y8G("ngIf",n.type()!=i.nodeType.START&&n.type()!=i.nodeType.FlEX)}}function Ro(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"div",6),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG(2);return e.Njj(s.onInsertFlexNode(r))}),e.EFF(2),e.k0s(),e.bVm()}if(2&t){const n=a.$implicit;e.R7$(1),e.xc7("color",n.color),e.R7$(1),e.SpI(" ",n.name," ")}}function jo(t,a){if(1&t&&(e.j41(0,"div",3),e.DNE(1,So,2,1,"ng-container",4),e.DNE(2,Ro,3,3,"ng-container",4),e.k0s()),2&t){const n=e.XpG();e.R7$(1),e.Y8G("ngForOf",n.nodeList),e.R7$(1),e.Y8G("ngForOf",n.flexNodes)}}let rn=(()=>{class t{constructor(n){this.insertNode=new e.bkB,this.insertFlexNode=new e.bkB,this.popoverVisible=!1,this.nodeList=on,this.nodeType=h,this.flexNodes=[],this.flexNodes=n.flexNodes}onInsertNode(n){this.insertNode.emit(n),this.popoverVisible=!1}onInsertFlexNode(n){this.insertFlexNode.emit(n),this.popoverVisible=!1}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(me))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-insert-btn"]],outputs:{insertNode:"insertNode",insertFlexNode:"insertFlexNode"},decls:4,vars:2,consts:[["nz-button","","nzShape","circle","nz-popover","","nzPopoverTitle","\u8bf7\u9009\u62e9\u6d41\u7a0b\u8282\u70b9","nzPopoverPlacement","right","nzPopoverTrigger","click",2,"z-index","1","filter","drop-shadow(0 4px 8px rgba(31,35,41,.1))",3,"nzPopoverContent","nzPopoverVisible","nzPopoverVisibleChange"],["nz-icon","","nzType","plus",2,"font-size","16px"],["nzPopoverContent",""],[1,"node-options",2,"width","360px"],[4,"ngFor","ngForOf"],[3,"color","click",4,"ngIf"],[3,"click"]],template:function(i,o){if(1&i&&(e.j41(0,"button",0),e.bIt("nzPopoverVisibleChange",function(s){return o.popoverVisible=s}),e.nrm(1,"span",1),e.DNE(2,jo,3,2,"ng-template",null,2,e.C5r),e.k0s()),2&i){const r=e.sdS(3);e.Y8G("nzPopoverContent",r)("nzPopoverVisible",o.popoverVisible)}},dependencies:[d.Sq,d.bT,v.aO,M.c,T.p,xe.L_,z.Dn],styles:[".node-options[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.node-options[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:3px;margin-right:5px;border-radius:10px;border:1px solid #DEDFDF}.node-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;padding:8px 10px;border-radius:15px;background:#F8F9F9;margin:5px;width:110px}.node-options[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:hover{box-shadow:0 0 5px #e3e3e3}"]})}}return t})();var Ie=c(4710),Vo=c(4523),Do=c(5731);function Bo(t,a){if(1&t&&(e.nrm(0,"span",25),e.j41(1,"span",26),e.EFF(2),e.nI1(3,"translate"),e.k0s()),2&t){const n=e.XpG().$implicit;e.Y8G("nzType",n.icon),e.R7$(2),e.JRh(e.bMT(3,2,n.key))}}function Ao(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",27),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG().$implicit,u=e.XpG();return e.Njj(u.onItemToggle(s.key,r))}),e.j41(1,"label",28),e.bIt("ngModelChange",function(){const r=e.eBV(n).$implicit,s=e.XpG().$implicit,u=e.XpG();return e.Njj(u.onItemToggle(s.key,r))})("click",function(o){return o.stopPropagation()}),e.k0s(),e.j41(2,"span",29),e.EFF(3),e.k0s()()}if(2&t){const n=a.$implicit,i=e.XpG().$implicit,o=e.XpG();e.AVh("selected",o.isItemSelected(i.key,n.key)),e.R7$(1),e.Y8G("ngModel",o.isItemSelected(i.key,n.key)),e.R7$(2),e.JRh(n.value)}}function $o(t,a){if(1&t&&(e.j41(0,"div",30),e.nrm(1,"span",31),e.j41(2,"p"),e.EFF(3),e.k0s()()),2&t){const n=e.XpG().$implicit,i=e.XpG();e.R7$(3),e.JRh(i.getEmptyStateText(n.key))}}function Yo(t,a){if(1&t){const n=e.RV6();e.j41(0,"nz-tab",14),e.DNE(1,Bo,4,4,"ng-template",null,15,e.C5r),e.j41(3,"div",16)(4,"nz-input-group",17)(5,"input",18),e.bIt("ngModelChange",function(o){const s=e.eBV(n).$implicit;return e.Njj(s.searchText=o)})("ngModelChange",function(o){const s=e.eBV(n).$implicit,u=e.XpG();return e.Njj(u.onSearchChange(s.key,o))}),e.k0s()()(),e.j41(6,"div",19)(7,"div",20)(8,"span",21),e.EFF(9),e.k0s(),e.j41(10,"span",22),e.EFF(11,"\u70b9\u51fb\u9009\u62e9\u6216\u53d6\u6d88\u9009\u62e9"),e.k0s()(),e.DNE(12,Ao,4,4,"div",23),e.DNE(13,$o,4,1,"div",24),e.k0s()()}if(2&t){const n=a.$implicit,i=e.sdS(2),o=e.XpG();e.Y8G("nzTitle",i),e.R7$(5),e.Y8G("placeholder","\u641c\u7d22"+o.i18n.fanyi(n.key)+"\u540d\u79f0...")("ngModel",n.searchText),e.R7$(4),e.JRh(o.getListTitle(n.key)),e.R7$(3),e.Y8G("ngForOf",o.getFilteredItems(n.key))("ngForTrackBy",o.trackByKey),e.R7$(1),e.Y8G("ngIf",0===o.getFilteredItems(n.key).length)}}function Xo(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",32),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.onClearAll())}),e.nrm(1,"span",33),e.EFF(2," \u6e05\u7a7a\u5168\u90e8 "),e.k0s()}}function Lo(t,a){if(1&t){const n=e.RV6();e.j41(0,"nz-tag",43),e.nrm(1,"span",25),e.j41(2,"span",44),e.EFF(3),e.k0s(),e.j41(4,"i",45),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG(3);return e.Njj(s.onItemRemove(r))}),e.k0s()()}if(2&t){const n=a.$implicit,i=e.XpG(3);e.Y8G("nzColor",i.getTagColor(n.scope)),e.R7$(1),e.Y8G("nzType",n.icon),e.R7$(2),e.JRh(n.displayName)}}function Uo(t,a){if(1&t&&(e.j41(0,"div",41),e.DNE(1,Lo,5,3,"nz-tag",42),e.k0s()),2&t){const n=e.XpG().$implicit,i=e.XpG();e.R7$(1),e.Y8G("ngForOf",n.items)("ngForTrackBy",i.trackByScope)}}function Ho(t,a){if(1&t&&(e.j41(0,"div",46),e.nrm(1,"span",47),e.j41(2,"span",48),e.EFF(3),e.k0s()()),2&t){const n=e.XpG().$implicit,i=e.XpG();e.R7$(3),e.SpI("\u6682\u65e0\u5df2\u9009",i.i18n.fanyi(n.scope),"")}}function Jo(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",49)(1,"button",50),e.bIt("click",function(){e.eBV(n);const o=e.XpG().$implicit,r=e.XpG();return e.Njj(r.onClearAll(o.scope))}),e.nrm(2,"span",33),e.EFF(3),e.k0s()()}if(2&t){const n=e.XpG().$implicit,i=e.XpG();e.R7$(1),e.Y8G("nzTooltipTitle","\u6e05\u7a7a"+i.i18n.fanyi(n.scope)),e.R7$(2),e.SpI(" \u6e05\u7a7a",i.i18n.fanyi(n.scope)," ")}}function Wo(t,a){if(1&t&&(e.qex(0),e.j41(1,"div",34)(2,"div",35),e.nrm(3,"span",25),e.j41(4,"span",36),e.EFF(5),e.k0s(),e.j41(6,"span",37),e.EFF(7),e.k0s()(),e.DNE(8,Uo,2,2,"div",38),e.DNE(9,Ho,4,1,"div",39),e.DNE(10,Jo,4,2,"div",40),e.k0s(),e.bVm()),2&t){const n=a.$implicit,i=e.XpG();e.R7$(3),e.Y8G("nzType",n.icon),e.R7$(2),e.JRh(i.i18n.fanyi(n.scope)),e.R7$(2),e.SpI("(",n.items.length,")"),e.R7$(1),e.Y8G("ngIf",n.items.length>0),e.R7$(1),e.Y8G("ngIf",0===n.items.length),e.R7$(1),e.Y8G("ngIf",n.items.length>0)}}function qo(t,a){if(1&t&&(e.j41(0,"div",51),e.nrm(1,"span",47),e.j41(2,"p"),e.EFF(3),e.k0s(),e.j41(4,"span",52),e.EFF(5),e.k0s()()),2&t){const n=e.XpG();e.R7$(3),e.JRh(n.getEmptySelectedText()),e.R7$(2),e.JRh(n.getEmptySelectedTip())}}let Qo=(()=>{class t{constructor(n,i){this.upmsDataService=n,this.i18n=i,this.flowUpmsScopes=[],this.flowUpmsScopesChange=new e.bkB,this.activeTab=0,this.tabs=[{key:C.USER,icon:"user",items:[],searchText:null},{key:C.ROLE,icon:"safety-certificate",items:[],searchText:null},{key:C.POST,icon:"idcard",items:[],searchText:null},{key:C.ORG,icon:"apartment",items:[],searchText:null}]}ngOnInit(){this.loadData()}loadData(){this.tabs.find(n=>n.key===C.USER).items=this.upmsDataService.upmsData.users,this.tabs.find(n=>n.key===C.POST).items=this.upmsDataService.upmsData.posts,this.tabs.find(n=>n.key===C.ROLE).items=this.upmsDataService.upmsData.roles,this.tabs.find(n=>n.key===C.ORG).items=this.upmsDataService.upmsData.orgs}onTabChange(n){this.activeTab=n}onSearchChange(n,i){const o=this.tabs.find(r=>r.key===n);o&&(o.searchText=i)}onItemToggle(n,i){if(this.flowUpmsScopes.some(r=>r.scope===n&&r.scopeValue===i.key)){const r=this.flowUpmsScopes.findIndex(s=>s.scope===n&&s.scopeValue===i.key);r>-1&&this.flowUpmsScopes.splice(r,1)}else this.flowUpmsScopes.push({scope:n,scopeValue:i.key});this.emitChanges()}onItemRemove(n){const i=this.flowUpmsScopes.findIndex(o=>o.scope===n.scope&&o.scopeValue===n.scopeValue);i>-1&&this.flowUpmsScopes.splice(i,1),this.emitChanges()}onClearAll(n){this.flowUpmsScopes=n?this.flowUpmsScopes.filter(i=>i.scope!==n):[],this.emitChanges()}emitChanges(){this.flowUpmsScopesChange.emit(this.flowUpmsScopes)}getFilteredItems(n){const i=this.tabs.find(o=>o.key===n);return i?i.searchText?i.items.filter(o=>o.value.toLowerCase().includes(i.searchText.toLowerCase())):i.items:[]}get currentTab(){return this.tabs[this.activeTab]}getListTitle(n){const i=this.tabs.find(r=>r.key===n);return i?`\u5171 ${this.getFilteredItems(n).length} \u4e2a${this.i18n.fanyi(i.key)}`:""}getEmptyStateText(n){const i=this.tabs.find(o=>o.key===n);return i?`\u672a\u627e\u5230\u5339\u914d\u7684${this.i18n.fanyi(i.key)}`:""}getEmptySelectedText(){return"\u6682\u65e0\u5df2\u9009\u9879\u76ee"}getEmptySelectedTip(){return"\u8bf7\u5728\u5de6\u4fa7\u9009\u62e9\u9700\u8981\u5206\u914d\u7684\u9879\u76ee"}getItemIcon(n){switch(n){case C.ORG:return"apartment";case C.ROLE:return"safety-certificate";case C.USER:return"user";default:return"idcard"}}getItemLabel(n){switch(n){case C.ORG:return"\u7ec4\u7ec7\u67b6\u6784";case C.ROLE:return"\u89d2\u8272";case C.USER:return"\u7528\u6237";case C.POST:return"\u5c97\u4f4d";default:return"\u672a\u77e5"}}getTagColor(n){switch(n){case C.ORG:return"blue";case C.ROLE:return"green";case C.USER:return"orange";case C.POST:return"purple";default:return"default"}}getItemDisplayName(n){const i=this.tabs.find(r=>r.key===n.scope);if(!i)return"";const o=i.items.find(r=>r.key===n.scopeValue);return o?o.value:""}isItemSelected(n,i){return this.flowUpmsScopes.some(o=>o.scope===n&&o.scopeValue===i)}getSortedDisplayData(){const n={[C.ORG]:1,[C.ROLE]:2,[C.USER]:3,[C.POST]:4};return this.flowUpmsScopes.map(i=>({...i,displayName:this.getItemDisplayName(i),icon:this.getItemIcon(i.scope),label:this.getItemLabel(i.scope)})).sort((i,o)=>{const r=n[i.scope]-n[o.scope];return 0!==r?r:i.displayName.localeCompare(o.displayName)})}getGroupedDisplayData(){const n=[];return this.tabs.forEach(i=>{const o=this.flowUpmsScopes.filter(r=>r.scope===i.key).map(r=>({...r,displayName:this.getItemDisplayName(r),icon:this.getItemIcon(r.scope),label:this.getItemLabel(r.scope)})).sort((r,s)=>r.displayName.localeCompare(s.displayName));o.length>0&&n.push({scope:i.key,icon:i.icon,items:o})}),n}trackByKey(n,i){return i.key}trackByScope(n,i){return`${i.scope}-${i.scopeValue}`}trackByGroup(n,i){return i.scope}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(W),e.rXU(Do.SU))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["erupt-upms-select"]],inputs:{flowUpmsScopes:"flowUpmsScopes"},outputs:{flowUpmsScopesChange:"flowUpmsScopesChange"},decls:15,vars:10,consts:[[1,"upms-select-container"],[1,"left-panel"],[1,"custom-tabs",3,"nzSelectedIndex","nzTabPosition","nzType","nzSize","nzSelectedIndexChange"],[3,"nzTitle",4,"ngFor","ngForOf"],[1,"right-panel"],[1,"selected-header"],[1,"header-info"],[1,"panel-title"],[1,"header-actions"],["nz-button","","nzType","link","nzSize","small","nzDanger","","class","clear-all-btn",3,"click",4,"ngIf"],[1,"selected-items"],[1,"tags-container"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","empty-selected",4,"ngIf"],[3,"nzTitle"],["tabTitleTemplate",""],[1,"search-container"],["nzSize","default"],["nz-input","",3,"placeholder","ngModel","ngModelChange"],[1,"item-list"],[1,"item-list-header"],[1,"item-count"],[1,"item-tip"],["class","item-item",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","empty-state",4,"ngIf"],["nz-icon","","nzTheme","outline",3,"nzType"],[1,"tab-label"],[1,"item-item",3,"click"],["nz-checkbox","",3,"ngModel","ngModelChange","click"],[1,"item-name"],[1,"empty-state"],["nz-icon","","nzType","search","nzTheme","outline"],["nz-button","","nzType","link","nzSize","small","nzDanger","",1,"clear-all-btn",3,"click"],["nz-icon","","nzType","delete","nzTheme","outline"],[1,"group-container"],[1,"group-header"],[1,"group-label"],[1,"group-count"],["class","group-tags",4,"ngIf"],["class","group-empty",4,"ngIf"],["class","group-actions",4,"ngIf"],[1,"group-tags"],["style","margin-bottom: 6px",3,"nzColor",4,"ngFor","ngForOf","ngForTrackBy"],[2,"margin-bottom","6px",3,"nzColor"],[1,"tag-text"],["nz-icon","","nzType","close","nzTheme","outline",3,"click"],[1,"group-empty"],["nz-icon","","nzType","inbox","nzTheme","outline"],[1,"empty-text"],[1,"group-actions"],["nz-button","","nzType","link","nzSize","small","nzDanger","","nz-tooltip","",1,"clear-group-btn",3,"nzTooltipTitle","click"],[1,"empty-selected"],[1,"empty-tip"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"nz-tabset",2),e.bIt("nzSelectedIndexChange",function(s){return o.activeTab=s})("nzSelectedIndexChange",function(s){return o.onTabChange(s)}),e.DNE(3,Yo,14,7,"nz-tab",3),e.k0s()(),e.j41(4,"div",4)(5,"div",5)(6,"div",6)(7,"h3",7),e.EFF(8),e.k0s()(),e.j41(9,"div",8),e.DNE(10,Xo,3,0,"button",9),e.k0s()(),e.j41(11,"div",10)(12,"div",11),e.DNE(13,Wo,11,6,"ng-container",12),e.k0s(),e.DNE(14,qo,6,2,"div",13),e.k0s()()()),2&i&&(e.R7$(2),e.Y8G("nzSelectedIndex",o.activeTab)("nzTabPosition","top")("nzType","line")("nzSize","default"),e.R7$(1),e.Y8G("ngForOf",o.tabs),e.R7$(5),e.SpI("\u5df2\u9009",o.flowUpmsScopes.length," \u9879"),e.R7$(2),e.Y8G("ngIf",o.flowUpmsScopes.length>0),e.R7$(3),e.Y8G("ngForOf",o.getGroupedDisplayData())("ngForTrackBy",o.trackByGroup),e.R7$(1),e.Y8G("ngIf",0===o.flowUpmsScopes.length))},dependencies:[d.Sq,d.bT,l.me,l.BC,l.vS,v.aO,M.c,K.$g,j.LH,z.Dn,Y.JZ,Y.rE,x.Sy,x.tg,H.s,q.$],styles:["[_nghost-%COMP%]     .upms-select-container{display:flex;min-height:520px;margin:0 auto}[_nghost-%COMP%]     .left-panel{flex:1.2;border-right:1px solid #f0f0f0;padding:0 12px}[_nghost-%COMP%]     .right-panel{flex:.8;padding:12px}[_nghost-%COMP%]     .tabs{display:flex;border-bottom:1px solid #f0f0f0;margin-bottom:16px}[_nghost-%COMP%]     .tab-item{display:flex;align-items:center;gap:6px;padding:10px 16px;cursor:pointer;border-bottom:2px solid transparent;transition:all .2s ease;color:#666;font-size:14px;font-weight:500;position:relative}[_nghost-%COMP%]     .tab-item:hover{color:#1890ff;background-color:#1890ff0a}[_nghost-%COMP%]     .tab-item.active{color:#1890ff;border-bottom-color:#1890ff;background-color:#1890ff0a}[_nghost-%COMP%]     .tab-item span[nz-icon]{font-size:14px}[_nghost-%COMP%]     .tab-item .tab-label{font-size:13px}[_nghost-%COMP%]     .search-container{margin-bottom:12px}[_nghost-%COMP%]     .search-container nz-input-group   .ant-input-group-addon{background:#f8f9fa;border-color:#e9ecef}[_nghost-%COMP%]     .search-container nz-input-group   .ant-input{border-color:#e9ecef}[_nghost-%COMP%]     .search-container nz-input-group   .ant-input:focus, [_nghost-%COMP%]     .search-container nz-input-group   .ant-input:hover{border-color:#1890ff;box-shadow:0 0 0 2px #1890ff1a}[_nghost-%COMP%]     .external-link{display:flex;align-items:center;gap:6px;margin-bottom:16px;padding:8px 10px;background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);border:1px solid #e9ecef;border-radius:8px;font-size:12px;color:#495057;transition:all .2s ease}[_nghost-%COMP%]     .external-link:hover{background:linear-gradient(135deg,#e9ecef 0%,#dee2e6 100%);border-color:#ced4da}[_nghost-%COMP%]     .external-link span[nz-icon]{color:#1890ff;font-size:14px}[_nghost-%COMP%]     .external-link .link-icon{margin-left:auto;cursor:pointer}[_nghost-%COMP%]     .external-link .link-icon:hover{color:#40a9ff}[_nghost-%COMP%]     .item-list{max-height:320px;border:1px solid #f0f0f0;background:#fff}[_nghost-%COMP%]     .item-list-header{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:#f8f9fa;border-bottom:1px solid #f0f0f0}[_nghost-%COMP%]     .item-list-header .item-count{font-size:12px;color:#6c757d;font-weight:500}[_nghost-%COMP%]     .item-list-header .item-tip{font-size:11px;color:#adb5bd}[_nghost-%COMP%]     .item-item{display:flex;align-items:center;gap:10px;padding:10px 12px;cursor:pointer;transition:all .2s ease;border-bottom:1px solid #f8f9fa;position:relative}[_nghost-%COMP%]     .item-item:last-child{border-bottom:none}[_nghost-%COMP%]     .item-item:hover{background-color:#f8f9fa;transform:translate(2px)}[_nghost-%COMP%]     .item-item:active{background-color:#e9ecef}[_nghost-%COMP%]     .item-item.selected{background-color:#1890ff0d;border-left:3px solid #1890ff;padding-left:9px}[_nghost-%COMP%]     .item-item .item-extra{margin-left:auto;display:flex;gap:8px;align-items:center}[_nghost-%COMP%]     .item-item .item-extra .department{font-size:11px;color:#6c757d;background:#e9ecef;padding:2px 6px;border-radius:3px}[_nghost-%COMP%]     .item-item .item-extra .level{font-size:11px;color:#1890ff;background:rgba(24,144,255,.1);padding:2px 6px;border-radius:3px}[_nghost-%COMP%]     .item-name{font-size:13px;color:#495057;font-weight:400}[_nghost-%COMP%]     .empty-state, [_nghost-%COMP%]     .empty-selected{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center;color:#adb5bd}[_nghost-%COMP%]     .empty-state span[nz-icon], [_nghost-%COMP%]     .empty-selected span[nz-icon]{font-size:32px;margin-bottom:8px;opacity:.6}[_nghost-%COMP%]     .empty-state p, [_nghost-%COMP%]     .empty-selected p{margin:8px 0 4px;font-size:14px;color:#6c757d}[_nghost-%COMP%]     .empty-state .empty-tip, [_nghost-%COMP%]     .empty-selected .empty-tip{font-size:11px;color:#adb5bd}[_nghost-%COMP%]     .selected-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #f0f0f0}[_nghost-%COMP%]     .header-info{display:flex;flex-direction:column;gap:4px}[_nghost-%COMP%]     .panel-title{margin:0;font-size:16px;font-weight:600;color:#212529}[_nghost-%COMP%]     .selected-count{font-size:12px;color:#6c757d;font-weight:400}[_nghost-%COMP%]     .header-actions{display:flex;flex-direction:column;gap:8px;align-items:flex-end}[_nghost-%COMP%]     .selected-info{flex:1}[_nghost-%COMP%]     .selected-count{display:flex;align-items:center;gap:6px;margin:0 0 4px;font-size:15px;font-weight:600;color:#212529}[_nghost-%COMP%]     .selected-count span[nz-icon]{font-size:16px}[_nghost-%COMP%]     .selected-tip{font-size:11px;color:#adb5bd;margin:0}[_nghost-%COMP%]     .clear-btn, [_nghost-%COMP%]     .clear-all-btn{font-size:12px;padding:2px 8px;height:24px;border-radius:4px;display:flex;align-items:center;gap:4px}[_nghost-%COMP%]     .clear-btn:hover, [_nghost-%COMP%]     .clear-all-btn:hover{background-color:#ff4d4f1a}[_nghost-%COMP%]     .clear-btn:disabled, [_nghost-%COMP%]     .clear-all-btn:disabled{opacity:.5;cursor:not-allowed}[_nghost-%COMP%]     .clear-btn span[nz-icon], [_nghost-%COMP%]     .clear-all-btn span[nz-icon]{font-size:12px}[_nghost-%COMP%]     .clear-all-btn{color:#ff4d4f;border-color:#ff4d4f}[_nghost-%COMP%]     .clear-all-btn:hover{background-color:#ff4d4f1a;border-color:#ff7875}[_nghost-%COMP%]     .selected-items{max-height:450px;overflow-y:auto}[_nghost-%COMP%]     .tags-container{display:flex;flex-direction:column;gap:16px;margin-bottom:16px}[_nghost-%COMP%]     .group-container{border:1px solid #f0f0f0;padding:12px;background:#fafafa;transition:all .2s ease}[_nghost-%COMP%]     .group-container:hover{border-color:#d9d9d9;box-shadow:0 2px 8px #0000001a;background:#fff}[_nghost-%COMP%]     .group-header{display:flex;align-items:center;gap:6px;padding:8px 0;border-bottom:1px solid #e9ecef;margin-bottom:12px}[_nghost-%COMP%]     .group-header span[nz-icon]{color:#6c757d;font-size:14px}[_nghost-%COMP%]     .group-header .group-label{font-size:13px;font-weight:600;color:#495057}[_nghost-%COMP%]     .group-header .group-count{font-size:11px;color:#6c757d;font-weight:400}[_nghost-%COMP%]     .group-tags{margin-bottom:12px}[_nghost-%COMP%]     .group-empty{display:flex;align-items:center;gap:6px;padding:16px 0;justify-content:center;color:#adb5bd}[_nghost-%COMP%]     .group-empty span[nz-icon]{font-size:16px;opacity:.6}[_nghost-%COMP%]     .group-empty .empty-text{font-size:12px;color:#adb5bd}[_nghost-%COMP%]     .group-actions{display:flex;justify-content:flex-end;padding-top:8px;border-top:1px solid #e9ecef}[_nghost-%COMP%]     .clear-group-btn{font-size:11px;padding:2px 8px;height:22px;border-radius:4px;display:flex;align-items:center;gap:4px;color:#ff4d4f;border-color:#ff4d4f}[_nghost-%COMP%]     .clear-group-btn:hover{background-color:#ff4d4f1a;border-color:#ff7875}[_nghost-%COMP%]     .clear-group-btn span[nz-icon]{font-size:11px}[_nghost-%COMP%]     .custom-tag.ant-tag-blue{background:linear-gradient(135deg,#1890ff 0%,#40a9ff 100%)}[_nghost-%COMP%]     .custom-tag.ant-tag-green{background:linear-gradient(135deg,#52c41a 0%,#73d13d 100%)}[_nghost-%COMP%]     .custom-tag.ant-tag-orange{background:linear-gradient(135deg,#fa8c16 0%,#ffa940 100%)}[_nghost-%COMP%]     .custom-tag.ant-tag-purple{background:linear-gradient(135deg,#722ed1 0%,#9254de 100%)}[_nghost-%COMP%]     .item-list::-webkit-scrollbar, [_nghost-%COMP%]     .selected-items::-webkit-scrollbar{width:4px}[_nghost-%COMP%]     .item-list::-webkit-scrollbar-track, [_nghost-%COMP%]     .selected-items::-webkit-scrollbar-track{background:#f8f9fa;border-radius:2px}[_nghost-%COMP%]     .item-list::-webkit-scrollbar-thumb, [_nghost-%COMP%]     .selected-items::-webkit-scrollbar-thumb{background:#ced4da;border-radius:2px}[_nghost-%COMP%]     .item-list::-webkit-scrollbar-thumb:hover, [_nghost-%COMP%]     .selected-items::-webkit-scrollbar-thumb:hover{background:#adb5bd}@media (max-width: 900px){[_nghost-%COMP%]     .upms-select-container{flex-direction:column;gap:12px;min-height:auto}[_nghost-%COMP%]     .left-panel, [_nghost-%COMP%]     .right-panel{flex:none;border-right:none;border-bottom:1px solid #f0f0f0;padding:0 8px}[_nghost-%COMP%]     .left-panel{padding-bottom:12px}[_nghost-%COMP%]     .right-panel{border-bottom:none;padding-top:12px}[_nghost-%COMP%]     .tabs{justify-content:center}[_nghost-%COMP%]     .tab-item{padding:8px 12px;font-size:13px}[_nghost-%COMP%]     .item-list, [_nghost-%COMP%]     .selected-items{max-height:200px}[_nghost-%COMP%]     .tags-container{gap:12px}[_nghost-%COMP%]     .group-container{padding:8px}[_nghost-%COMP%]     .group-header{padding:6px 0;margin-bottom:8px}[_nghost-%COMP%]     .group-header .group-label{font-size:12px}[_nghost-%COMP%]     .group-header .group-count{font-size:10px}[_nghost-%COMP%]     .group-tags{margin-bottom:8px}[_nghost-%COMP%]     .group-empty{padding:12px 0}[_nghost-%COMP%]     .group-empty span[nz-icon]{font-size:14px}[_nghost-%COMP%]     .group-empty .empty-text{font-size:11px}[_nghost-%COMP%]     .group-actions{padding-top:6px}[_nghost-%COMP%]     .clear-group-btn{font-size:10px;padding:1px 6px;height:20px}[_nghost-%COMP%]     .custom-tag{padding:4px 8px;font-size:11px}[_nghost-%COMP%]     .custom-tag .tag-text{max-width:60px}[_nghost-%COMP%]     .header-actions{flex-direction:row;gap:6px}[_nghost-%COMP%]     .item-list-header{flex-direction:column;gap:4px;align-items:flex-start}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}[_nghost-%COMP%]     .item-item, [_nghost-%COMP%]     .custom-tag{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}[_nghost-%COMP%]     .item-item nz-checkbox   .ant-checkbox-wrapper .ant-checkbox .ant-checkbox-inner{border-color:#d9d9d9;border-radius:3px}[_nghost-%COMP%]     .item-item nz-checkbox   .ant-checkbox-wrapper .ant-checkbox .ant-checkbox-inner:hover{border-color:#1890ff}[_nghost-%COMP%]     .item-item nz-checkbox   .ant-checkbox-wrapper .ant-checkbox.ant-checkbox-checked .ant-checkbox-inner{background-color:#1890ff;border-color:#1890ff}[_nghost-%COMP%]       .ant-tooltip .ant-tooltip-inner{font-size:11px;padding:4px 8px;border-radius:4px}"]})}}return t})();var Ko=c(7239),Zo=c.n(Ko);let an=(()=>{class t extends X{constructor(){super(...arguments),this.modelChange=new e.bkB}onSelect(){}onInsertNode(n){}onInsertFlexNode(n){}type(){return h.END}color(){return"#80929C"}name(){return"END"}create(){return{id:O(),type:this.type(),name:this.name()}}onDelete(){}onSaveProp(){}static{this.\u0275fac=function(){let n;return function(o){return(n||(n=e.xGo(t)))(o||t)}}()}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-end-node"]],inputs:{progress:"progress",model:"model"},outputs:{modelChange:"modelChange"},features:[e.Vt3],decls:2,vars:1,consts:[[1,"process-end",3,"ngClass"]],template:function(i,o){1&i&&(e.j41(0,"div",0),e.EFF(1,"\u6d41\u7a0b\u7ed3\u675f"),e.k0s()),2&i&&e.Y8G("ngClass",null==o.progress?null:o.progress[o.model.id])},dependencies:[d.YU],styles:["[_nghost-%COMP%]   .process-end[_ngcontent-%COMP%]{text-align:center;padding:10px;border-radius:5px;background:#e5e5e5;margin-top:8px;min-width:100px}"]})}}return t})();var V=function(t){return t.TODO="TODO",t.DONE="DONE",t.CC="CC",t.CREATED="CREATED",t.ADMIN="ADMIN",t}(V||{}),sn=function(t){return t.NEXT="NEXT",t.WAIT="WAIT",t.WAIT_API_TRIGGER="WAIT_API_TRIGGER",t.ERROR="ERROR",t.REENTRY="REENTRY",t.END="END",t}(sn||{});const ni=function(t){return{"p-branch-end":t}};let ti=(()=>{class t{constructor(){this.nodeType=h,this.readonly=!1,this.branch=[],this.index=0,this.modelValueChange=new e.bkB,this.select=new e.bkB,this.delete=new e.bkB,this.insertNode=new e.bkB}onInsertNode(n){this.insertNode.emit({branch:this.branch,index:this.index,type:n})}onInsertFlexNode(n){A(this.branch,this.index,n)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-gateway-join"]],inputs:{readonly:"readonly",eruptBuild:"eruptBuild",modelValue:"modelValue",branch:"branch",index:"index",progress:"progress"},outputs:{modelValueChange:"modelValueChange",select:"select",delete:"delete",insertNode:"insertNode"},decls:6,vars:9,consts:[[2,"position","relative"],[2,"display","flex","justify-content","center"],["title","\u7f51\u5173\u6c47\u805a",3,"ngClass"],["viewBox","0 0 1024 1024","version","1.1","xmlns","http://www.w3.org/2000/svg","width","40","height","40",1,"icon"],["fill","#d9d9d9","d","M537.6 409.6L537.6 307.2 896 307.2 896 0l-51.2 0 0 256.00000001-307.2-1e-8L537.6 51.2l-51.2 0 0 204.8-307.2 1e-8L179.2 0l-51.2 0 0 307.2 358.4 0 0 102.4-102.4 0 128 204.8 128-204.8-102.4 0z m153.6 563.2l0-256c0-28.16-23.04-51.2-51.2-51.2l-256 0c-28.16 0-51.2 23.04-51.2 51.2l0 256c0 28.16 23.04 51.2 51.2 51.2L640 1024c28.16 0 51.2-23.04 51.2-51.2z"],[3,"progress","eruptBuild","readonly","showBody","insertFlexNode","insertNode"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.qSk(),e.j41(3,"svg",3),e.nrm(4,"path",4),e.k0s()()(),e.joV(),e.j41(5,"erupt-node",5),e.bIt("insertFlexNode",function(s){return o.onInsertFlexNode(s)})("insertNode",function(s){return o.insertNode.emit({branch:o.branch,index:o.index,type:s})}),e.k0s()()),2&i&&(e.R7$(2),e.Y8G("ngClass",null==o.progress?null:o.progress[o.modelValue.id]),e.R7$(3),e.HbH(e.eq3(7,ni,o.branch.length===o.index+1)),e.Y8G("progress",o.progress)("eruptBuild",o.eruptBuild)("readonly",o.readonly)("showBody",!1))},dependencies:[d.YU,$.Y]})}}return t})();function oi(t,a){if(1&t){const n=e.RV6();e.j41(0,"app-start-node",5),e.bIt("modelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.node=o)})("modelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.nodeChange.emit(o))})("insertNode",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.insertNodeFun(r.branch,o.index,o.type))})("delete",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.deleteNode(r.branch,o.index))})("select",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.select.emit(o))}),e.k0s()}if(2&t){const n=e.XpG();e.Y8G("readonly",n.readonly)("model",n.node)("eruptBuild",n.eruptBuild)("branch",n.branch)("index",n.index)("progress",n.progress)}}function ii(t,a){if(1&t){const n=e.RV6();e.j41(0,"app-end-node",6),e.bIt("modelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.node=o)}),e.k0s()}if(2&t){const n=e.XpG();e.Y8G("progress",n.progress)("model",n.node)}}function ri(t,a){if(1&t){const n=e.RV6();e.j41(0,"erupt-flex-node",7),e.bIt("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.node=o)})("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.nodeChange.emit(o))})("insertNode",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.insertNodeFun(r.branch,o.index,o.type))})("delete",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.deleteNode(r.branch,o.index))})("select",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.select.emit(o))}),e.k0s()}if(2&t){const n=e.XpG();e.Y8G("readonly",n.readonly)("modelValue",n.node)("eruptBuild",n.eruptBuild)("branch",n.branch)("index",n.index)("progress",n.progress)}}function ai(t,a){if(1&t){const n=e.RV6();e.j41(0,"app-sub-node",7),e.bIt("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.node=o)})("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.nodeChange.emit(o))})("insertNode",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.insertNodeFun(r.branch,o.index,o.type))})("delete",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.deleteNode(r.branch,o.index))})("select",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.select.emit(o))}),e.k0s()}if(2&t){const n=e.XpG();e.Y8G("readonly",n.readonly)("modelValue",n.node)("eruptBuild",n.eruptBuild)("branch",n.branch)("index",n.index)("progress",n.progress)}}function si(t,a){if(1&t){const n=e.RV6();e.j41(0,"app-approval-node",7),e.bIt("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.node=o)})("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.nodeChange.emit(o))})("insertNode",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.insertNodeFun(r.branch,o.index,o.type))})("delete",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.deleteNode(r.branch,o.index))})("select",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.select.emit(o))}),e.k0s()}if(2&t){const n=e.XpG();e.Y8G("readonly",n.readonly)("modelValue",n.node)("eruptBuild",n.eruptBuild)("branch",n.branch)("index",n.index)("progress",n.progress)}}function li(t,a){if(1&t){const n=e.RV6();e.j41(0,"app-cc-node",7),e.bIt("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.node=o)})("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.nodeChange.emit(o))})("insertNode",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.insertNodeFun(r.branch,o.index,o.type))})("delete",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.deleteNode(r.branch,o.index))})("select",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.select.emit(o))}),e.k0s()}if(2&t){const n=e.XpG();e.Y8G("readonly",n.readonly)("modelValue",n.node)("eruptBuild",n.eruptBuild)("branch",n.branch)("index",n.index)("progress",n.progress)}}function ci(t,a){if(1&t){const n=e.RV6();e.j41(0,"app-gateway-join",7),e.bIt("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.node=o)})("modelValueChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.nodeChange.emit(o))})("insertNode",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.insertNodeFun(r.branch,o.index,o.type))})("delete",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.deleteNode(r.branch,o.index))})("select",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.select.emit(o))}),e.k0s()}if(2&t){const n=e.XpG();e.Y8G("readonly",n.readonly)("modelValue",n.node)("eruptBuild",n.eruptBuild)("branch",n.branch)("index",n.index)("progress",n.progress)}}function pi(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",13),e.bIt("click",function(){e.eBV(n);const o=e.XpG(2);return e.Njj(o.addBranch())}),e.EFF(1," \u6dfb\u52a0\u5206\u652f "),e.k0s()}}function di(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"app-recursive-node",16),e.bIt("nodeChange",function(o){const s=e.eBV(n).index,u=e.XpG().$implicit;return e.Njj(u[s]=o)})("insertNode",function(o){e.eBV(n);const r=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.insertNodeFun(r.branches,o.index,o.type))})("delete",function(o){e.eBV(n);const r=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.deleteNode(r.branches,o.index))})("select",function(o){e.eBV(n);const r=e.XpG(3);return e.Njj(r.select.emit(o))}),e.k0s(),e.bVm()}if(2&t){const n=a.$implicit,i=a.index,o=e.XpG().$implicit,r=e.XpG(2);e.R7$(1),e.Y8G("eruptBuild",r.eruptBuild)("readonly",r.readonly)("node",n)("progress",r.progress)("branch",o.branches)("index",i)}}function _i(t,a){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"div")(2,"app-gateway-node",14),e.bIt("modelValueChange",function(o){const s=e.eBV(n).index,u=e.XpG(2);return e.Njj(u.node.branches[s]=o)})("insertNode",function(o){const s=e.eBV(n).index,u=e.XpG(2);return e.Njj(u.insertNodeFun(u.node.branches[s].branches,-1,o.type))})("delete",function(){const r=e.eBV(n).index,s=e.XpG(2);return e.Njj(s.deleteBranch(r))})("copy",function(){const r=e.eBV(n).index,s=e.XpG(2);return e.Njj(s.copyBranch(r))})("moveL",function(){const r=e.eBV(n).index,s=e.XpG(2);return e.Njj(s.moveL(r))})("moveR",function(){const r=e.eBV(n).index,s=e.XpG(2);return e.Njj(s.moveR(r))})("select",function(o){const s=e.eBV(n).index,u=e.XpG(2);return e.Njj(u.selectFun(o,s))}),e.k0s(),e.DNE(3,di,2,6,"ng-container",15),e.k0s()()}if(2&t){const n=a.$implicit,i=a.index,o=e.XpG(2);e.HbH("p-branch-item"+(0===i?" p-branch-item-l":"")+(i===o.node.branches.length-1?" p-branch-item-r":"")),e.R7$(2),e.Y8G("readonly",o.readonly)("modelValue",o.node.branches[i])("index",i)("progress",o.progress)("eruptBuild",o.eruptBuild)("branch",o.node.branches[i].branches)("moveRn",o.node.type===o.nodeType.GATEWAY_PARALLEL?i<o.node.branches.length-1:i<o.node.branches.length-2)("moveLn",i>0)("isDefault",(null==n.prop?null:n.prop.type)===o.BranchType.ELSE)("gatewayType",o.node.type===o.nodeType.GATEWAY_PARALLEL?o.gatewayType.PARALLEL:o.node.type===o.nodeType.GATEWAY_EXCLUSION?o.gatewayType.EXCLUSIVE:o.gatewayType.INCLUSIVE),e.R7$(1),e.Y8G("ngForOf",n.branches)}}const ui=function(t){return{"p-branch-end":t}};function gi(t,a){if(1&t){const n=e.RV6();e.j41(0,"erupt-node",17),e.bIt("insertFlexNode",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.onInsertFlexNode(o))})("insertNode",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.insertNodeFun(r.branch,r.index,o))}),e.k0s()}if(2&t){const n=e.XpG(2);e.HbH(e.eq3(6,ui,n.branch.length===n.index+1)),e.Y8G("eruptBuild",n.eruptBuild)("readonly",n.readonly)("progress",n.progress)("showBody",!1)}}function mi(t,a){if(1&t&&(e.j41(0,"div",8)(1,"div",9),e.DNE(2,pi,2,0,"button",10),e.DNE(3,_i,4,13,"div",11),e.k0s(),e.DNE(4,gi,1,8,"erupt-node",12),e.k0s()),2&t){const n=e.XpG();e.R7$(2),e.Y8G("ngIf",!n.readonly),e.R7$(1),e.Y8G("ngForOf",n.node.branches),e.R7$(1),e.Y8G("ngIf",n.node.type===n.nodeType.GATEWAY_EXCLUSION)}}let fi=(()=>{class t{constructor(){this.readonly=!1,this.branch=[],this.index=0,this.nodeChange=new e.bkB,this.select=new e.bkB,this.delete=new e.bkB,this.insertNode=new e.bkB,this.nodeType=h,this.gatewayType=b,this.BranchType=B}insertNodeFun(n,i,o){const r=ke[o].create();n.splice(i+1,0,r),(r.type===h.GATEWAY_PARALLEL||r.type===h.GATEWAY_INCLUSIVE)&&n.splice(i+2,0,{id:O(),type:h.GATEWAY_JOIN,name:r.type+"_JOIN"})}onInsertFlexNode(n){A(this.branch,this.index,n)}deleteNode(n,i){console.log(n[i].type),n.splice(i,n[i].type===h.GATEWAY_PARALLEL||n[i].type===h.GATEWAY_INCLUSIVE?2:1)}addBranch(){let n=!1;for(let r of this.node.branches)r.prop?.type===B.ELSE&&(n=!0);const i=this.node.branches.length-(n?1:0);this.node.branches.splice(i,0,ke[this.node.type].createBranch(i))}deepCopy(n){return JSON.parse(JSON.stringify(n))}copyBranch(n){const i=this.deepCopy(this.node.branches[n]);i.name=i.name+"-copy";const o=this.deepCopy(this.node.branches[n]);le(i),le(o),this.node.branches.splice(n+1,0,o)}deleteBranch(n){this.node.branches.length<=2?this.deleteNode(this.branch,this.index):this.node.branches.splice(n,1)}moveL(n){this.exchange(this.node.branches,n,n-1)}moveR(n){this.exchange(this.node.branches,n,n+1)}exchange(n,i,o){const r=n[i];n[i]=n[o],n[o]=r}selectFun(n,i){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-recursive-node"]],inputs:{readonly:"readonly",node:"node",branch:"branch",index:"index",progress:"progress",eruptBuild:"eruptBuild"},outputs:{nodeChange:"nodeChange",select:"select",delete:"delete",insertNode:"insertNode"},decls:9,vars:8,consts:[[3,"ngSwitch"],[3,"readonly","model","eruptBuild","branch","index","progress","modelChange","insertNode","delete","select",4,"ngSwitchCase"],[3,"progress","model","modelChange",4,"ngSwitchCase"],[3,"readonly","modelValue","eruptBuild","branch","index","progress","modelValueChange","insertNode","delete","select",4,"ngSwitchCase"],["class","p-gateway",4,"ngSwitchDefault"],[3,"readonly","model","eruptBuild","branch","index","progress","modelChange","insertNode","delete","select"],[3,"progress","model","modelChange"],[3,"readonly","modelValue","eruptBuild","branch","index","progress","modelValueChange","insertNode","delete","select"],[1,"p-gateway"],[1,"p-branch"],["nz-button","","nzType","default","nzShape","round","class","p-gateway-add",3,"click",4,"ngIf"],[3,"class",4,"ngFor","ngForOf"],[3,"eruptBuild","readonly","progress","class","showBody","insertFlexNode","insertNode",4,"ngIf"],["nz-button","","nzType","default","nzShape","round",1,"p-gateway-add",3,"click"],[3,"readonly","modelValue","index","progress","eruptBuild","branch","moveRn","moveLn","isDefault","gatewayType","modelValueChange","insertNode","delete","copy","moveL","moveR","select"],[4,"ngFor","ngForOf"],[3,"eruptBuild","readonly","node","progress","branch","index","nodeChange","insertNode","delete","select"],[3,"eruptBuild","readonly","progress","showBody","insertFlexNode","insertNode"]],template:function(i,o){1&i&&(e.qex(0,0),e.DNE(1,oi,1,6,"app-start-node",1),e.DNE(2,ii,1,2,"app-end-node",2),e.DNE(3,ri,1,6,"erupt-flex-node",3),e.DNE(4,ai,1,6,"app-sub-node",3),e.DNE(5,si,1,6,"app-approval-node",3),e.DNE(6,li,1,6,"app-cc-node",3),e.DNE(7,ci,1,6,"app-gateway-join",3),e.DNE(8,mi,5,3,"div",4),e.bVm()),2&i&&(e.Y8G("ngSwitch",o.node.type),e.R7$(1),e.Y8G("ngSwitchCase",o.nodeType.START),e.R7$(1),e.Y8G("ngSwitchCase",o.nodeType.END),e.R7$(1),e.Y8G("ngSwitchCase",o.nodeType.FlEX),e.R7$(1),e.Y8G("ngSwitchCase",o.nodeType.SUB),e.R7$(1),e.Y8G("ngSwitchCase",o.nodeType.APPROVAL),e.R7$(1),e.Y8G("ngSwitchCase",o.nodeType.CC),e.R7$(1),e.Y8G("ngSwitchCase",o.nodeType.GATEWAY_JOIN))},dependencies:[d.Sq,d.bT,d.ux,d.e1,d.fG,v.aO,M.c,T.p,Pe,We,qe,ge,$.Y,t,nn,an,ti,tn],styles:['.p-gateway[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;position:relative;width:100%}.p-gateway[_ngcontent-%COMP%]   .p-gateway-add[_ngcontent-%COMP%]{z-index:2;top:-16px;position:absolute}.p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]{display:flex;position:relative;justify-content:center;background:#f5f5f5;width:100%}.p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]:before, .p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]:after{content:"";position:absolute;left:160px;right:160px;height:2px;background:#d9d9d9;z-index:0}.p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]:before{top:0}.p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]:after{bottom:0}.p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]   .p-branch-item[_ngcontent-%COMP%]{position:relative;padding:0 60px;display:flex;justify-content:center}.p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]   .p-branch-item[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{z-index:1;margin-top:40px;display:flex;flex-direction:column;align-items:center}.p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]   .p-branch-item[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > .p-node[_ngcontent-%COMP%]:last-child   [_ngcontent-%COMP%]:deep(.p-node-add):after{display:none!important}.p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]   .p-branch-item[_ngcontent-%COMP%]:before{content:"";position:absolute;background:#d9d9d9;height:100%;width:2px}.p-gateway[_ngcontent-%COMP%]   .p-branch[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:deep(.p-branch-end   .p-node-add)[_ngcontent-%COMP%]:after{display:none!important}']})}}return t})();const hi=["canvasContainer"],Ci=["node"];function bi(t,a){if(1&t&&(e.j41(0,"div",16),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t){const n=a.$implicit;e.Y8G("ngClass",n),e.R7$(1),e.SpI(" ",e.bMT(2,2,n)," ")}}function vi(t,a){if(1&t&&(e.j41(0,"div",14),e.DNE(1,bi,3,4,"div",15),e.nI1(2,"enumToArray"),e.k0s()),2&t){const n=e.XpG();e.R7$(1),e.Y8G("ngForOf",e.bMT(2,1,n.FlowTurn))}}function xi(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"app-recursive-node",17,18),e.bIt("nodeChange",function(o){const s=e.eBV(n).index,u=e.XpG();return u.modelValue[s]=o,e.Njj(u.modelValueChange.emit(u.modelValue))})("select",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.selectNode(o))}),e.k0s(),e.bVm()}if(2&t){const n=a.$implicit,i=a.index,o=e.XpG();e.R7$(1),e.Y8G("readonly",o.readonly)("eruptBuild",o.eruptBuild)("node",n)("branch",o.modelValue)("progress",o.progress)("index",i)}}let Ge=(()=>{class t{constructor(n){this.message=n,this.modelValue=[],this.readonly=!1,this.modelValueChange=new e.bkB,this.select=new e.bkB,this.isDragging=!1,this.startX=0,this.startY=0,this.startScrollLeft=0,this.startScrollTop=0,this.scale=1,this.minScale=.1,this.maxScale=3,this.scaleStep=.1,this.zoomSupported=this.checkZoomSupport(),this.FlowTurn=sn}checkZoomSupport(){const n=document.createElement("div");return n.style.zoom="1.1","1.1"===n.style.zoom}ngAfterViewInit(){this.initCanvasDrag()}ngOnInit(){this.modelValue||(this.modelValue=[(new Pe).create(),(new an).create()],this.modelValueChange.emit(this.modelValue))}initCanvasDrag(){if(this.canvasContainer){const n=this.canvasContainer.nativeElement;n.style.cursor="grab",n.style.userSelect="none"}}getScrollableContainer(){if(!this.canvasContainer)return null;let n=this.canvasContainer.nativeElement.parentElement;for(;n;){const i=window.getComputedStyle(n);if("auto"===i.overflow||"scroll"===i.overflow||"auto"===i.overflowX||"scroll"===i.overflowX||"auto"===i.overflowY||"scroll"===i.overflowY)return n;n=n.parentElement}return this.canvasContainer.nativeElement.closest(".flow")}getProcessRenderElement(){return this.canvasContainer?this.canvasContainer.nativeElement.querySelector(".process"):null}applyScale(){const n=this.getProcessRenderElement();n&&(this.zoomSupported?(n.style.zoom=this.scale.toString(),n.style.transform="",n.style.transformOrigin=""):(n.style.transform=`scale(${this.scale})`,n.style.transformOrigin="center center",n.style.zoom=""))}onMouseDown(n){const i=n.target,o=this.canvasContainer?.nativeElement;if(o&&(i===o||o.contains(i))){if(i.closest("button, input, select, textarea, [contenteditable], .node-input, .node-edit, .node-delete, .insert-btn"))return;this.isDragging=!0,this.startX=n.clientX,this.startY=n.clientY;const s=this.getScrollableContainer();s&&(this.startScrollLeft=s.scrollLeft,this.startScrollTop=s.scrollTop),o.style.cursor="grabbing"}}onMouseMove(n){if(this.isDragging){const i=this.startX-n.clientX,o=this.startY-n.clientY,r=this.getScrollableContainer();r&&(r.scrollLeft=this.startScrollLeft+i,r.scrollTop=this.startScrollTop+o),n.preventDefault()}}onMouseUp(n){this.isDragging&&(this.isDragging=!1,this.canvasContainer.nativeElement.style.cursor="grab")}onMouseLeave(n){this.isDragging&&(this.isDragging=!1,this.canvasContainer.nativeElement.style.cursor="grab")}selectNode(n){this.select.emit(n)}doZoom(n){this.scale=n>0?Math.min(this.maxScale,this.scale+this.scaleStep):Math.max(this.minScale,this.scale-this.scaleStep),this.applyScale()}doHit(){this.scale=1,this.applyScale();const n=this.getScrollableContainer();if(n){const i=n.scrollWidth-n.clientWidth;n.scrollLeft=i>0?i/2:0,n.scrollTop=0}}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(R.xh))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["erupt-flow"]],viewQuery:function(i,o){if(1&i&&(e.GBs(hi,5),e.GBs(Ci,5)),2&i){let r;e.mGM(r=e.lsd())&&(o.canvasContainer=r.first),e.mGM(r=e.lsd())&&(o.nodeRefs=r)}},hostBindings:function(i,o){1&i&&e.bIt("mousedown",function(s){return o.onMouseDown(s)})("mousemove",function(s){return o.onMouseMove(s)})("mouseup",function(s){return o.onMouseUp(s)})("mouseleave",function(s){return o.onMouseLeave(s)})},inputs:{modelValue:"modelValue",eruptBuild:"eruptBuild",readonly:"readonly",progress:"progress"},outputs:{modelValueChange:"modelValueChange",select:"select"},decls:17,vars:6,consts:[[1,"flow"],[1,"operation"],["style","zoom: .6",4,"ngIf"],[1,"operation-zoom"],["nz-button","","nzSize","small",3,"click"],["nz-icon","","nzType","minus"],[1,"zoom-text"],["nz-button","","nzSize","small","title","\u91cd\u7f6e\u89c6\u56fe",3,"click"],["nz-icon","","nzType","reload"],["nz-icon","","nzType","plus"],[1,"canvas-container",2,"width","100%","height","100%","position","relative"],["canvasContainer",""],["id","flow-canvas",1,"process"],[4,"ngFor","ngForOf"],[2,"zoom",".6"],["style","padding: 6px;margin-bottom: 16px",3,"ngClass",4,"ngFor","ngForOf"],[2,"padding","6px","margin-bottom","16px",3,"ngClass"],[3,"readonly","eruptBuild","node","branch","progress","index","nodeChange","select"],["node",""]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1),e.DNE(2,vi,3,3,"div",2),e.j41(3,"div",3)(4,"button",4),e.bIt("click",function(){return o.doZoom(-1)}),e.nrm(5,"span",5),e.k0s(),e.j41(6,"span",6),e.EFF(7),e.nI1(8,"number"),e.k0s(),e.j41(9,"button",7),e.bIt("click",function(){return o.doHit()}),e.nrm(10,"span",8),e.k0s(),e.j41(11,"button",4),e.bIt("click",function(){return o.doZoom(1)}),e.nrm(12,"span",9),e.k0s()()(),e.j41(13,"div",10,11)(15,"div",12),e.DNE(16,xi,3,6,"ng-container",13),e.k0s()()()),2&i&&(e.R7$(2),e.Y8G("ngIf",o.progress),e.R7$(5),e.SpI("",e.i5U(8,3,100*o.scale,"1.0-0"),"%"),e.R7$(9),e.Y8G("ngForOf",o.modelValue))},dependencies:[d.YU,d.Sq,d.bT,v.aO,M.c,T.p,z.Dn,fi,d.QX,Ke.y,q.$],styles:[".flow[_ngcontent-%COMP%]{width:100%;height:100%;overflow:auto;position:relative}.flow[_ngcontent-%COMP%]   .operation[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:20px;z-index:99;transition:all .3s ease}.flow[_ngcontent-%COMP%]   .operation[_ngcontent-%COMP%]   .operation-zoom[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background:rgba(255,255,255,.9);border-radius:6px;padding:8px;box-shadow:0 2px 8px #00000026;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.flow[_ngcontent-%COMP%]   .operation[_ngcontent-%COMP%]   .operation-zoom[_ngcontent-%COMP%]   .zoom-text[_ngcontent-%COMP%]{padding:0 12px;font-size:14px;color:var(--text-color);font-weight:500;min-width:50px;text-align:center}.flow[_ngcontent-%COMP%]   .operation[_ngcontent-%COMP%]   .operation-zoom[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 2px}.flow[_ngcontent-%COMP%]   .operation[_ngcontent-%COMP%]   .operation-zoom[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.flow[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]{cursor:grab;user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;position:relative;width:100%;height:100%}.flow[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]:active{cursor:grabbing}.flow[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]   .process[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;min-width:100%;min-height:100%;padding:40px;width:max-content;height:max-content;transform-origin:center center}.flow[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]   .process[_ngcontent-%COMP%]   .process-node[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%;margin-bottom:28px;min-width:200px}.flow[_ngcontent-%COMP%]   .canvas-container[_ngcontent-%COMP%]   .process[_ngcontent-%COMP%]   .process-end[_ngcontent-%COMP%]{text-align:center;padding:10px;border-radius:5px;background:#e5e5e5;margin-top:16px;min-width:100px}.process-designer[_ngcontent-%COMP%]{display:block;min-width:100%;min-height:100%;position:relative}"]})}}return t})();function wi(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",15),e.bIt("click",function(o){const s=e.eBV(n).$implicit,u=e.XpG();return e.Njj(u.selectColor(s,o))}),e.k0s()}if(2&t){const n=a.$implicit,i=e.XpG();e.Aen(i.getIconOptionStyle(n)),e.AVh("selected",i.previewColor===n)}}function Mi(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",16),e.bIt("click",function(o){const s=e.eBV(n).$implicit,u=e.XpG();return e.Njj(u.selectIcon(s,o))}),e.j41(1,"div",17),e.nrm(2,"i"),e.k0s()()}if(2&t){const n=a.$implicit,i=e.XpG();e.AVh("selected",i.previewIcon===n),e.R7$(2),e.HbH(n)}}let zi=(()=>{class t{constructor(){this.configChange=new e.bkB,this.previewIcon="fa fa-user",this.previewColor="#1890ff",this.bgColors=["#1890ff","#52c41a","#fa8c16","#f5222d","#722ed1","#13c2c2","#eb2f96","#8c8c8c","#096dd9","#389e0d","#d48806"],this.icons=["fa fa-user","fa fa-credit-card","fa fa-bell","fa fa-folder","fa fa-calendar","fa fa-car","fa fa-yen","fa fa-legal","fa fa-clock-o","fa fa-file-text","fa fa-users","fa fa-exchange","fa fa-bolt","fa fa-map-marker","fa fa-user-circle","fa fa-user-times","fa fa-file-text-o","fa fa-plane","fa fa-lightbulb-o","fa fa-pie-chart","fa fa-bullseye","fa fa-sitemap","fa fa-building","fa fa-cog","fa fa-search","fa fa-trash","fa fa-save","fa fa-print","fa fa-download","fa fa-upload","fa fa-share","fa fa-check-circle","fa fa-exclamation-triangle","fa fa-times-circle","fa fa-info-circle","fa fa-question-circle","fa fa-lock","fa fa-unlock","fa fa-eye","fa fa-eye-slash"]}ngOnInit(){this.initPreview()}initPreview(){this.previewIcon=this.selectedIcon,this.previewColor=this.selectedColor}selectIcon(n,i){i.stopPropagation(),this.previewIcon=n}selectColor(n,i){i.stopPropagation(),this.previewColor=n}confirmSelection(){this.configChange.emit({icon:this.previewIcon,color:this.previewColor})}cancelSelection(){this.previewIcon=this.selectedIcon,this.previewColor=this.selectedColor}getIconOptionStyle(n){return`background-color: ${n}`}getPreviewIconStyle(){return`background-color: ${this.previewColor}`}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-icon-color-picker"]],inputs:{selectedIcon:"selectedIcon",selectedColor:"selectedColor"},outputs:{configChange:"configChange"},decls:22,vars:7,consts:[[1,"icon-selector-content"],[1,"preview-section"],[1,"preview-display"],[1,"preview-icon"],[1,"selection-section"],[1,"color-section"],[1,"color-grid"],["class","color-item",3,"selected","style","click",4,"ngFor","ngForOf"],[1,"icon-section"],[1,"icon-grid"],["class","icon-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"action-buttons"],[1,"buttons"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"click"],[1,"color-item",3,"click"],[1,"icon-item",3,"click"],[1,"icon-square",2,"color","#000"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.nrm(4,"i"),e.k0s()()(),e.j41(5,"div",4)(6,"div",5)(7,"h4"),e.EFF(8,"\u9009\u62e9\u989c\u8272"),e.k0s(),e.j41(9,"div",6),e.DNE(10,wi,1,4,"div",7),e.k0s()(),e.j41(11,"div",8)(12,"h4"),e.EFF(13,"\u9009\u62e9\u56fe\u6807"),e.k0s(),e.j41(14,"div",9),e.DNE(15,Mi,3,5,"div",10),e.k0s()()(),e.j41(16,"div",11)(17,"div",12)(18,"button",13),e.bIt("click",function(){return o.cancelSelection()}),e.EFF(19," \u53d6\u6d88 "),e.k0s(),e.j41(20,"button",14),e.bIt("click",function(){return o.confirmSelection()}),e.EFF(21," \u786e\u8ba4\u9009\u62e9 "),e.k0s()()()()),2&i&&(e.R7$(3),e.Aen(o.getPreviewIconStyle()),e.R7$(1),e.HbH(o.previewIcon),e.R7$(6),e.Y8G("ngForOf",o.bgColors),e.R7$(5),e.Y8G("ngForOf",o.icons))},dependencies:[d.Sq,v.aO,M.c,T.p],styles:[".icon-selector-content[_ngcontent-%COMP%]{width:550px;max-width:90vw;background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 8px 24px #0000001f}.icon-selector-content[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff;padding:24px 24px 20px;text-align:center}.icon-selector-content[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{margin:0 0 8px;font-size:18px;font-weight:600;color:#fff}.icon-selector-content[_ngcontent-%COMP%]   .header-section[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{margin:0;font-size:13px;color:#fffc;line-height:1.4}.icon-selector-content[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;font-size:15px;font-weight:600;color:#262626}.icon-selector-content[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]{padding:12px;background:linear-gradient(135deg,#f8f9fa 0%,#e9ecef 100%);border-bottom:1px solid #e8e8e8}.icon-selector-content[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-display[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:16px}.icon-selector-content[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-display[_ngcontent-%COMP%]   .preview-icon[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;box-shadow:0 4px 16px #0003;transition:all .3s ease}.icon-selector-content[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-display[_ngcontent-%COMP%]   .preview-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:28px}.icon-selector-content[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-display[_ngcontent-%COMP%]   .preview-info[_ngcontent-%COMP%]{text-align:center}.icon-selector-content[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-display[_ngcontent-%COMP%]   .preview-info[_ngcontent-%COMP%]   .preview-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#262626;margin-bottom:6px}.icon-selector-content[_ngcontent-%COMP%]   .preview-section[_ngcontent-%COMP%]   .preview-display[_ngcontent-%COMP%]   .preview-info[_ngcontent-%COMP%]   .preview-color[_ngcontent-%COMP%]{font-size:13px;color:#666;background:rgba(255,255,255,.8);padding:4px 12px;border-radius:12px;display:inline-block}.icon-selector-content[_ngcontent-%COMP%]   .selection-section[_ngcontent-%COMP%]{padding:12px;display:flex;flex-direction:column;gap:24px}.icon-selector-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}.icon-selector-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-item[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:8px;cursor:pointer;border:3px solid transparent;transition:all .3s ease;position:relative}.icon-selector-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-item[_ngcontent-%COMP%]:hover{transform:scale(1.15);box-shadow:0 4px 12px #00000040}.icon-selector-content[_ngcontent-%COMP%]   .color-section[_ngcontent-%COMP%]   .color-grid[_ngcontent-%COMP%]   .color-item.selected[_ngcontent-%COMP%]{border-color:#1890ff;box-shadow:0 0 0 3px #1890ff4d}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(8,1fr);gap:6px;padding:2px;max-height:280px;overflow-y:auto}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-item[_ngcontent-%COMP%]{cursor:pointer;border-radius:8px;padding:6px;transition:all .3s ease;text-align:center;border:2px solid transparent;display:flex;justify-content:center}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-item[_ngcontent-%COMP%]:hover{background-color:#f0f8ff;transform:scale(1.08);border-color:#d6e4ff}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-item.selected[_ngcontent-%COMP%]{background-color:#e6f7ff;border-color:#1890ff;box-shadow:0 0 0 2px #1890ff33}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-item[_ngcontent-%COMP%]   .icon-square[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:8px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:16px;transition:all .3s ease;box-shadow:0 2px 8px #00000026}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-item[_ngcontent-%COMP%]   .icon-square[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:16px}.icon-selector-content[_ngcontent-%COMP%]   .icon-section[_ngcontent-%COMP%]   .icon-grid[_ngcontent-%COMP%]   .icon-item[_ngcontent-%COMP%]   .icon-name[_ngcontent-%COMP%]{font-size:11px;color:#666;line-height:1.3;word-break:break-word;max-width:100%;font-weight:500}.icon-selector-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding:12px;background:#fafafa;border-top:1px solid #e8e8e8}.icon-selector-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;gap:12px}.icon-selector-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:80px;height:36px;border-radius:6px;font-weight:500;transition:all .3s ease}.icon-selector-content[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}"]})}}return t})();const yi=["iconPopover"];function Oi(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",20),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.shot())}),e.EFF(1," \u5bfc\u51fa\u6d41\u7a0b\u56fe "),e.k0s()}if(2&t){const n=e.XpG();e.Y8G("nzLoading",n.shotLoading)}}function Fi(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",21),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.copyConfig())}),e.EFF(1," \u590d\u5236\u914d\u7f6e "),e.k0s()}}function Ti(t,a){if(1&t){const n=e.RV6();e.j41(0,"app-icon-color-picker",45),e.bIt("configChange",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.onIconColorConfigChange(o))}),e.k0s()}if(2&t){const n=e.XpG(2);e.Y8G("selectedIcon",n.flowConfig.icon)("selectedColor",n.flowConfig.color)}}function Ei(t,a){if(1&t&&e.nrm(0,"nz-option",42),2&t){const n=a.$implicit;e.Y8G("nzValue",n)("nzLabel",n.name)}}function Ni(t,a){1&t&&(e.j41(0,"span"),e.EFF(1,"\u5206\u7ec4\u4e3a\u7a7a,\u8bf7\u9009\u62e9"),e.k0s())}function Pi(t,a){1&t&&e.DNE(0,Ni,2,0,"span",46),2&t&&e.Y8G("ngIf",a.$implicit.hasError("required"))}function ki(t,a){if(1&t&&e.nrm(0,"nz-option",42),2&t){const n=a.$implicit;e.Y8G("nzValue",n.value)("nzLabel",n.label)}}function Ii(t,a){if(1&t&&e.nrm(0,"nz-option",42),2&t){const n=a.$implicit;e.Y8G("nzValue",n.value)("nzLabel",n.label)}}function Gi(t,a){if(1&t&&(e.qex(0),e.j41(1,"nz-tag",51),e.nrm(2,"span",52),e.j41(3,"span",53),e.EFF(4),e.k0s()(),e.bVm()),2&t){const n=a.$implicit,i=e.XpG(3);e.R7$(1),e.Y8G("nzColor",i.getScopeTagColor(n.scope)),e.R7$(1),e.Y8G("nzType",i.getScopeIcon(n.scope)),e.R7$(2),e.JRh(i.getScopeValue(n))}}function Si(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",47)(1,"div"),e.DNE(2,Gi,5,3,"ng-container",48),e.j41(3,"button",49),e.bIt("click",function(){e.eBV(n);const o=e.XpG(2);return e.Njj(o.changeSubmitPermission(o.FlowPermission.SPECIFIC))}),e.nrm(4,"i",50),e.k0s()()()}if(2&t){const n=e.XpG(2);e.R7$(2),e.Y8G("ngForOf",n.flowConfig.permissionScope)}}function Ri(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",54)(1,"span",55),e.nrm(2,"span",56),e.EFF(3," \u8bf7\u9009\u62e9\u5177\u4f53\u7684\u6743\u9650\u8303\u56f4 "),e.j41(4,"button",49),e.bIt("click",function(){e.eBV(n);const o=e.XpG(2);return e.Njj(o.changeSubmitPermission(o.FlowPermission.SPECIFIC))}),e.nrm(5,"i",50),e.k0s()()()}}const ji=function(t){return{background:t}},Vi=function(){return{minRows:3,maxRows:5}};function Di(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",22)(1,"div",23)(2,"div",24)(3,"label",25),e.EFF(4,"\u56fe\u6807"),e.k0s(),e.j41(5,"div",26)(6,"div",27)(7,"div",28),e.nrm(8,"i"),e.k0s()(),e.j41(9,"button",29,30),e.bIt("nzPopoverVisibleChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.iconPickVisibleChange(o))}),e.EFF(11," \u4fee\u6539 "),e.k0s()(),e.DNE(12,Ti,1,2,"ng-template",null,31,e.C5r),e.k0s(),e.j41(14,"div",24)(15,"label",25),e.EFF(16,"\u540d\u79f0"),e.k0s(),e.j41(17,"nz-input-group",32)(18,"input",33),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.flowConfig.name=o)}),e.k0s()()(),e.j41(19,"div",24)(20,"label",25),e.EFF(21,"\u5206\u7ec4"),e.k0s(),e.j41(22,"nz-select",34),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.flowConfig.flowGroup=o)}),e.DNE(23,Ei,1,2,"nz-option",35),e.k0s(),e.DNE(24,Pi,1,1,"ng-template",null,36,e.C5r),e.k0s(),e.j41(26,"div",24)(27,"label",25),e.EFF(28,"\u6570\u636e\u6a21\u578b"),e.k0s(),e.j41(29,"nz-select",37),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.flowConfig.erupt=o)})("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.changeErupt(o))}),e.DNE(30,ki,1,2,"nz-option",35),e.k0s()(),e.j41(31,"div",24)(32,"label",25),e.EFF(33,"\u901a\u77e5\u6e20\u9053"),e.k0s(),e.j41(34,"nz-select",38),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.flowConfig.channels=o)}),e.DNE(35,Ii,1,2,"nz-option",35),e.k0s()(),e.j41(36,"div",24)(37,"label",39),e.EFF(38,"\u8bf4\u660e"),e.k0s(),e.j41(39,"textarea",40),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.flowConfig.remark=o)}),e.k0s()(),e.j41(40,"div",24)(41,"label",25),e.EFF(42,"\u8c01\u53ef\u4ee5\u63d0\u4ea4\u8be5\u5ba1\u6279"),e.k0s(),e.j41(43,"nz-select",41),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.flowConfig.permission=o)})("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.changeSubmitPermission(o))}),e.nrm(44,"nz-option",42)(45,"nz-option",42)(46,"nz-option",42)(47,"nz-option",42),e.k0s(),e.DNE(48,Si,5,1,"div",43),e.DNE(49,Ri,6,0,"div",44),e.k0s()()()}if(2&t){const n=e.sdS(13),i=e.XpG();e.R7$(7),e.Aen(e.eq3(29,ji,i.flowConfig.color)),e.R7$(1),e.HbH(i.flowConfig.icon),e.R7$(1),e.Y8G("nzPopoverContent",n)("nzPopoverVisible",i.iconPickVisible),e.R7$(8),e.Y8G("nzAddOnAfter",i.flowConfig.code),e.R7$(1),e.Y8G("ngModel",i.flowConfig.name),e.R7$(4),e.Y8G("ngModel",i.flowConfig.flowGroup),e.R7$(1),e.Y8G("ngForOf",i.groupOptions),e.R7$(6),e.Y8G("ngModel",i.flowConfig.erupt)("disabled",(null==i.flowConfig.rule?null:i.flowConfig.rule.length)>2),e.R7$(1),e.Y8G("ngForOf",i.eruptFlows),e.R7$(4),e.Y8G("ngModel",i.flowConfig.channels),e.R7$(1),e.Y8G("ngForOf",i.noticeChannel),e.R7$(4),e.Y8G("ngModel",i.flowConfig.remark)("nzAutosize",e.lJ4(31,Vi)),e.R7$(4),e.Y8G("ngModel",i.flowConfig.permission),e.R7$(1),e.Y8G("nzValue",i.FlowPermission.ALL)("nzLabel","\u5168\u5458"),e.R7$(1),e.Y8G("nzValue",i.FlowPermission.MANAGER)("nzLabel","\u7ec4\u7ec7\u8d1f\u8d23\u4eba"),e.R7$(1),e.Y8G("nzValue",i.FlowPermission.SPECIFIC)("nzLabel","\u6307\u5b9a\u4eba\u5458"),e.R7$(1),e.Y8G("nzValue",i.FlowPermission.NO)("nzLabel","\u5747\u4e0d\u53ef\u63d0\u4ea4"),e.R7$(1),e.Y8G("ngIf",(null==i.flowConfig.permissionScope?null:i.flowConfig.permissionScope.length)>0),e.R7$(1),e.Y8G("ngIf",i.flowConfig.permission===i.FlowPermission.SPECIFIC&&(!i.flowConfig.permissionScope||0===i.flowConfig.permissionScope.length))}}function Bi(t,a){1&t&&e.nrm(0,"nz-empty",58),2&t&&e.Y8G("nzNotFoundContent","\u8bf7\u9009\u62e9\u6570\u636e\u6a21\u578b")}function Ai(t,a){if(1&t&&e.DNE(0,Bi,1,1,"nz-empty",57),2&t){const n=e.XpG();e.Y8G("ngIf",!n.flowConfig.erupt)}}function $i(t,a){if(1&t&&e.eu8(0,61),2&t){e.XpG(2);const n=e.sdS(37);e.Y8G("ngTemplateOutlet",n)}}function Yi(t,a){if(1&t&&(e.qex(0),e.j41(1,"div",62)(2,"div",63)(3,"div",64),e.nrm(4,"erupt-flow-form",65),e.k0s()()(),e.bVm()),2&t){const n=e.XpG(2);e.R7$(4),e.Y8G("eruptBuild",n.eruptBuild)("readonly",!1)}}function Xi(t,a){if(1&t&&(e.j41(0,"div",59),e.DNE(1,$i,1,1,"ng-container",60),e.DNE(2,Yi,5,2,"ng-container",46),e.k0s()),2&t){const n=e.XpG();e.R7$(1),e.Y8G("ngIf",!n.flowConfig.erupt),e.R7$(1),e.Y8G("ngIf",n.eruptBuild)}}function Li(t,a){if(1&t&&e.eu8(0,61),2&t){e.XpG(2);const n=e.sdS(37);e.Y8G("ngTemplateOutlet",n)}}function Ui(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"erupt-flow",66),e.bIt("modelValueChange",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.flowConfig.rule=o)}),e.k0s(),e.bVm()}if(2&t){const n=e.XpG(2);e.R7$(1),e.Y8G("modelValue",n.flowConfig.rule)("eruptBuild",n.eruptBuild)}}function Hi(t,a){if(1&t&&(e.j41(0,"div",59),e.DNE(1,Li,1,1,"ng-container",60),e.DNE(2,Ui,2,2,"ng-container",46),e.k0s()),2&t){const n=e.XpG();e.R7$(1),e.Y8G("ngIf",!n.flowConfig.erupt),e.R7$(1),e.Y8G("ngIf",n.eruptBuild)}}function Ji(t,a){1&t&&e.nrm(0,"nz-empty",58),2&t&&e.Y8G("nzNotFoundContent","\u8bf7\u9009\u62e9\u6570\u636e\u6a21\u578b")}function Wi(t,a){if(1&t&&(e.qex(0),e.nrm(1,"nz-option",42),e.bVm()),2&t){const n=e.XpG().$implicit;e.R7$(1),e.Y8G("nzValue",n.fieldName)("nzLabel",n.eruptFieldJson.edit.title)}}function qi(t,a){if(1&t&&(e.qex(0),e.DNE(1,Wi,2,2,"ng-container",46),e.bVm()),2&t){const n=a.$implicit,i=e.XpG(4);e.R7$(1),e.Y8G("ngIf",n.eruptFieldJson.edit.title&&(n.eruptFieldJson.edit.type===i.EditType.INPUT||n.eruptFieldJson.edit.type===i.EditType.NUMBER||n.eruptFieldJson.edit.type===i.EditType.TEXTAREA||n.eruptFieldJson.edit.type===i.EditType.DATE))}}function Qi(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",24)(1,"label",39),e.EFF(2,"\u5ba1\u6279\u5b50\u6807\u9898\u5b57\u6bb5\u8bbe\u7f6e"),e.k0s(),e.j41(3,"div",68)(4,"div",69)(5,"nz-select",70),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(3);return e.Njj(r.flowConfig.setting.subTitleFields=o)}),e.DNE(6,qi,2,1,"ng-container",48),e.k0s()()()()}if(2&t){const n=e.XpG(3);e.R7$(5),e.Y8G("ngModel",n.flowConfig.setting.subTitleFields),e.R7$(1),e.Y8G("ngForOf",n.eruptBuild.eruptModel.eruptFieldModels)}}function Ki(t,a){if(1&t&&(e.qex(0),e.DNE(1,Qi,7,2,"div",67),e.bVm()),2&t){const n=e.XpG(2);e.R7$(1),e.Y8G("ngIf",n.eruptBuild)}}function Zi(t,a){if(1&t&&(e.j41(0,"div",22)(1,"div",23),e.DNE(2,Ji,1,1,"nz-empty",57),e.DNE(3,Ki,2,1,"ng-container",46),e.k0s()()),2&t){const n=e.XpG();e.R7$(2),e.Y8G("ngIf",!n.flowConfig.erupt),e.R7$(1),e.Y8G("ngIf",n.flowConfig.erupt)}}let er=(()=>{class t{constructor(n,i,o,r,s,u){this.flowApiService=n,this.modal=i,this.dataHandlerService=o,this.msg=r,this.dataService=s,this.upmsDataService=u,this.flexNodes=[],this.iconPickVisible=!1,this.currentStep=1,this.eruptFlows=[],this.groupOptions=[],this.shotLoading=!1,this.closeConfig=new e.bkB,this.FlowPermission=de,this.EditType=p.zl}ngOnInit(){this.flowConfig=new Dn,this.flowApiService.groupList().subscribe(n=>{this.groupOptions=n.data,this.flowId&&this.flowApiService.configGet(this.flowId).subscribe(i=>{i.success&&i.data&&(this.flowConfig=i.data,this.matchFlowGroupReference(),this.flowConfig.erupt&&this.changeErupt(this.flowConfig.erupt))})}),this.flowApiService.eruptFlows().subscribe(n=>{this.eruptFlows=n.data}),this.flowApiService.flexNodes().subscribe(n=>{this.flexNodes=n.data}),this.dataService.noticeChannels().subscribe(n=>{this.noticeChannel=n.data})}ngAfterViewInit(){}changeErupt(n){this.flowApiService.eruptFlowBuild(n).subscribe(i=>{this.dataHandlerService.initErupt(i.data),this.eruptBuild=i.data,this.eruptBuild.eruptModel.eruptJson.layout.formSize=p.c8.FULL_LINE})}changeSubmitPermission(n){if(n==de.SPECIFIC){let i=this.modal.create({nzTitle:"\u8bf7\u9009\u62e9\u53ef\u89c1\u8303\u56f4",nzWidth:"880px",nzStyle:{top:"30px"},nzBodyStyle:{padding:"0"},nzContent:Qo});i.getContentComponent().flowUpmsScopes=this.flowConfig.permissionScope||[],i.getContentComponent().flowUpmsScopesChange.subscribe(o=>{this.flowConfig.permissionScope=o})}else this.flowConfig.permissionScope=null}matchFlowGroupReference(){if(this.flowConfig.flowGroup&&this.groupOptions.length>0){const n=this.groupOptions.find(i=>i.id===this.flowConfig.flowGroup.id);n&&(this.flowConfig.flowGroup=n)}}onDocumentClick(n){}switchStep(n){this.currentStep=n}onIconColorConfigChange(n){this.flowConfig.icon=n.icon,this.flowConfig.color=n.color,this.iconPickVisible=!1}iconPickVisibleChange(n){this.iconPickVisible=n}preview(){console.log("\u9884\u89c8\u5ba1\u6279\u6d41\u7a0b")}publish(){this.flowConfig.name?this.flowConfig.erupt?this.flowConfig.flowGroup?this.flowConfig.permission?this.flowConfig.channels&&0!==this.flowConfig.channels.length?this.flowApiService.ruleCheck(this.flowConfig.rule).subscribe(n=>{n.success?this.flowId?this.flowApiService.configUpdate(this.flowConfig).subscribe(i=>{i.success&&(this.msg.success("\u53d1\u5e03\u6210\u529f"),this.closeConfig.emit())}):this.flowApiService.configCreate(this.flowConfig).subscribe(i=>{i.success&&(this.msg.success("\u53d1\u5e03\u6210\u529f"),this.closeConfig.emit())}):(this.msg.error("\u89c4\u5219\u6821\u9a8c\u5931\u8d25\u8bf7\u68c0\u67e5"),n.data&&(this.flowConfig.rule=n.data))}):this.msg.warning("\u8bf7\u9009\u62e9\u901a\u77e5\u6e20\u9053"):this.msg.warning("\u8bf7\u9009\u62e9\u63d0\u4ea4\u6743\u9650"):this.msg.warning("\u8bf7\u9009\u62e9\u5206\u7ec4"):this.msg.warning("\u8bf7\u9009\u62e9\u5173\u8054\u8868"):this.msg.warning("\u8bf7\u8f93\u5165\u6d41\u7a0b\u540d\u79f0")}copyConfig(){this.flowConfig.rule&&navigator.clipboard.writeText(JSON.stringify(this.flowConfig.rule,null,2)).then(()=>{this.msg.success("\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f")})}shot(){var n=this;return(0,Vo.A)(function*(){n.shotLoading=!0;const i=document.getElementById("flow-canvas"),o=yield Zo()(i,{scale:2,useCORS:!0,allowTaint:!1}),r=document.createElement("a");r.href=o.toDataURL("image/png"),r.download=`${n.flowConfig.name||"flow"}.png`,r.click(),r.remove(),n.shotLoading=!1})()}close(){this.modal.confirm({nzTitle:"\u63d0\u793a",nzContent:"\u662f\u5426\u653e\u5f03\u5f53\u524d\u7f16\u8f91\uff1f",nzOkText:"\u786e\u5b9a",nzCancelText:"\u53d6\u6d88",nzOnOk:()=>{this.modal.closeAll(),this.closeConfig.emit()}})}getScopeTagColor(n){return{ORG:"blue",ROLE:"green",USER:"orange",POST:"purple"}[n]||"default"}getScopeIcon(n){return{ORG:"apartment",ROLE:"safety-certificate",USER:"user",POST:"idcard"}[n]||"question"}getScopeValue(n){if(n.scope==C.USER){for(let i of this.upmsDataService.upmsData.users)if(i.key==n.scopeValue)return i.value}else if(n.scope==C.ROLE){for(let i of this.upmsDataService.upmsData.roles)if(i.key==n.scopeValue)return i.value}else if(n.scope==C.POST){for(let i of this.upmsDataService.upmsData.posts)if(i.key==n.scopeValue)return i.value}else if(n.scope==C.ORG)for(let i of this.upmsDataService.upmsData.orgs)if(i.key==n.scopeValue)return i.value;return n.scopeValue.toString()}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(S),e.rXU(g.N_),e.rXU(ne.u),e.rXU(R.xh),e.rXU(en.u),e.rXU(W))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-flow-config"]],viewQuery:function(i,o){if(1&i&&e.GBs(yi,5),2&i){let r;e.mGM(r=e.lsd())&&(o.iconPopover=r.first)}},hostBindings:function(i,o){1&i&&e.bIt("click",function(s){return o.onDocumentClick(s)},!1,e.EBC)},inputs:{flowId:"flowId"},outputs:{closeConfig:"closeConfig"},decls:41,vars:14,consts:[[1,"flow-config-container"],[1,"header"],[1,"header-left"],["nz-button","","nzType","text",1,"back-btn",3,"click"],["nz-icon","","nzType","close"],[1,"title-section"],[1,"title"],[1,"header-center"],[1,"step-nav"],[1,"step-item",3,"click"],[1,"step-number"],[1,"step-text"],[1,"header-right"],["nz-button","",3,"nzLoading","click",4,"ngIf"],["nz-button","",3,"click",4,"ngIf"],["nz-button","","nzType","primary",1,"publish-btn",3,"click"],[1,"main-content"],["class","form-section",4,"ngIf"],["notFoundErupt",""],["class","step-placeholder",4,"ngIf"],["nz-button","",3,"nzLoading","click"],["nz-button","",3,"click"],[1,"form-section"],[1,"flow-form"],[1,"form-item"],[1,"form-label","required"],[1,"icon-section"],[1,"icon-display"],[1,"icon-circle"],["nz-button","","nzType","link","nz-popover","","nzPopoverTrigger","click","nzPopoverPlacement","topRight",1,"modify-link",3,"nzPopoverContent","nzPopoverVisible","nzPopoverVisibleChange"],["iconPopover",""],["iconSelectorContent",""],[3,"nzAddOnAfter"],["nz-input","","placeholder","\u8bf7\u8f93\u5165\u540d\u79f0","name","name",1,"form-input",3,"ngModel","ngModelChange"],["placeholder","\u8bf7\u9009\u62e9\u5206\u7ec4",1,"form-select",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["groupErrorTpl",""],[1,"form-select",3,"ngModel","disabled","ngModelChange"],["nzMode","multiple",1,"form-select",3,"ngModel","ngModelChange"],[1,"form-label"],["nz-input","","placeholder","\u8bf4\u660e",1,"form-textarea",3,"ngModel","nzAutosize","ngModelChange"],["placeholder","\u8bf7\u9009\u62e9\u63d0\u4ea4\u6743\u9650",1,"form-select",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel"],["class","permission-scopes",4,"ngIf"],["class","permission-scopes empty",4,"ngIf"],[3,"selectedIcon","selectedColor","configChange"],[4,"ngIf"],[1,"permission-scopes"],[4,"ngFor","ngForOf"],["nz-button","","nzType","default","nzSize","small",3,"click"],["nz-icon","","nzType","plus","nzTheme","outline"],["nz-tooltip","",3,"nzColor"],["nz-icon","","nzTheme","outline",3,"nzType"],[1,"tag-text"],[1,"permission-scopes","empty"],[1,"empty-text"],["nz-icon","","nzType","info-circle","nzTheme","outline"],["nzNotFoundImage","simple",3,"nzNotFoundContent",4,"ngIf"],["nzNotFoundImage","simple",3,"nzNotFoundContent"],[1,"step-placeholder"],[3,"ngTemplateOutlet",4,"ngIf"],[3,"ngTemplateOutlet"],[2,"display","flex","justify-content","center","height","100%","padding","16px"],[1,"phone-wrapper"],[1,"phone-wrapper-screen"],[3,"eruptBuild","readonly"],[3,"modelValue","eruptBuild","modelValueChange"],["class","form-item",4,"ngIf"],[1,"form-input",2,"display","block"],[2,"margin-top","12px"],["nzMode","multiple","nzPlaceHolder","\u8bf7\u9009\u62e9\u5b57\u6bb5",1,"form-select",3,"ngModel","ngModelChange"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),e.bIt("click",function(){return o.close()}),e.nrm(4,"i",4),e.k0s(),e.j41(5,"div",5),e.nrm(6,"h2",6),e.k0s()(),e.j41(7,"div",7)(8,"div",8)(9,"div",9),e.bIt("click",function(){return o.switchStep(1)}),e.j41(10,"span",10),e.EFF(11,"1"),e.k0s(),e.j41(12,"span",11),e.EFF(13,"\u57fa\u7840\u4fe1\u606f"),e.k0s()(),e.j41(14,"div",9),e.bIt("click",function(){return o.switchStep(2)}),e.j41(15,"span",10),e.EFF(16,"2"),e.k0s(),e.j41(17,"span",11),e.EFF(18,"\u8868\u5355\u9884\u89c8"),e.k0s()(),e.j41(19,"div",9),e.bIt("click",function(){return o.switchStep(3)}),e.j41(20,"span",10),e.EFF(21,"3"),e.k0s(),e.j41(22,"span",11),e.EFF(23,"\u6d41\u7a0b\u8bbe\u8ba1"),e.k0s()(),e.j41(24,"div",9),e.bIt("click",function(){return o.switchStep(4)}),e.j41(25,"span",10),e.EFF(26,"4"),e.k0s(),e.j41(27,"span",11),e.EFF(28,"\u66f4\u591a\u8bbe\u7f6e"),e.k0s()()()(),e.j41(29,"div",12),e.DNE(30,Oi,2,1,"button",13),e.DNE(31,Fi,2,0,"button",14),e.j41(32,"button",15),e.bIt("click",function(){return o.publish()}),e.EFF(33," \u53d1\u5e03 "),e.k0s()()(),e.j41(34,"div",16),e.DNE(35,Di,50,32,"div",17),e.DNE(36,Ai,1,1,"ng-template",null,18,e.C5r),e.DNE(38,Xi,3,2,"div",19),e.DNE(39,Hi,3,2,"div",19),e.DNE(40,Zi,4,2,"div",17),e.k0s()()),2&i&&(e.R7$(9),e.AVh("active",1===o.currentStep),e.R7$(5),e.AVh("active",2===o.currentStep),e.R7$(5),e.AVh("active",3===o.currentStep),e.R7$(5),e.AVh("active",4===o.currentStep),e.R7$(6),e.Y8G("ngIf",3===o.currentStep&&(null==o.flowConfig?null:o.flowConfig.rule)),e.R7$(1),e.Y8G("ngIf",null==o.flowConfig?null:o.flowConfig.rule),e.R7$(4),e.Y8G("ngIf",1===o.currentStep),e.R7$(3),e.Y8G("ngIf",2==o.currentStep),e.R7$(1),e.Y8G("ngIf",3==o.currentStep),e.R7$(1),e.Y8G("ngIf",4==o.currentStep))},dependencies:[d.Sq,d.bT,d.T3,l.me,l.BC,l.vS,v.aO,M.c,T.p,j.LH,xe.L_,y.ld,y.WI,z.Dn,x.Sy,x.tg,x.c9,H.s,se.RW,Ge,zi,fe],styles:['[_nghost-%COMP%]     .flow-config-container{height:100vh;display:flex;flex-direction:column;background-color:#f5f5f5}[_nghost-%COMP%]     .header{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background-color:#fff;border-bottom:1px solid #e8e8e8;box-shadow:0 2px 8px #0000000f;z-index:1000}[_nghost-%COMP%]     .header .header-left{width:265px;display:flex;align-items:center;gap:16px}[_nghost-%COMP%]     .header .header-left .back-btn{padding:4px 8px;border:none;background:transparent;color:#666;cursor:pointer}[_nghost-%COMP%]     .header .header-left .back-btn:hover{color:#1890ff}[_nghost-%COMP%]     .header .header-left .title-section .title{margin:0;font-size:18px;font-weight:600;color:#262626}[_nghost-%COMP%]     .header .header-left .title-section .draft-status{display:flex;align-items:center;gap:4px;margin-top:4px;font-size:12px;color:#8c8c8c;cursor:pointer}[_nghost-%COMP%]     .header .header-left .title-section .draft-status:hover{color:#1890ff}[_nghost-%COMP%]     .header .header-center .step-nav{display:flex;gap:32px}[_nghost-%COMP%]     .header .header-center .step-nav .step-item{display:flex;align-items:center;gap:8px;padding:8px 16px;border-radius:6px;cursor:pointer;transition:all .3s}[_nghost-%COMP%]     .header .header-center .step-nav .step-item:hover{background-color:#f0f8ff}[_nghost-%COMP%]     .header .header-center .step-nav .step-item.active{background-color:#e6f7ff;color:#1890ff}[_nghost-%COMP%]     .header .header-center .step-nav .step-item.active .step-number{background-color:#1890ff;color:#fff}[_nghost-%COMP%]     .header .header-center .step-nav .step-item .step-number{display:flex;align-items:center;justify-content:center;width:24px;height:24px;border-radius:50%;background-color:#d9d9d9;color:#666;font-size:12px;font-weight:600}[_nghost-%COMP%]     .header .header-center .step-nav .step-item .step-text{font-size:14px;font-weight:500}[_nghost-%COMP%]     .header .header-right{width:265px;display:flex;align-items:center;justify-content:flex-end}[_nghost-%COMP%]     .header .header-right .incomplete-items{display:flex;align-items:center;gap:4px;padding:4px 8px;font-size:12px;color:#ff4d4f;cursor:pointer}[_nghost-%COMP%]     .header .header-right .incomplete-items:hover{background-color:#fff2f0;border-radius:4px}[_nghost-%COMP%]     .header .header-right .preview-btn{border-color:#1890ff;color:#1890ff}[_nghost-%COMP%]     .header .header-right .publish-btn{background-color:#1890ff;border-color:#1890ff}[_nghost-%COMP%]     .main-content{flex:1;overflow-y:auto}[_nghost-%COMP%]     .main-content .step-placeholder{height:100%}[_nghost-%COMP%]     .main-content .step-placeholder[hidden]{display:none!important}[_nghost-%COMP%]     .main-content .phone-wrapper{width:340px;height:100%;background:linear-gradient(145deg,#f8f9fa,#e9ecef);border-radius:22px;border:8px solid #2c3e50;box-shadow:0 20px 40px #00000026,0 8px 16px #0000001a,inset 0 1px #fff3,inset 0 -1px #0000001a;position:relative;margin:0 auto;display:flex;flex-direction:column}[_nghost-%COMP%]     .main-content .phone-wrapper:before{content:"";position:absolute;top:0;left:50%;transform:translate(-50%);width:120px;height:24px;background:#2c3e50;border-radius:0 0 12px 12px;z-index:10;pointer-events:none}[_nghost-%COMP%]     .main-content .phone-wrapper:after{content:"";position:absolute;bottom:8px;left:50%;transform:translate(-50%);width:120px;height:4px;background:#2c3e50;border-radius:2px;z-index:10;pointer-events:none}[_nghost-%COMP%]     .main-content .phone-wrapper .phone-wrapper-screen{flex:1;background:#fff;width:100%;padding:12px;border-radius:12px;border:2px solid rgba(255,255,255,.1);box-shadow:inset 0 2px 4px #0000001a,0 4px 8px #0000001a;position:relative;overflow:auto}[_nghost-%COMP%]     .main-content .phone-wrapper .phone-wrapper-screen:before{content:"";position:absolute;top:0;left:0;right:0;height:30%;background:linear-gradient(135deg,rgba(255,255,255,.1) 0%,rgba(255,255,255,.05) 50%,transparent 100%);pointer-events:none;z-index:1}[_nghost-%COMP%]     .main-content .form-section{max-width:800px;padding:32px;background-color:#fff;margin:16px auto;box-shadow:0 2px 8px #0000000f}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item{margin-bottom:24px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .form-label{display:block;margin-bottom:8px;font-size:14px;font-weight:500;color:#262626}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .form-label.required:after{content:" *";color:#ff4d4f}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section{display:flex;align-items:center;gap:16px;position:relative}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section .icon-display{display:flex;align-items:center;gap:12px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section .icon-display .icon-circle{width:50px;height:50px;border-radius:6px;display:flex;align-items:center;justify-content:center;font-size:32px;color:#fff;box-shadow:0 4px 12px #00000026;transition:all .3s}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section .icon-display .icon-circle i{font-size:26px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section .icon-display .icon-info .icon-name{font-size:14px;font-weight:500;color:#262626;margin-bottom:4px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section .icon-display .icon-info .icon-color{font-size:12px;color:#8c8c8c}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section .modify-link{color:#1890ff;padding:0;height:auto;border:none;background:transparent}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section .modify-link:hover{color:#40a9ff}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .form-input, [_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .form-textarea, [_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .form-select{width:100%}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .permission-scopes{margin-top:12px;padding:8px;background-color:#fafafa;border:1px solid #e8e8e8}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .permission-scopes.empty{background-color:#fff7e6;border-color:#ffd591}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .permission-scopes.empty .empty-text{display:flex;align-items:center;gap:8px;color:#d46b08;font-size:13px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .permission-scopes.empty .empty-text span[nz-icon]{font-size:14px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .permission-scopes .scopes-header{margin-bottom:12px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .permission-scopes .scopes-header .scopes-title{font-size:13px;color:#595959;font-weight:500}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .checkbox-group{display:flex;flex-direction:column;gap:16px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .checkbox-group .checkbox-item{display:flex;align-items:center;gap:8px;font-size:14px;color:#262626}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .checkbox-group .checkbox-item .help-icon{color:#8c8c8c;cursor:pointer}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .checkbox-group .checkbox-item .help-icon:hover{color:#1890ff}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list{display:flex;flex-direction:column;gap:12px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .admin-item{display:flex;align-items:center;gap:12px;padding:12px;border:1px solid #e8e8e8;border-radius:6px;background-color:#fafafa}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .admin-item .admin-avatar{width:40px;height:40px;border-radius:50%;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:600;color:#fff}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .admin-item .admin-info{flex:1}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .admin-item .admin-info .admin-name{font-size:14px;font-weight:500;color:#262626;margin-bottom:4px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .admin-item .admin-info .admin-actions{display:flex;gap:16px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .admin-item .admin-info .admin-actions .action-link{padding:0;height:auto;border:none;background:transparent;color:#1890ff;font-size:12px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .admin-item .admin-info .admin-actions .action-link:hover{color:#40a9ff}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .admin-item .admin-info .admin-actions .action-link.delete-link{color:#ff4d4f}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .admin-item .admin-info .admin-actions .action-link.delete-link:hover{color:#ff7875}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .add-admin-btn{width:100%;height:48px;border:2px dashed #d9d9d9;border-radius:6px;background-color:transparent;color:#8c8c8c;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .add-admin-btn:hover{border-color:#1890ff;color:#1890ff}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .admin-section .admin-list .add-admin-btn i{font-size:16px}[_nghost-%COMP%]     .main-content .form-section .flow-form .action-buttons{display:flex;justify-content:flex-end;padding:12px;background:#fafafa;border-top:1px solid #e8e8e8}[_nghost-%COMP%]     .main-content .form-section .flow-form .action-buttons .buttons{display:flex;gap:12px}[_nghost-%COMP%]     .main-content .form-section .flow-form .action-buttons .buttons button{min-width:80px;height:36px;border-radius:6px;font-weight:500;transition:all .3s ease}[_nghost-%COMP%]     .main-content .form-section .flow-form .action-buttons .buttons button:hover{transform:translateY(-1px);box-shadow:0 4px 12px #00000026}@media (max-width: 768px){[_nghost-%COMP%]     .header{flex-direction:column;gap:16px;padding:12px 16px}[_nghost-%COMP%]     .header .header-center .step-nav{gap:16px}[_nghost-%COMP%]     .header .header-center .step-nav .step-item{padding:6px 12px}[_nghost-%COMP%]     .header .header-center .step-nav .step-item .step-text{display:none}[_nghost-%COMP%]     .header .header-right{width:100%;justify-content:space-between}[_nghost-%COMP%]     .main-content .form-section{padding:20px}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section .icon-selector{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);width:90vw;max-width:400px;max-height:80vh;overflow-y:auto}[_nghost-%COMP%]     .main-content .form-section .flow-form .form-item .icon-section .icon-selector .icon-section-selector .icon-grid{grid-template-columns:repeat(6,1fr)}}']})}}return t})();function nr(t,a){1&t&&e.nrm(0,"span",29)}function tr(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",30),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG();return e.Njj(s.selectCategory(r.id))}),e.j41(1,"div",31)(2,"span",18),e.EFF(3),e.k0s(),e.j41(4,"span",19),e.EFF(5),e.k0s()(),e.j41(6,"div",32)(7,"button",33),e.bIt("click",function(o){const s=e.eBV(n).$implicit;return e.XpG().onEditGroup(s),e.Njj(o.stopPropagation())}),e.nrm(8,"span",34),e.k0s(),e.j41(9,"button",35),e.bIt("click",function(o){const s=e.eBV(n).$implicit;return e.XpG().onDeleteGroup(s),e.Njj(o.stopPropagation())}),e.nrm(10,"span",36),e.k0s(),e.j41(11,"button",37),e.bIt("click",function(o){return o.stopPropagation()}),e.j41(12,"span"),e.EFF(13,"\u22ee\u22ee"),e.k0s()()()()}if(2&t){const n=a.$implicit,i=e.XpG();e.AVh("active",i.selectedCategory===n.id),e.R7$(3),e.JRh(n.name),e.R7$(2),e.SpI("(",n.count,")")}}function or(t,a){1&t&&(e.j41(0,"nz-tag",53),e.EFF(1," \u5df2\u505c\u7528 "),e.k0s())}function ir(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",38)(1,"div",39)(2,"div",40)(3,"div",41),e.nrm(4,"span"),e.k0s(),e.j41(5,"div",42)(6,"div",43),e.EFF(7),e.DNE(8,or,2,0,"nz-tag",44),e.k0s(),e.j41(9,"div",45),e.EFF(10),e.k0s()()(),e.j41(11,"div",46)(12,"button",37),e.bIt("click",function(o){return o.stopPropagation()}),e.j41(13,"span"),e.EFF(14,"\u22ee\u22ee"),e.k0s()(),e.j41(15,"button",47),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG();return e.Njj(s.onEdit(r))}),e.nrm(16,"span",34),e.k0s(),e.j41(17,"button",48),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG();return e.Njj(s.onDuplicate(r))}),e.nrm(18,"span",49),e.k0s(),e.j41(19,"button",50),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG();return e.Njj(s.onToggleVisibility(r))}),e.nrm(20,"span",51),e.k0s(),e.j41(21,"button",52),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG();return e.Njj(s.onDelete(r))}),e.nrm(22,"span",36),e.k0s()()()()}if(2&t){const n=a.$implicit;e.R7$(3),e.xc7("background-color",n.color||"#1890ff"),e.R7$(1),e.HbH(n.icon||"fa fa-dot-circle-o"),e.R7$(3),e.SpI(" ",n.name," "),e.R7$(1),e.Y8G("ngIf",!n.enable),e.R7$(2),e.JRh(n.remark||""),e.R7$(9),e.Y8G("nz-tooltip",n.enable?"\u505c\u7528":"\u542f\u7528"),e.R7$(1),e.xc7("color",n.enable?"":"#52c41a"),e.Y8G("nzType",n.enable?"stop":"check")}}function rr(t,a){1&t&&(e.j41(0,"div",54),e.nrm(1,"nz-empty",55),e.k0s()),2&t&&(e.R7$(1),e.Y8G("nzNotFoundImage","simple"))}function ar(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"div")(2,"input",56),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.createGroupName=o)})("keyup.enter",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.handleCreateGroup())}),e.k0s()(),e.bVm()}if(2&t){const n=e.XpG();e.R7$(2),e.Y8G("ngModel",n.createGroupName)}}function sr(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"div")(2,"input",56),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.editGroupName=o)})("keyup.enter",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.handleEditGroup())}),e.k0s()(),e.bVm()}if(2&t){const n=e.XpG();e.R7$(2),e.Y8G("ngModel",n.editGroupName)}}let lr=(()=>{class t{constructor(n,i,o,r,s){this.flowApiService=n,this.message=i,this.modal=o,this.flowDataService=r,this.drawerService=s,this.searchValue="",this.flowConfigs=[],this.categories=[],this.selectedCategory=null,this.categoryItems=[],this.loading=!1,this.configLoading=!1,this.isCreateModalVisible=!1,this.isEditModalVisible=!1,this.createGroupName="",this.editGroupName="",this.editingGroup=null}ngOnDestroy(){this.configDrawerRef&&this.configDrawerRef.close()}ngOnInit(){this.loadGroups(),this.loadFlowConfigs()}loadGroups(){this.loading=!0,this.flowApiService.groupList().subscribe(n=>{this.categoryItems=n.data.map((i,o)=>({id:i.id,name:i.name,sort:i.sort||o,count:this.getConfigsByCategory(i.id).length})),this.categoryItems.sort((i,o)=>i.sort-o.sort),this.categories=this.categoryItems.map(i=>i.name),this.loading=!1})}loadFlowConfigs(){this.configLoading=!0,this.flowApiService.configList().subscribe({next:n=>{n.success&&(this.flowConfigs=n.data,this.updateCategoryCounts()),this.configLoading=!1},error:n=>{this.configLoading=!1}})}updateCategoryCounts(){this.categoryItems.forEach(n=>{n.count=this.getConfigsByCategory(n.id).length})}getConfigsByCategory(n){return this.flowConfigs.filter(i=>i.flowGroup?.id===n)}selectCategory(n){this.selectedCategory=n}getCurrentConfigs(){let n=this.flowConfigs;if(this.selectedCategory&&(n=this.getConfigsByCategory(this.selectedCategory)),this.searchValue.trim()){const i=this.searchValue.toLowerCase().trim();n=n.filter(o=>o.name.toLowerCase().includes(i)||o.remark&&o.remark.toLowerCase().includes(i))}return n}onSearch(){console.log("\u641c\u7d22:",this.searchValue)}onCreateGroup(){this.createGroupName="",this.isCreateModalVisible=!0}handleCreateGroup(){this.createGroupName&&this.createGroupName.trim()?this.addGroup(this.createGroupName.trim()):this.message.warning("\u8bf7\u8f93\u5165\u5206\u7ec4\u540d\u79f0")}handleCreateCancel(){this.isCreateModalVisible=!1,this.createGroupName=""}addGroup(n){this.flowApiService.groupAdd(n).subscribe({next:i=>{i.success?(this.message.success("\u5206\u7ec4\u521b\u5efa\u6210\u529f"),this.isCreateModalVisible=!1,this.createGroupName="",this.loadGroups()):this.message.error(i.message||"\u521b\u5efa\u5206\u7ec4\u5931\u8d25")},error:i=>{console.error("\u521b\u5efa\u5206\u7ec4\u5931\u8d25:",i),this.message.error("\u521b\u5efa\u5206\u7ec4\u5931\u8d25")}})}onEditGroup(n){this.editingGroup=n,this.editGroupName=n.name,this.isEditModalVisible=!0}handleEditGroup(){this.editGroupName&&this.editGroupName.trim()&&this.editingGroup?.id?this.editGroup(this.editingGroup.id,this.editGroupName.trim()):this.message.warning("\u8bf7\u8f93\u5165\u5206\u7ec4\u540d\u79f0")}handleEditCancel(){this.isEditModalVisible=!1,this.editGroupName="",this.editingGroup=null}editGroup(n,i){this.flowApiService.groupEdit(n,i).subscribe({next:o=>{o.success?(this.message.success("\u5206\u7ec4\u7f16\u8f91\u6210\u529f"),this.isEditModalVisible=!1,this.editGroupName="",this.editingGroup=null,this.loadGroups()):this.message.error(o.message||"\u7f16\u8f91\u5206\u7ec4\u5931\u8d25")},error:o=>{console.error("\u7f16\u8f91\u5206\u7ec4\u5931\u8d25:",o),this.message.error("\u7f16\u8f91\u5206\u7ec4\u5931\u8d25")}})}onDeleteGroup(n){n.id&&this.modal.confirm({nzTitle:"\u786e\u8ba4\u5220\u9664",nzContent:`\u786e\u5b9a\u8981\u5220\u9664\u5206\u7ec4"${n.name}"\u5417\uff1f`,nzOkText:"\u786e\u5b9a",nzCancelText:"\u53d6\u6d88",nzOnOk:()=>{this.flowApiService.groupDelete(n.id).subscribe({next:i=>{this.message.success("\u5206\u7ec4\u5220\u9664\u6210\u529f"),this.loadGroups()}})}})}onDrop(n){(0,D.HD)(this.categoryItems,n.previousIndex,n.currentIndex),this.categoryItems.forEach((i,o)=>{i.sort=o}),this.categories=this.categoryItems.map(i=>i.name),this.sortGroups()}sortGroups(){const n=this.categoryItems.map(i=>i.id).filter(i=>void 0!==i);0!==n.length&&this.flowApiService.groupSort(n).subscribe({next:i=>{i.success?console.log("\u5206\u7ec4\u6392\u5e8f\u6210\u529f"):this.message.error(i.message||"\u5206\u7ec4\u6392\u5e8f\u5931\u8d25")},error:i=>{console.error("\u5206\u7ec4\u6392\u5e8f\u5931\u8d25:",i),this.message.error("\u5206\u7ec4\u6392\u5e8f\u5931\u8d25")}})}onFlowDrop(n){if(null===this.selectedCategory)return void this.message.warning("\u8bf7\u5148\u9009\u62e9\u5206\u7ec4\u540e\u518d\u8fdb\u884c\u6392\u5e8f");const i=this.getConfigsByCategory(this.selectedCategory),o=this.getCurrentConfigs();if(i.length!==o.length)return void this.message.warning("\u641c\u7d22\u72b6\u6001\u4e0b\u65e0\u6cd5\u6392\u5e8f\uff0c\u8bf7\u5148\u6e05\u9664\u641c\u7d22\u6761\u4ef6");const r=[];this.flowConfigs.forEach((U,Re)=>{U.flowGroup?.id===this.selectedCategory&&r.push(Re)}),r.length===i.length?((0,D.HD)(this.flowConfigs,r[n.previousIndex],r[n.currentIndex]),this.sortFlows()):this.loadFlowConfigs()}sortFlows(){if(!this.selectedCategory)return;const i=this.getConfigsByCategory(this.selectedCategory).map(o=>o.id).filter(o=>void 0!==o);0!==i.length&&this.flowApiService.flowSort(i,this.selectedCategory).subscribe({next:o=>{o.success||(this.loadFlowConfigs(),this.message.error(o.message||"Sort Error"))},error:o=>{this.loadFlowConfigs(),this.message.error("Sort Error")}})}onCreateApproval(n){this.configDrawerRef=this.drawerService.create({nzTitle:null,nzWidth:"100%",nzClosable:!1,nzMaskClosable:!1,nzContent:er,nzContentParams:{flowId:n},nzBodyStyle:{padding:"0px"}});const i=()=>{const o=this.configDrawerRef.getContentComponent();o?o.closeConfig.subscribe(()=>{this.configDrawerRef.close(),this.loadFlowConfigs()}):setTimeout(i,50)};i()}onEdit(n){this.onCreateApproval(n.id)}onDuplicate(n){n.id?this.modal.confirm({nzTitle:"\u786e\u8ba4\u590d\u5236",nzContent:`\u786e\u5b9a\u8981\u590d\u5236\u6d41\u7a0b\u914d\u7f6e"${n.name}"\u5417\uff1f`,nzOkText:"\u786e\u5b9a",nzCancelText:"\u53d6\u6d88",nzOnOk:()=>{this.flowApiService.configCopy(n.id).subscribe({next:i=>{i.success?(this.message.success("\u6d41\u7a0b\u914d\u7f6e\u590d\u5236\u6210\u529f"),this.loadFlowConfigs()):this.message.error(i.message||"\u590d\u5236\u6d41\u7a0b\u914d\u7f6e\u5931\u8d25")},error:i=>{console.error("\u590d\u5236\u6d41\u7a0b\u914d\u7f6e\u5931\u8d25:",i),this.message.error("\u590d\u5236\u6d41\u7a0b\u914d\u7f6e\u5931\u8d25")}})}}):this.message.warning("\u914d\u7f6eID\u4e0d\u5b58\u5728")}onToggleVisibility(n){if(!n.id)return void this.message.warning("\u914d\u7f6eID\u4e0d\u5b58\u5728");const i=n.enable,o=!n.enable;this.flowApiService.configSwitchEnable(n.id).subscribe({next:r=>{r.success?(n.enable=o,this.message.success(`${n.name}${o?"\u542f\u7528":"\u505c\u7528"}\u6210\u529f`)):(n.enable=i,this.message.error(r.message||(o?"\u542f\u7528":"\u505c\u7528")+"\u6d41\u7a0b\u914d\u7f6e\u5931\u8d25"))},error:r=>{n.enable=i,console.error("\u5207\u6362\u6d41\u7a0b\u914d\u7f6e\u72b6\u6001\u5931\u8d25:",r),this.message.error("\u5207\u6362\u6d41\u7a0b\u914d\u7f6e\u72b6\u6001\u5931\u8d25")}})}onDelete(n){n.id?this.modal.confirm({nzTitle:"\u786e\u8ba4\u5220\u9664",nzContent:`\u786e\u5b9a\u8981\u5220\u9664\u6d41\u7a0b\u914d\u7f6e"${n.name}"\u5417\uff1f\u6b64\u64cd\u4f5c\u4e0d\u53ef\u6062\u590d\u3002`,nzOkText:"\u786e\u5b9a",nzCancelText:"\u53d6\u6d88",nzOkDanger:!0,nzOnOk:()=>{this.flowApiService.configDelete(n.id).subscribe({next:i=>{i.success?(this.message.success("\u6d41\u7a0b\u914d\u7f6e\u5220\u9664\u6210\u529f"),this.loadFlowConfigs()):this.message.error(i.message||"\u5220\u9664\u6d41\u7a0b\u914d\u7f6e\u5931\u8d25")},error:i=>{console.error("\u5220\u9664\u6d41\u7a0b\u914d\u7f6e\u5931\u8d25:",i),this.message.error("\u5220\u9664\u6d41\u7a0b\u914d\u7f6e\u5931\u8d25")}})}}):this.message.warning("\u914d\u7f6eID\u4e0d\u5b58\u5728")}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(S),e.rXU(R.xh),e.rXU(g.N_),e.rXU(me),e.rXU(k.Nf))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["erupt-flow-management"]],decls:37,vars:12,consts:[[1,"flow-management-container"],[1,"header-section"],[1,"search-area"],[3,"nzSuffix"],["nz-input","","placeholder","\u641c\u7d22",3,"ngModel","ngModelChange"],["searchIcon",""],[1,"action-buttons"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","plus"],[1,"content-layout"],[1,"category-sidebar"],[1,"sidebar-header"],[1,"header-title"],[1,"header-actions"],["nz-button","","nzType","text","nzSize","small","nz-tooltip","\u65b0\u5efa\u5206\u7ec4",3,"click"],["cdkDropList","",1,"category-list",3,"cdkDropListDropped"],[3,"nzSpinning"],[1,"category-item",3,"click"],[1,"category-name"],[1,"category-count"],["class","category-item draggable-item","cdkDrag","",3,"active","click",4,"ngFor","ngForOf"],[1,"app-content"],["cdkDropList","",1,"app-list",3,"cdkDropListDropped"],["nzSize","large",2,"height","100%",3,"nzSpinning"],["cdkDrag","",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],["nzTitle","\u65b0\u5efa\u5206\u7ec4",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],[4,"nzModalContent"],["nzTitle","\u7f16\u8f91\u5206\u7ec4",3,"nzVisible","nzVisibleChange","nzOnCancel","nzOnOk"],["nz-icon","","nzType","search"],["cdkDrag","",1,"category-item","draggable-item",3,"click"],[1,"category-content"],[1,"category-actions"],["nz-button","","nzType","text","nzSize","small","nz-tooltip","\u7f16\u8f91\u5206\u7ec4",3,"click"],["nz-icon","","nzType","edit"],["nz-button","","nzType","text","nzSize","small","nz-tooltip","\u5220\u9664\u5206\u7ec4",3,"click"],["nz-icon","","nzType","delete"],["nz-button","","nzType","text","nzSize","small","cdkDragHandle","",3,"click"],["cdkDrag",""],[1,"app-item"],[1,"app-info"],[1,"app-icon"],[1,"app-details"],[1,"app-name"],["nzColor","red",4,"ngIf"],[1,"app-description"],[1,"action-icons"],["nz-button","","nzType","text","nzSize","small","nz-tooltip","\u7f16\u8f91",3,"click"],["nz-button","","nzType","text","nzSize","small","nz-tooltip","\u590d\u5236",3,"click"],["nz-icon","","nzType","copy"],["nz-button","","nzType","text","nzSize","small",3,"nz-tooltip","click"],["nz-icon","",3,"nzType"],["nz-button","","nzType","text","nzSize","small","nz-tooltip","\u5220\u9664",3,"click"],["nzColor","red"],[1,"empty-state"],[2,"margin-top","20%",3,"nzNotFoundImage"],["nz-input","","placeholder","\u8bf7\u8f93\u5165\u5206\u7ec4\u540d\u79f0",2,"width","100%",3,"ngModel","ngModelChange","keyup.enter"]],template:function(i,o){if(1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"nz-input-group",3)(4,"input",4),e.bIt("ngModelChange",function(s){return o.searchValue=s})("ngModelChange",function(){return o.onSearch()}),e.k0s()(),e.DNE(5,nr,1,0,"ng-template",null,5,e.C5r),e.k0s(),e.j41(7,"div",6)(8,"button",7),e.bIt("click",function(){return o.onCreateApproval()}),e.nrm(9,"span",8),e.EFF(10," \u521b\u5efa\u6d41\u7a0b "),e.k0s()()(),e.j41(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12)(15,"h3"),e.EFF(16,"\u6d41\u7a0b\u5206\u7c7b"),e.k0s()(),e.j41(17,"div",13)(18,"button",14),e.bIt("click",function(){return o.onCreateGroup()}),e.nrm(19,"span",8),e.k0s()()(),e.j41(20,"div",15),e.bIt("cdkDropListDropped",function(s){return o.onDrop(s)}),e.j41(21,"nz-spin",16)(22,"div",17),e.bIt("click",function(){return o.selectCategory(null)}),e.j41(23,"span",18),e.EFF(24,"\u5168\u90e8"),e.k0s(),e.j41(25,"span",19),e.EFF(26),e.k0s()(),e.DNE(27,tr,14,4,"div",20),e.k0s()()(),e.j41(28,"div",21)(29,"div",22),e.bIt("cdkDropListDropped",function(s){return o.onFlowDrop(s)}),e.j41(30,"nz-spin",23),e.DNE(31,ir,23,11,"div",24),e.DNE(32,rr,2,1,"div",25),e.k0s()()()()(),e.j41(33,"nz-modal",26),e.bIt("nzVisibleChange",function(s){return o.isCreateModalVisible=s})("nzOnCancel",function(){return o.handleCreateCancel()})("nzOnOk",function(){return o.handleCreateGroup()}),e.DNE(34,ar,3,1,"ng-container",27),e.k0s(),e.j41(35,"nz-modal",28),e.bIt("nzVisibleChange",function(s){return o.isEditModalVisible=s})("nzOnCancel",function(){return o.handleEditCancel()})("nzOnOk",function(){return o.handleEditGroup()}),e.DNE(36,sr,3,1,"ng-container",27),e.k0s()),2&i){const r=e.sdS(6);e.R7$(3),e.Y8G("nzSuffix",r),e.R7$(1),e.Y8G("ngModel",o.searchValue),e.R7$(17),e.Y8G("nzSpinning",!1),e.R7$(1),e.AVh("active",null===o.selectedCategory),e.R7$(4),e.SpI("(",o.flowConfigs.length,")"),e.R7$(1),e.Y8G("ngForOf",o.categoryItems),e.R7$(3),e.Y8G("nzSpinning",o.configLoading),e.R7$(1),e.Y8G("ngForOf",o.getCurrentConfigs()),e.R7$(1),e.Y8G("ngIf",!o.configLoading&&0===o.getCurrentConfigs().length),e.R7$(1),e.Y8G("nzVisible",o.isCreateModalVisible),e.R7$(2),e.Y8G("nzVisible",o.isEditModalVisible)}},dependencies:[d.Sq,d.bT,l.me,l.BC,l.vS,v.aO,M.c,T.p,j.LH,z.Dn,g.F2,g.A9,x.Sy,x.tg,x.vN,H.s,ae.a,D.O7,D.T1,D.Fb,se.RW],styles:["[_nghost-%COMP%]     .flow-management-container{padding:16px;margin:0 auto;background:#f0f2f5;height:calc(100vh - 44px);display:flex;flex-direction:column}[_nghost-%COMP%]     .flow-management-container .header-section{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding:16px 20px;background:#fff;border:1px solid #f0f0f0;box-shadow:0 1px 2px #00000008;flex-shrink:0}[_nghost-%COMP%]     .flow-management-container .header-section .search-area{flex:1;max-width:320px}[_nghost-%COMP%]     .flow-management-container .header-section .action-buttons{display:flex;gap:8px;align-items:center}[_nghost-%COMP%]     .flow-management-container .header-section .action-buttons button{border-radius:4px;height:32px;padding:0 16px;font-weight:400;transition:all .2s ease}[_nghost-%COMP%]     .flow-management-container .header-section .action-buttons button[nzType=primary]{background:#1890ff;border-color:#1890ff;color:#fff}[_nghost-%COMP%]     .flow-management-container .header-section .action-buttons button[nzType=primary]:hover{background:#40a9ff;border-color:#40a9ff}[_nghost-%COMP%]     .flow-management-container .header-section .action-buttons button[nzType=primary] span{margin-right:4px}[_nghost-%COMP%]     .content-layout{display:flex;flex:1;gap:16px;min-height:0}[_nghost-%COMP%]     .content-layout .category-sidebar{width:260px;background:#fff;padding:16px;flex-shrink:0;border:1px solid #f0f0f0;box-shadow:0 1px 2px #00000008}[_nghost-%COMP%]     .content-layout .category-sidebar .sidebar-header{margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #f0f0f0;display:flex;justify-content:space-between;align-items:center}[_nghost-%COMP%]     .content-layout .category-sidebar .sidebar-header .header-title h3{margin:0;font-size:16px;font-weight:500;color:#262626}[_nghost-%COMP%]     .content-layout .category-sidebar .sidebar-header .header-actions{display:flex;gap:4px}[_nghost-%COMP%]     .content-layout .category-sidebar .sidebar-header .header-actions button{width:28px;height:28px;padding:0;display:flex;align-items:center;justify-content:center;border-radius:4px;border:1px solid #d9d9d9;background:#fff;color:#595959;transition:all .2s ease}[_nghost-%COMP%]     .content-layout .category-sidebar .sidebar-header .header-actions button:hover{background:#f5f5f5;border-color:#1890ff;color:#1890ff}[_nghost-%COMP%]     .content-layout .category-sidebar .sidebar-header .header-actions button span{font-size:14px}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list{flex:1;overflow:auto;position:relative;display:flex;flex-direction:column}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;margin-bottom:6px;border-radius:4px;cursor:pointer;transition:all .2s ease;border:1px solid transparent;min-height:44px;max-height:44px;box-sizing:border-box;white-space:nowrap;overflow:visible;position:relative}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item:hover{background:#f5f5f5;z-index:5}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item.active{background:#e6f7ff;border-color:#91d5ff;z-index:5}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item.active .category-content .category-name{color:#1890ff;font-weight:500}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item.active .category-content .category-count{background:#1890ff;color:#fff}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item.draggable-item{cursor:grab;background:#fff;border:1px solid #f0f0f0}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item.draggable-item:hover{background:#fafafa;border-color:#d9d9d9}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item.draggable-item:active{cursor:grabbing}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .category-content{display:flex;justify-content:space-between;align-items:center;flex:1;min-width:0;overflow:hidden}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .category-content .category-name{font-size:14px;color:#595959;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1;min-width:0}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .category-content .category-count{font-size:12px;color:#8c8c8c;background:#f5f5f5;padding:2px 8px;border-radius:10px;font-weight:400;flex-shrink:0;margin-left:8px;z-index:1;position:relative}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .category-actions{display:flex;align-items:center;gap:4px;opacity:0;transition:opacity .2s ease;margin-left:8px;flex-shrink:0;white-space:nowrap;overflow:hidden;position:absolute;right:12px;top:50%;transform:translateY(-50%);background:#fff;padding:2px;border-radius:4px;box-shadow:0 2px 8px #0000001a;z-index:10;pointer-events:auto}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .category-actions button{border:none;background:transparent;color:#bfbfbf;padding:4px;border-radius:4px;transition:all .2s ease;min-width:24px;min-height:24px;max-width:24px;max-height:24px;display:flex;align-items:center;justify-content:center;flex-shrink:0;white-space:nowrap;overflow:hidden;pointer-events:auto}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .category-actions button:hover{background:#f0f0f0;color:#1890ff}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item:hover .category-actions{opacity:1}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .drag-handle-btn{margin-left:8px;border:none;background:transparent;color:#bfbfbf;cursor:grab;padding:0 4px;border-radius:4px;transition:background .2s,color .2s;min-width:28px;min-height:28px;display:flex;align-items:center;justify-content:center}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .drag-handle-btn:hover, [_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .drag-handle-btn:focus{background:#f0f0f0;color:#1890ff}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .drag-handle-btn:active{cursor:grabbing}[_nghost-%COMP%]     .content-layout .category-sidebar .category-list .category-item .drag-handle-btn .drag-icon{font-size:14px;line-height:1;letter-spacing:-1px}[_nghost-%COMP%]     .content-layout .app-content{flex:1;background:#fff;border-radius:6px;border:1px solid #f0f0f0;box-shadow:0 1px 2px #00000008;display:flex;flex-direction:column;min-height:0}[_nghost-%COMP%]     .content-layout .app-content .content-header{padding:16px 20px;border-bottom:1px solid #f0f0f0;display:flex;justify-content:space-between;align-items:center;flex-shrink:0;background:#fafafa}[_nghost-%COMP%]     .content-layout .app-content .content-header h3{margin:0;font-size:16px;font-weight:500;color:#262626}[_nghost-%COMP%]     .content-layout .app-content .content-header .app-count{font-size:14px;color:#8c8c8c;background:#f5f5f5;padding:4px 12px;border-radius:12px;font-weight:400}[_nghost-%COMP%]     .content-layout .app-content .app-list{flex:1;overflow-y:auto}[_nghost-%COMP%]     .content-layout .app-content .app-list.cdk-drop-list-dragging .app-item:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]     .content-layout .app-content .app-list .cdk-drag-placeholder{opacity:.4}[_nghost-%COMP%]     .content-layout .app-content .app-list .cdk-drag-preview{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f;background:#fff}[_nghost-%COMP%]     .content-layout .app-content .app-list .empty-state{display:flex;justify-content:center;align-items:center;height:200px;color:#8c8c8c}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item{display:flex;align-items:center;padding:16px;transition:all .2s ease;background:#fff}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item:hover{border-color:#d9d9d9;background:#fafafa}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item.draggable-flow-item{cursor:grab;border:1px solid transparent}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item.draggable-flow-item:hover{background:#fafafa;border-color:#d9d9d9}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item.draggable-flow-item:active{cursor:grabbing}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item.draggable-flow-item.cdk-drag-animating{transition:transform .25s cubic-bezier(0,0,.2,1)}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .app-info{display:flex;align-items:center;flex:1;min-width:0}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .app-info .app-icon{width:40px;height:40px;border-radius:6px;display:flex;align-items:center;justify-content:center;margin-right:12px;flex-shrink:0}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .app-info .app-icon span{color:#fff;font-size:16px}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .app-info .app-details{flex:1;min-width:0}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .app-info .app-details .app-name{font-size:14px;font-weight:500;color:#262626;margin-bottom:4px;display:flex;align-items:center;gap:8px}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .app-info .app-details .app-description{font-size:12px;color:#8c8c8c;line-height:1.4;margin:0}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .visibility-status{width:100px;text-align:center;margin:0 16px}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .visibility-status .visibility-text{font-size:12px;color:#52c41a;font-weight:400}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .action-icons{display:flex;align-items:center;gap:4px;flex-shrink:0}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .action-icons button{width:28px;height:28px;padding:0;display:flex;align-items:center;justify-content:center;border-radius:4px;border:1px solid transparent;background:transparent;color:#8c8c8c;transition:all .2s ease}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .action-icons button:hover{background:#f5f5f5;color:#262626}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .action-icons button span{font-size:14px}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .action-icons button[cdkDragHandle]{cursor:grab;color:#bfbfbf}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .action-icons button[cdkDragHandle]:hover{background:#f0f0f0;color:#1890ff}[_nghost-%COMP%]     .content-layout .app-content .app-list .app-item .action-icons button[cdkDragHandle]:active{cursor:grabbing}@media (max-width: 768px){[_nghost-%COMP%]     .flow-management-container{padding:12px;height:auto}[_nghost-%COMP%]     .flow-management-container .header-section{flex-direction:column;gap:12px;align-items:stretch;padding:12px}[_nghost-%COMP%]     .flow-management-container .header-section .search-area{max-width:none}[_nghost-%COMP%]     .flow-management-container .header-section .action-buttons{justify-content:flex-end}[_nghost-%COMP%]     .flow-management-container .content-layout{flex-direction:column;gap:12px}[_nghost-%COMP%]     .flow-management-container .content-layout .category-sidebar{width:100%;order:2;padding:12px}[_nghost-%COMP%]     .flow-management-container .content-layout .category-sidebar .category-list{display:flex;flex-wrap:wrap;gap:6px}[_nghost-%COMP%]     .flow-management-container .content-layout .category-sidebar .category-list .category-item{flex:1;min-width:100px;margin-bottom:0}[_nghost-%COMP%]     .flow-management-container .content-layout .app-content{order:1}[_nghost-%COMP%]     .flow-management-container .content-layout .app-content .content-header{padding:12px}[_nghost-%COMP%]     .flow-management-container .content-layout .app-content .app-list{padding:12px}[_nghost-%COMP%]     .flow-management-container .content-layout .app-content .app-list .app-item{flex-direction:column;align-items:flex-start;gap:12px}[_nghost-%COMP%]     .flow-management-container .content-layout .app-content .app-list .app-item .visibility-status{width:auto;text-align:left;margin:0}[_nghost-%COMP%]     .flow-management-container .content-layout .app-content .app-list .app-item .action-icons{align-self:flex-end}}"]})}}return t})();var ln=c(6977),cr=c(1413);let he=(()=>{class t{constructor(n){this._http=n}progress(n){return this._http.get(p.eY.erupt+"/flow/instance/progress",{instanceId:n})}userFlows(){return this._http.get(p.eY.erupt+"/flow/instance/user-flows",null)}create(n,i){return this._http.post(p.eY.erupt+"/flow/instance/create",i,{flowId:n})}list(n){return this._http.post(p.eY.erupt+"/flow/instance/list",n)}detail(n){return this._http.get(p.eY.erupt+"/flow/instance/detail",{no:n})}eruptData(n){return this._http.get(p.eY.erupt+"/flow/instance/erupt-data",{instanceId:n})}tasks(n){return this._http.get(p.eY.erupt+"/flow/instance/tasks",{instanceId:n})}currTask(n,i){return this._http.get(p.eY.erupt+"/flow/instance/curr-task",{instanceId:n,approvalView:i})}taskNodeInfo(n){return this._http.get(p.eY.erupt+"/flow/instance/task-node-info",{taskId:n})}commentList(n){return this._http.get(p.eY.erupt+"/flow/instance/comment/list",{instanceId:n})}updateData(n,i){return this._http.post(p.eY.erupt+"/flow/instance/update-data",i,{instanceId:n})}dataHistories(n){return this._http.get(p.eY.erupt+"/flow/instance/data-histories",{instanceId:n})}commentCreate(n,i){return this._http.post(p.eY.erupt+"/flow/instance/comment/create",null,{instanceId:n,comment:i})}withdraw(n,i){return this._http.post(p.eY.erupt+"/flow/instance/withdraw",null,{instanceId:n,comment:i})}urge(n,i){return this._http.post(p.eY.erupt+"/flow/instance/urge",null,{instanceId:n,comment:i})}resubmit(n,i,o){return this._http.post(p.eY.erupt+"/flow/instance/approval/resubmit",{comment:i,data:o},{instanceTaskId:n})}agree(n,i,o,r){return this._http.post(p.eY.erupt+"/flow/instance/approval/agree",{comment:i,signature:o,data:r},{instanceTaskId:n})}refuse(n,i){return this._http.post(p.eY.erupt+"/flow/instance/approval/refuse",null,{instanceTaskId:n,comment:i})}cc(n,i,o){return this._http.post(p.eY.erupt+"/flow/instance/approval/cc",null,{instanceTaskId:n,comment:o,userIds:i})}transfer(n,i,o){return this._http.post(p.eY.erupt+"/flow/instance/approval/transfer",null,{instanceTaskId:n,comment:o,userId:i})}addSign(n,i,o,r){return this._http.post(p.eY.erupt+"/flow/instance/approval/add-sign",null,{instanceTaskId:n,comment:r,addSignType:i,userIds:o})}rollback(n,i,o){return this._http.post(p.eY.erupt+"/flow/instance/approval/rollback",null,{instanceTaskId:n,rtnNode:i,comment:o})}availableReturnNodes(n){return this._http.get(p.eY.erupt+"/flow/instance/approval/available-return-nodes",{flowInstanceTaskId:n})}static{this.\u0275fac=function(i){return new(i||t)(e.KVO(pe.p4))}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function pr(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"div",2),e.nrm(2,"erupt-flow-form",3),e.k0s(),e.j41(3,"div",4)(4,"button",5),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.onCancel())}),e.EFF(5,"\u53d6\u6d88"),e.k0s(),e.j41(6,"button",6),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.onViewFlow())}),e.EFF(7,"\u67e5\u770b\u6d41\u7a0b"),e.k0s(),e.j41(8,"button",7),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.onSubmit())}),e.EFF(9,"\u53d1\u8d77\u5ba1\u6279"),e.k0s()(),e.bVm()}if(2&t){const n=e.XpG();e.R7$(2),e.Y8G("eruptBuild",n.eruptBuild)("formAccesses",null==n.startNode?null:n.startNode.formAccesses)}}let dr=(()=>{class t{constructor(n,i,o,r,s,u){this.msg=n,this.modal=i,this.dataHandlerService=o,this.drawerService=r,this.flowApiService=s,this.flowInstanceApiService=u,this.close=new e.bkB,this.loading=!1}ngOnInit(){this.loading=!0,this.erupt&&(Promise.all([this.flowApiService.eruptFlowBuild(this.erupt)]).then(([n])=>{n.subscribe(i=>{this.dataHandlerService.initErupt(i.data),i.data.eruptModel.eruptJson.layout.formSize=p.c8.FULL_LINE,this.eruptBuild=i.data}),this.loading=!1}),this.startNode=this.flow.rule[0].prop)}onViewFlow(){this.drawerService.create({nzTitle:"\u67e5\u770b\u6d41\u7a0b",nzContent:Ge,nzContentParams:{eruptBuild:this.eruptBuild,modelValue:this.flow.rule,readonly:!0},nzBodyStyle:{padding:"0",background:"rgb(245 245 245)"},nzPlacement:"bottom",nzHeight:"85%",nzFooter:null})}onSubmit(){let n=this.dataHandlerService.eruptValueToObject(this.eruptBuild);this.flowInstanceApiService.create(this.flow.id,n).subscribe(i=>{i.success&&(this.msg.success("\u53d1\u8d77\u6210\u529f"),this.close.emit(),this.onClose&&this.onClose())})}onCancel(){this.close.emit(),this.onClose&&this.onClose()}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(R.xh),e.rXU(g.N_),e.rXU(ne.u),e.rXU(k.Nf),e.rXU(S),e.rXU(he))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-create-instance"]],inputs:{flow:"flow",erupt:"erupt",onClose:"onClose"},outputs:{close:"close"},decls:2,vars:2,consts:[[2,"width","100%","min-height","300px",3,"nzSpinning"],[4,"ngIf"],[2,"padding","16px","height","calc(100vh - 108px)","overflow","auto"],[3,"eruptBuild","formAccesses"],[2,"text-align","right","position","sticky","bottom","0","padding","10px 16px","border-top","1px solid rgba(0,0,0,.06)","z-index","999"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","default",2,"margin-left","8px",3,"click"],["nz-button","","nzType","primary",2,"margin-left","8px",3,"click"]],template:function(i,o){1&i&&(e.j41(0,"nz-spin",0),e.DNE(1,pr,10,2,"ng-container",1),e.k0s()),2&i&&(e.Y8G("nzSpinning",o.loading),e.R7$(1),e.Y8G("ngIf",o.eruptBuild))},dependencies:[d.bT,v.aO,M.c,T.p,ae.a,fe]})}}return t})();function _r(t,a){if(1&t&&(e.j41(0,"span",15),e.EFF(1),e.k0s()),2&t){const n=e.XpG().$implicit,i=e.XpG();e.R7$(1),e.SpI(" (",i.getCategoryFlowCount(n.key),") ")}}function ur(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",12),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG();return e.Njj(s.onCategorySelect(r.key))}),e.j41(1,"span",13),e.EFF(2),e.k0s(),e.DNE(3,_r,2,1,"span",14),e.k0s()}if(2&t){const n=a.$implicit,i=e.XpG();e.AVh("active",i.selectedCategory===n.key),e.R7$(2),e.JRh(n.name),e.R7$(1),e.Y8G("ngIf",n.key)}}function gr(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",16)(1,"nz-input-group",17)(2,"input",18),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.searchKeyword=o)})("ngModelChange",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.onSearchChange())}),e.k0s()()()}if(2&t){const n=e.XpG();e.R7$(2),e.Y8G("ngModel",n.searchKeyword)}}function mr(t,a){1&t&&(e.j41(0,"div",19)(1,"nz-spin",20)(2,"div",21),e.EFF(3,"\u52a0\u8f7d\u4e2d..."),e.k0s()()())}function fr(t,a){1&t&&(e.j41(0,"p"),e.EFF(1,"\u6682\u65e0\u6d41\u7a0b\u6570\u636e"),e.k0s())}function hr(t,a){1&t&&(e.j41(0,"p"),e.EFF(1,"\u672a\u627e\u5230\u5339\u914d\u7684\u6d41\u7a0b"),e.k0s())}function Cr(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",30),e.bIt("click",function(){e.eBV(n);const o=e.XpG(3);return e.Njj(o.refreshData())}),e.EFF(1," \u5237\u65b0\u6570\u636e "),e.k0s()}}function br(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",31),e.bIt("click",function(){e.eBV(n);const o=e.XpG(3);return o.searchKeyword="",e.Njj(o.onSearchChange())}),e.EFF(1," \u6e05\u9664\u641c\u7d22 "),e.k0s()}}function vr(t,a){if(1&t&&(e.j41(0,"div",25),e.nrm(1,"i",26),e.DNE(2,fr,2,0,"p",27),e.DNE(3,hr,2,0,"p",27),e.DNE(4,Cr,2,0,"button",28),e.DNE(5,br,2,0,"button",29),e.k0s()),2&t){const n=e.XpG(2);e.R7$(2),e.Y8G("ngIf",!n.searchKeyword),e.R7$(1),e.Y8G("ngIf",n.searchKeyword),e.R7$(1),e.Y8G("ngIf",!n.searchKeyword),e.R7$(1),e.Y8G("ngIf",n.searchKeyword)}}function xr(t,a){if(1&t&&(e.j41(0,"div",44),e.EFF(1),e.k0s()),2&t){const n=e.XpG(2).$implicit;e.R7$(1),e.JRh(n.remark)}}const wr=function(t){return{"flow-disabled":t}},Mr=function(t){return{background:t}};function zr(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",38),e.bIt("click",function(){e.eBV(n);const o=e.XpG().$implicit,r=e.XpG(3);return e.Njj(r.launchFlow(o))}),e.j41(1,"div",39),e.nrm(2,"span",40),e.k0s(),e.j41(3,"div",41)(4,"div",42),e.EFF(5),e.k0s(),e.DNE(6,xr,2,1,"div",43),e.k0s()()}if(2&t){const n=e.XpG().$implicit;e.Y8G("ngClass",e.eq3(6,wr,!n.enable)),e.R7$(1),e.Aen(e.eq3(8,Mr,n.color)),e.R7$(1),e.Y8G("classList",n.icon),e.R7$(3),e.JRh(n.name),e.R7$(1),e.Y8G("ngIf",n.remark)}}function yr(t,a){if(1&t&&(e.qex(0),e.DNE(1,zr,7,10,"div",37),e.bVm()),2&t){const n=a.$implicit;e.R7$(1),e.Y8G("ngIf",n.enable)}}function Or(t,a){if(1&t&&(e.j41(0,"div",32)(1,"h3",33),e.EFF(2),e.j41(3,"span",34),e.EFF(4),e.k0s()(),e.j41(5,"div",35),e.DNE(6,yr,2,1,"ng-container",36),e.k0s()()),2&t){const n=a.$implicit;e.R7$(2),e.SpI(" ",n.title," "),e.R7$(2),e.SpI("(",n.flows.length,")"),e.R7$(2),e.Y8G("ngForOf",n.flows)}}function Fr(t,a){if(1&t&&(e.j41(0,"div",22),e.DNE(1,vr,6,4,"div",23),e.DNE(2,Or,7,3,"div",24),e.k0s()),2&t){const n=e.XpG();e.R7$(1),e.Y8G("ngIf",0===n.filteredFlowGroups.length),e.R7$(1),e.Y8G("ngForOf",n.filteredFlowGroups)}}let Tr=(()=>{class t{constructor(n,i,o){this.flowApiService=n,this.instanceApiService=i,this.drawerService=o,this.destroy$=new cr.B,this.categories=[{key:"",name:"\u5168\u90e8"}],this.flowGroups=[],this.flowConfigs=[],this.selectedCategory="",this.searchKeyword="",this.loading=!1,this.flowGroupsCache=[],this.categoryFlowGroupsCache=new Map,this.filteredFlowGroups=[]}ngOnInit(){this.loadData()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.flowGroupsCache=[],this.categoryFlowGroupsCache.clear()}loadData(){this.loading=!0,Promise.all([this.loadFlowGroups(),this.loadFlowConfigs()]).finally(()=>{this.loading=!1,this.updateFlowGroupsCache()})}loadFlowGroups(){return new Promise(n=>{this.flowApiService.groupList().pipe((0,ln.Q)(this.destroy$)).subscribe({next:i=>{i.success&&i.data&&(this.flowGroups=i.data,this.generateCategories()),n()},error:i=>{console.error("\u52a0\u8f7d\u6d41\u7a0b\u5206\u7ec4\u5931\u8d25:",i),n()}})})}loadFlowConfigs(){return new Promise(n=>{this.instanceApiService.userFlows().pipe((0,ln.Q)(this.destroy$)).subscribe({next:i=>{i.success&&i.data&&(this.flowConfigs=i.data),n()},error:i=>{console.error("\u52a0\u8f7d\u6d41\u7a0b\u914d\u7f6e\u5931\u8d25:",i),n()}})})}generateCategories(){this.categories=[{key:"",name:"\u5168\u90e8"}],this.flowGroups.forEach(n=>{this.categories.push({key:n.name,name:n.name})})}updateFlowGroupsCache(){this.flowGroupsCache=this.groupFlows(this.flowConfigs),this.categories.forEach(n=>{if(n.key){const i=this.flowConfigs.filter(o=>o.flowGroup?.name===n.key);this.categoryFlowGroupsCache.set(n.key,this.groupFlows(i))}}),this.updateFilteredFlowGroups()}onCategorySelect(n){this.selectedCategory=n,this.updateFilteredFlowGroups()}updateFilteredFlowGroups(){let n=[];if(n=this.selectedCategory?this.categoryFlowGroupsCache.get(this.selectedCategory)||[]:this.flowGroupsCache,this.searchKeyword&&this.searchKeyword.trim()){const i=this.searchKeyword.trim().toLowerCase();this.filteredFlowGroups=n.map(o=>({title:o.title,flows:o.flows.filter(r=>r.name.toLowerCase().includes(i)||r.remark&&r.remark.toLowerCase().includes(i))})).filter(o=>o.flows.length>0)}else this.filteredFlowGroups=n}groupFlows(n){const i=new Map;return n.forEach(o=>{const r=o.flowGroup?.name||"\u5176\u4ed6";i.has(r)||i.set(r,[]),i.get(r).push(o)}),Array.from(i.entries()).map(([o,r])=>({title:o,flows:r}))}launchFlow(n){if(n.enable){const i=this.drawerService.create({nzTitle:n.name,nzContent:dr,nzContentParams:{erupt:n.erupt,flow:n,onClose:()=>i.close()},nzWidth:"520px",nzBodyStyle:{padding:"0"},nzMaskClosable:!1})}}getCategoryFlowCount(n){return n?this.flowConfigs.filter(i=>i.flowGroup?.name===n).length:this.flowConfigs.length}refreshData(){this.loadData()}onSearchChange(){this.updateFilteredFlowGroups()}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(S),e.rXU(he),e.rXU(k.Nf))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-flow-dashboard"]],decls:14,vars:5,consts:[[1,"flow-dashboard"],[1,"main-content"],[1,"category-sidebar"],[1,"category-header"],["nz-button","","nzType","text","nzSize","small",3,"nzLoading","click"],["nz-icon","","nzType","reload"],[1,"category-list"],["class","category-item",3,"active","click",4,"ngFor","ngForOf"],[1,"content-area"],["class","search-container",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","flow-groups",4,"ngIf"],[1,"category-item",3,"click"],[1,"category-name"],["class","category-count",4,"ngIf"],[1,"category-count"],[1,"search-container"],["nzPrefixIcon","search","nzSize","default"],["type","text","nz-input","","placeholder","\u641c\u7d22\u6d41\u7a0b\u540d\u79f0...",2,"width","200px",3,"ngModel","ngModelChange"],[1,"loading-container"],["nzSize","large"],[1,"loading-text"],[1,"flow-groups"],["class","empty-state",4,"ngIf"],["class","group-section",4,"ngFor","ngForOf"],[1,"empty-state"],["nz-icon","","nzType","inbox","nzTheme","outline"],[4,"ngIf"],["nz-button","","nzType","primary",3,"click",4,"ngIf"],["nz-button","","nzType","default",3,"click",4,"ngIf"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default",3,"click"],[1,"group-section"],[1,"group-title"],[1,"group-count"],[1,"flow-grid"],[4,"ngFor","ngForOf"],["class","flow-item",3,"ngClass","click",4,"ngIf"],[1,"flow-item",3,"ngClass","click"],[1,"flow-icon"],[3,"classList"],[1,"flow-info"],[1,"flow-name"],["class","flow-desc",4,"ngIf"],[1,"flow-desc"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h3"),e.EFF(5,"\u6d41\u7a0b\u5206\u7c7b"),e.k0s(),e.j41(6,"button",4),e.bIt("click",function(){return o.refreshData()}),e.nrm(7,"i",5),e.k0s()(),e.j41(8,"div",6),e.DNE(9,ur,4,4,"div",7),e.k0s()(),e.j41(10,"div",8),e.DNE(11,gr,3,1,"div",9),e.DNE(12,mr,4,0,"div",10),e.DNE(13,Fr,3,2,"div",11),e.k0s()()()),2&i&&(e.R7$(6),e.Y8G("nzLoading",o.loading),e.R7$(3),e.Y8G("ngForOf",o.categories),e.R7$(2),e.Y8G("ngIf",!o.loading),e.R7$(1),e.Y8G("ngIf",o.loading),e.R7$(1),e.Y8G("ngIf",!o.loading))},dependencies:[d.YU,d.Sq,d.bT,l.me,l.BC,l.vS,v.aO,M.c,T.p,z.Dn,x.Sy,x.tg,ae.a],styles:["[_nghost-%COMP%]     .flow-dashboard{padding:16px;background:#f5f5f5}[_nghost-%COMP%]     .flow-dashboard .overview-section{margin-bottom:24px}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card{background:white;border-radius:12px;padding:24px;box-shadow:0 2px 8px #0000000f;border:1px solid #f0f0f0;display:flex;align-items:center;transition:all .3s ease}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card:hover{box-shadow:0 4px 16px #0000001f;transform:translateY(-2px)}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-icon{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;margin-right:16px;font-size:24px}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-icon:nth-child(1){background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:#fff}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-icon:nth-child(2){background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:#fff}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-icon:nth-child(3){background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%);color:#fff}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-icon:nth-child(4){background:linear-gradient(135deg,#43e97b 0%,#38f9d7 100%);color:#fff}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-content{flex:1}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-content .card-number{font-size:28px;font-weight:700;color:#262626;line-height:1;margin-bottom:4px}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-content .card-label{font-size:14px;color:#8c8c8c;margin:0}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-trend{display:flex;align-items:center;font-size:12px;font-weight:500;padding:4px 8px;border-radius:6px}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-trend.up{color:#52c41a;background:#f6ffed}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-trend.down{color:#ff4d4f;background:#fff2f0}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards .overview-card .card-trend i{margin-right:4px}[_nghost-%COMP%]     .flow-dashboard .main-content{display:grid;grid-template-columns:240px 1fr;gap:0;background:white;border-radius:3px;overflow:hidden;box-shadow:0 2px 8px #0000000f;border:1px solid #f0f0f0}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar{background:#fafafa;border-right:1px solid #f0f0f0}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-header{padding:16px 20px;border-bottom:1px solid #f0f0f0;display:flex;justify-content:space-between;align-items:center}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-header h3{margin:0;font-size:16px;font-weight:600;color:#262626}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-list .category-item{padding:16px 20px;cursor:pointer;transition:all .2s ease;border-bottom:1px solid #f0f0f0;display:flex;justify-content:space-between;align-items:center}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-list .category-item:hover{background:#f5f5f5}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-list .category-item.active{background:#1890ff;color:#fff;font-weight:500}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-list .category-item .category-name{font-size:14px}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-list .category-item .category-count{font-size:12px;color:#8c8c8c;background:rgba(0,0,0,.1);padding:2px 6px;border-radius:10px}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-list .category-item.active .category-count{color:#fffc;background:rgba(255,255,255,.2)}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area{padding:16px;background:white;position:relative}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .search-container{position:absolute;right:16px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .search-container nz-input-group{max-width:600px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .loading-container{display:flex;justify-content:center;align-items:center;min-height:200px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .loading-container .loading-text{margin-top:16px;color:#8c8c8c}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:200px;color:#8c8c8c}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .empty-state i{font-size:48px;margin-bottom:16px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .empty-state p{margin-bottom:16px;font-size:16px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section{margin-bottom:32px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section:last-child{margin-bottom:0}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .group-title{font-size:18px;font-weight:600;color:#262626;margin:0 0 16px;padding-bottom:8px;border-bottom:2px solid #f0f0f0;display:flex;align-items:center;gap:8px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .group-title .group-count{font-size:14px;color:#8c8c8c;font-weight:400}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid .flow-item{background:white;border:1px solid #f0f0f0;border-radius:8px;padding:16px;cursor:pointer;transition:all .3s ease;display:flex;align-items:flex-start;gap:12px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid .flow-item:hover{box-shadow:0 4px 12px #0000001a;transform:translateY(-2px);border-color:#1890ff}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid .flow-item.flow-disabled{opacity:.6;cursor:not-allowed}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid .flow-item.flow-disabled:hover{transform:none;box-shadow:none;border-color:#f0f0f0}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid .flow-item .flow-icon{width:40px;height:40px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:18px;flex-shrink:0;color:#fff}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid .flow-item .flow-info{flex:1;min-width:0}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid .flow-item .flow-info .flow-name{font-size:14px;font-weight:500;color:#262626;line-height:1.4;margin-bottom:4px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid .flow-item .flow-info .flow-desc{font-size:12px;color:#8c8c8c;line-height:1.4;margin-bottom:0;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid .flow-item .flow-info .flow-status{display:flex;align-items:center}@media (max-width: 1200px){[_nghost-%COMP%]     .flow-dashboard .main-content{grid-template-columns:200px 1fr}}@media (max-width: 768px){[_nghost-%COMP%]     .flow-dashboard{padding:16px}[_nghost-%COMP%]     .flow-dashboard .overview-section .overview-cards{grid-template-columns:1fr;gap:12px}[_nghost-%COMP%]     .flow-dashboard .main-content{grid-template-columns:1fr;border-radius:6px}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar{order:2;border-right:none;border-top:1px solid #f0f0f0}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-list{display:flex;overflow-x:auto}[_nghost-%COMP%]     .flow-dashboard .main-content .category-sidebar .category-list .category-item{flex-shrink:0;border-bottom:none;border-right:1px solid #f0f0f0;min-width:120px;text-align:center}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area{order:1;padding:16px}[_nghost-%COMP%]     .flow-dashboard .main-content .content-area .flow-groups .group-section .flow-grid{grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px}}"]})}}return t})();var Er=c(3115),Nr=c(384),cn=c(9116);const pn=function(){return{}};function Pr(t,a){if(1&t&&(e.qex(0),e.nrm(1,"erupt-flow-form",49),e.bVm()),2&t){const n=e.XpG(4);e.R7$(1),e.Y8G("eruptBuild",n.eruptBuild)("readonly",n.ApprovalView.TODO!==n.approvalView)("formAccesses",(null==n.nodeInfo||null==n.nodeInfo.prop?null:n.nodeInfo.prop.formAccesses)||e.lJ4(4,pn))("defaultFormAccess",(null==n.nodeInfo?null:n.nodeInfo.type)==n.NodeType.START?n.FormAccessEnum.DEFAULT:n.FormAccessEnum.READONLY)}}function kr(t,a){1&t&&(e.qex(0),e.j41(1,"div",50),e.EFF(2," Date deleted "),e.k0s(),e.bVm())}function Ir(t,a){if(1&t&&(e.j41(0,"div",35),e.DNE(1,Pr,2,5,"ng-container",48),e.DNE(2,kr,3,0,"ng-container",48),e.k0s()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngIf",!n.dataDeleted),e.R7$(1),e.Y8G("ngIf",n.dataDeleted)}}function Gr(t,a){if(1&t&&(e.j41(0,"td",57),e.EFF(1),e.k0s()),2&t){const n=e.XpG().$implicit;e.Y8G("rowSpan",n.nodeRowspan||1),e.R7$(1),e.SpI(" ",n.nodeId," ")}}const Ce=function(t){return{backgroundColor:t}};function Sr(t,a){if(1&t&&(e.qex(0),e.nrm(1,"nz-avatar",58),e.bVm()),2&t){const n=e.XpG().$implicit,i=e.XpG(4);e.R7$(1),e.Y8G("nzText",null==n||null==n.assigneeUser||null==n.assigneeUser.name?null:n.assigneeUser.name.substring(0,1))("ngStyle",e.eq3(3,Ce,i.getAvatarColor(null==n||null==n.assigneeUser||null==n.assigneeUser.name?null:n.assigneeUser.name.substring(0,1))))("nzSrc",(null==n?null:n.assigneeUser.avatar)||null)}}function Rr(t,a){if(1&t&&(e.qex(0),e.nrm(1,"nz-avatar",58),e.bVm()),2&t){const n=e.XpG(2).$implicit,i=e.XpG(4);e.R7$(1),e.Y8G("nzText",null==n.parentTask.assigneeUser||null==n.parentTask.assigneeUser.name?null:n.parentTask.assigneeUser.name.substring(0,1))("ngStyle",e.eq3(3,Ce,i.getAvatarColor(null==n.parentTask.assigneeUser||null==n.parentTask.assigneeUser.name?null:n.parentTask.assigneeUser.name.substring(0,1))))("nzSrc",n.parentTask.assigneeUser.avatar||null)}}function jr(t,a){if(1&t&&(e.qex(0),e.j41(1,"div"),e.EFF(2,"\xa0\u2190\xa0"),e.k0s(),e.DNE(3,Rr,2,5,"ng-container",48),e.j41(4,"span",55),e.EFF(5),e.k0s(),e.bVm()),2&t){const n=e.XpG().$implicit;e.R7$(3),e.Y8G("ngIf",null==n.parentTask.assigneeUser?null:n.parentTask.assigneeUser.id),e.R7$(2),e.JRh((null==n.parentTask.assigneeUser?null:n.parentTask.assigneeUser.name)||"-")}}function Vr(t,a){if(1&t&&(e.j41(0,"div"),e.nrm(1,"img",59),e.k0s()),2&t){const n=e.XpG().$implicit;e.R7$(1),e.Y8G("nzSrc",n.signature)}}function Dr(t,a){if(1&t&&(e.j41(0,"tr"),e.DNE(1,Gr,2,2,"td",53),e.j41(2,"td")(3,"div",54),e.DNE(4,Sr,2,5,"ng-container",48),e.j41(5,"span",55),e.EFF(6),e.k0s(),e.DNE(7,jr,6,2,"ng-container",48),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.nI1(10,"translate"),e.k0s(),e.j41(11,"td")(12,"nz-tag"),e.EFF(13),e.nI1(14,"translate"),e.k0s()(),e.j41(15,"td")(16,"div"),e.EFF(17),e.k0s(),e.DNE(18,Vr,2,1,"div",48),e.k0s(),e.j41(19,"td")(20,"div",56)(21,"div"),e.EFF(22),e.nI1(23,"date"),e.k0s()()(),e.j41(24,"td")(25,"div",56)(26,"div"),e.EFF(27),e.nI1(28,"date"),e.k0s()()()()),2&t){const n=a.$implicit;e.R7$(1),e.Y8G("ngIf",n.nodeId||null===n.nodeId),e.R7$(3),e.Y8G("ngIf",null==n.assigneeUser?null:n.assigneeUser.id),e.R7$(2),e.JRh((null==n.assigneeUser?null:n.assigneeUser.name)||"-"),e.R7$(1),e.Y8G("ngIf",n.parentTask),e.R7$(2),e.JRh(e.bMT(10,10,n.taskType||"-")),e.R7$(4),e.SpI(" ",e.bMT(14,12,n.taskStatus)," "),e.R7$(4),e.JRh(n.comment||"-"),e.R7$(1),e.Y8G("ngIf",n.signature),e.R7$(4),e.JRh(e.i5U(23,14,n.createTime,"yyyy-MM-dd HH:mm:ss")),e.R7$(5),e.JRh(e.i5U(28,17,n.completedAt,"yyyy-MM-dd HH:mm:ss"))}}function Br(t,a){if(1&t&&(e.j41(0,"div")(1,"nz-table",51,52)(3,"thead")(4,"tr")(5,"th"),e.EFF(6,"\u8282\u70b9 ID"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u5ba1\u6279\u4eba"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u4efb\u52a1\u7c7b\u578b"),e.k0s(),e.j41(11,"th"),e.EFF(12,"\u4efb\u52a1\u72b6\u6001"),e.k0s(),e.j41(13,"th"),e.EFF(14,"\u5ba1\u6279\u610f\u89c1"),e.k0s(),e.j41(15,"th"),e.EFF(16,"\u521b\u5efa\u65f6\u95f4"),e.k0s(),e.j41(17,"th"),e.EFF(18,"\u5ba1\u6279\u65f6\u95f4"),e.k0s()()(),e.j41(19,"tbody"),e.DNE(20,Dr,29,20,"tr",47),e.k0s()()()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("nzData",n.instanceTasks)("nzShowPagination",!1)("nzSize","small"),e.R7$(19),e.Y8G("ngForOf",n.instanceTasks)}}function Ar(t,a){1&t&&e.nrm(0,"nz-empty",60)}function $r(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",61),e.bIt("click",function(){e.eBV(n);const o=e.XpG(3);return e.Njj(o.submitComment())}),e.nrm(1,"span",62),e.EFF(2),e.k0s()}if(2&t){const n=e.XpG(3);e.Y8G("disabled",!n.newComment.trim()||n.isSubmittingComment),e.R7$(2),e.SpI(" ",n.isSubmittingComment?"\u63d0\u4ea4\u4e2d...":"\u53d1\u9001"," ")}}function Yr(t,a){if(1&t&&(e.j41(0,"div",65)(1,"div",66)(2,"div",67),e.nrm(3,"nz-avatar",68),e.j41(4,"span",69),e.EFF(5),e.k0s()(),e.j41(6,"span",70),e.EFF(7),e.nI1(8,"date"),e.k0s()(),e.j41(9,"div",71),e.EFF(10),e.k0s()()),2&t){const n=a.$implicit,i=e.XpG(4);e.R7$(3),e.Y8G("nzText",null==n.createUser||null==n.createUser.name?null:n.createUser.name.substring(0,1))("ngStyle",e.eq3(9,Ce,i.getAvatarColor(null==n.createUser||null==n.createUser.name?null:n.createUser.name.substring(0,1))))("nzSrc",n.createUser.avatar||null),e.R7$(2),e.JRh((null==n.createUser?null:n.createUser.name)||"-"),e.R7$(2),e.JRh(e.i5U(8,6,n.createTime,"yyyy-MM-dd HH:mm:ss")),e.R7$(3),e.SpI(" ",n.comment," ")}}function Xr(t,a){if(1&t&&(e.j41(0,"div",63),e.DNE(1,Yr,11,11,"div",64),e.k0s()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngForOf",n.comments)}}function Lr(t,a){1&t&&e.nrm(0,"nz-empty",72)}function Ur(t,a){if(1&t&&(e.qex(0),e.nrm(1,"nz-avatar",58),e.bVm()),2&t){const n=e.XpG().$implicit,i=e.XpG(3);e.R7$(1),e.Y8G("nzText",null==n.createUser||null==n.createUser.name?null:n.createUser.name.substring(0,1))("ngStyle",e.eq3(3,Ce,i.getAvatarColor(null==n.createUser||null==n.createUser.name?null:n.createUser.name.substring(0,1))))("nzSrc",n.createUser.avatar||null)}}function Hr(t,a){if(1&t){const n=e.RV6();e.j41(0,"tr")(1,"td")(2,"div",54),e.DNE(3,Ur,2,5,"ng-container",48),e.j41(4,"span",55),e.EFF(5),e.k0s()()(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td")(9,"button",73),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG(3);return e.Njj(s.showDiff(r))}),e.EFF(10,"\u67e5\u770b\u8be6\u60c5"),e.k0s()()()}if(2&t){const n=a.$implicit;e.R7$(3),e.Y8G("ngIf",null==n.createUser?null:n.createUser.id),e.R7$(2),e.JRh((null==n.createUser?null:n.createUser.name)||"-"),e.R7$(2),e.SpI(" ",n.createTime," ")}}function Jr(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",22)(1,"div",23)(2,"h1",24),e.EFF(3),e.k0s(),e.j41(4,"nz-tag"),e.EFF(5),e.nI1(6,"translate"),e.k0s(),e.j41(7,"button",25),e.bIt("click",function(){e.eBV(n);const o=e.XpG(2);return e.Njj(o.viewFlow())}),e.EFF(8," \u67e5\u770b\u6d41\u7a0b\u56fe "),e.k0s()(),e.j41(9,"div",26)(10,"div",27)(11,"span",28),e.EFF(12),e.k0s(),e.EFF(13,"\xa0\xa0 "),e.j41(14,"span",29),e.EFF(15),e.k0s()()(),e.j41(16,"nz-tabset",30),e.bIt("nzSelectedIndexChange",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.onTabChange(o))}),e.j41(17,"nz-tab",31)(18,"div",32),e.DNE(19,Ir,3,2,"div",33),e.k0s()(),e.j41(20,"nz-tab",34)(21,"div",32)(22,"div",35),e.DNE(23,Br,21,4,"div",36),e.DNE(24,Ar,1,0,"ng-template",null,37,e.C5r),e.k0s()()(),e.j41(26,"nz-tab",38)(27,"div",32)(28,"div",35)(29,"div",39)(30,"nz-input-group",40)(31,"input",41),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG(2);return e.Njj(r.newComment=o)})("keyup.enter",function(){e.eBV(n);const o=e.XpG(2);return e.Njj(o.submitComment())}),e.k0s()(),e.DNE(32,$r,3,2,"ng-template",null,42,e.C5r),e.k0s(),e.DNE(34,Xr,2,1,"div",43),e.DNE(35,Lr,1,0,"ng-template",null,44,e.C5r),e.k0s()()(),e.j41(37,"nz-tab",45)(38,"div",32)(39,"div",35)(40,"div")(41,"nz-table",46)(42,"thead")(43,"tr")(44,"th"),e.EFF(45,"\u64cd\u4f5c\u4eba"),e.k0s(),e.j41(46,"th"),e.EFF(47,"\u64cd\u4f5c\u65f6\u95f4"),e.k0s(),e.j41(48,"th"),e.EFF(49,"\u53d8\u66f4\u5185\u5bb9"),e.k0s()()(),e.j41(50,"tbody"),e.DNE(51,Hr,11,3,"tr",47),e.k0s()()()()()()()()}if(2&t){const n=e.sdS(25),i=e.sdS(33),o=e.sdS(36),r=e.XpG(2);e.R7$(3),e.JRh(null==r.selectedInstance||null==r.selectedInstance.eruptFlowConfig?null:r.selectedInstance.eruptFlowConfig.name),e.R7$(2),e.SpI(" ",e.bMT(6,17,null==r.selectedInstance?null:r.selectedInstance.status)," "),e.R7$(7),e.JRh(null==r.selectedInstance||null==r.selectedInstance.initiatorUser?null:r.selectedInstance.initiatorUser.name),e.R7$(3),e.SpI("\u63d0\u4ea4\u4e8e ",null==r.selectedInstance?null:r.selectedInstance.createTime,""),e.R7$(1),e.Y8G("nzSelectedIndex",r.activeTabIndex),e.R7$(3),e.Y8G("ngIf",r.eruptBuild),e.R7$(4),e.Y8G("ngIf",r.instanceTasks.length>0)("ngIfElse",n),e.R7$(3),e.Y8G("nzTitle","\u8bc4\u8bba\u5217\u8868 ("+r.comments.length+")"),e.R7$(4),e.Y8G("nzSuffix",i),e.R7$(1),e.Y8G("ngModel",r.newComment),e.R7$(3),e.Y8G("ngIf",r.comments.length>0)("ngIfElse",o),e.R7$(7),e.Y8G("nzShowPagination",!1)("nzSize","small")("nzData",r.dataHistories),e.R7$(10),e.Y8G("ngForOf",r.dataHistories)}}function Wr(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"button",76),e.bIt("click",function(){e.eBV(n);const o=e.XpG(4);return e.Njj(o.resubmit())}),e.nrm(2,"span",77),e.EFF(3," \u91cd\u65b0\u63d0\u4ea4 "),e.k0s(),e.bVm()}}function qr(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",81),e.bIt("click",function(){e.eBV(n);const o=e.XpG(5);return e.Njj(o.cc())}),e.nrm(1,"span",62),e.EFF(2," \u6284\u9001 "),e.k0s()}}function Qr(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",81),e.bIt("click",function(){e.eBV(n);const o=e.XpG(5);return e.Njj(o.transfer())}),e.nrm(1,"span",82),e.EFF(2," \u8f6c\u4ea4 "),e.k0s()}}function Kr(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",81),e.bIt("click",function(){e.eBV(n);const o=e.XpG(5);return e.Njj(o.addSigner())}),e.nrm(1,"span",83),e.EFF(2," \u52a0\u7b7e "),e.k0s()}}function Zr(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",81),e.bIt("click",function(){e.eBV(n);const o=e.XpG(5);return e.Njj(o.return())}),e.nrm(1,"span",84),e.EFF(2," \u9000\u56de "),e.k0s()}}function ea(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",81),e.bIt("click",function(){e.eBV(n);const o=e.XpG(5);return e.Njj(o.modify())}),e.nrm(1,"span",85),e.EFF(2," \u4fee\u6539 "),e.k0s()}}function na(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"button",76),e.bIt("click",function(){e.eBV(n);const o=e.XpG(4);return e.Njj(o.approve())}),e.nrm(2,"span",77),e.EFF(3," \u540c\u610f "),e.k0s(),e.j41(4,"button",78),e.bIt("click",function(){e.eBV(n);const o=e.XpG(4);return e.Njj(o.reject())}),e.nrm(5,"span",79),e.EFF(6," \u62d2\u7edd "),e.k0s(),e.DNE(7,qr,3,0,"button",80),e.DNE(8,Qr,3,0,"button",80),e.DNE(9,Kr,3,0,"button",80),e.DNE(10,Zr,3,0,"button",80),e.DNE(11,ea,3,0,"button",80),e.bVm()}if(2&t){const n=e.XpG(4);e.R7$(7),e.Y8G("ngIf",null==n.nodeInfo||null==n.nodeInfo.prop?null:n.nodeInfo.prop.allowCc),e.R7$(1),e.Y8G("ngIf",null==n.nodeInfo||null==n.nodeInfo.prop?null:n.nodeInfo.prop.allowTransfer),e.R7$(1),e.Y8G("ngIf",null==n.nodeInfo||null==n.nodeInfo.prop?null:n.nodeInfo.prop.allowAddSign),e.R7$(1),e.Y8G("ngIf",null==n.nodeInfo||null==n.nodeInfo.prop?null:n.nodeInfo.prop.allowReturn),e.R7$(1),e.Y8G("ngIf",n.Object.keys((null==n.nodeInfo||null==n.nodeInfo.prop?null:n.nodeInfo.prop.formAccesses)||e.lJ4(5,pn)).length)}}function ta(t,a){if(1&t&&(e.qex(0),e.DNE(1,Wr,4,0,"ng-container",48),e.DNE(2,na,12,6,"ng-container",48),e.bVm()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngIf",(null==n.nodeInfo?null:n.nodeInfo.type)==n.NodeType.START),e.R7$(1),e.Y8G("ngIf",(null==n.nodeInfo?null:n.nodeInfo.type)==n.NodeType.APPROVAL)}}function oa(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",81),e.bIt("click",function(){e.eBV(n);const o=e.XpG(4);return e.Njj(o.urge())}),e.nrm(1,"span",86),e.EFF(2," \u50ac\u529e "),e.k0s()}}function ia(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",81),e.bIt("click",function(){e.eBV(n);const o=e.XpG(4);return e.Njj(o.withdraw())}),e.nrm(1,"span",87),e.EFF(2," \u64a4\u9500 "),e.k0s()}}function ra(t,a){if(1&t&&(e.qex(0),e.DNE(1,oa,3,0,"button",80),e.DNE(2,ia,3,0,"button",80),e.bVm()),2&t){const n=e.XpG(3);e.R7$(1),e.Y8G("ngIf",!n.selectedInstance.finishTime),e.R7$(1),e.Y8G("ngIf",!n.selectedInstance.finishTime)}}function aa(t,a){if(1&t&&(e.j41(0,"div",74)(1,"div",75),e.DNE(2,ta,3,2,"ng-container",48),e.DNE(3,ra,3,2,"ng-container",48),e.k0s()()),2&t){const n=e.XpG(2);e.R7$(2),e.Y8G("ngIf",n.ApprovalView.TODO===n.approvalView&&n.currTask),e.R7$(1),e.Y8G("ngIf",n.ApprovalView.CREATED===n.approvalView)}}function sa(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"span",13),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.copyToClipboard(null==o.selectedInstance?null:o.selectedInstance.no))}),e.EFF(4),e.nrm(5,"span",14),e.k0s()(),e.j41(6,"div",15)(7,"button",16),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.copyLink())}),e.nrm(8,"span",17),e.k0s(),e.j41(9,"button",18),e.bIt("click",function(){e.eBV(n);const o=e.XpG();return e.Njj(o.loadInstanceDetail(o.selectedInstance))}),e.nrm(10,"span",19),e.k0s()()(),e.DNE(11,Jr,52,19,"div",20),e.DNE(12,aa,4,2,"div",21),e.k0s()}if(2&t){const n=e.XpG();e.R7$(4),e.SpI(" \u7f16\u53f7: ",null==n.selectedInstance?null:n.selectedInstance.no," "),e.R7$(7),e.Y8G("ngIf",n.selectedInstance),e.R7$(1),e.Y8G("ngIf",!n.dataDeleted)}}function la(t,a){1&t&&(e.j41(0,"div",88)(1,"div",89),e.nrm(2,"nz-empty",90),e.k0s()())}function ca(t,a){if(1&t){const n=e.RV6();e.qex(0),e.j41(1,"button",99),e.bIt("click",function(){e.eBV(n);const o=e.XpG(3);return e.Njj(o.approveSignature=null)}),e.nrm(2,"span",100),e.k0s(),e.nrm(3,"img",101),e.bVm()}if(2&t){const n=e.XpG(3);e.R7$(3),e.Y8G("src",n.approveSignature,e.B4B)}}function pa(t,a){if(1&t){const n=e.RV6();e.j41(0,"button",102),e.bIt("click",function(){e.eBV(n);const o=e.XpG(3);return e.Njj(o.openSign())}),e.nrm(1,"span",85),e.k0s()}}function da(t,a){if(1&t&&(e.qex(0),e.j41(1,"div",95)(2,"p",92)(3,"span",96),e.EFF(4,"*"),e.k0s(),e.EFF(5," \u540c\u610f\u7b7e\u540d\uff1a"),e.k0s(),e.j41(6,"div",97),e.DNE(7,ca,4,1,"ng-container",48),e.DNE(8,pa,2,0,"button",98),e.k0s()(),e.bVm()),2&t){const n=e.XpG(2);e.R7$(7),e.Y8G("ngIf",n.approveSignature),e.R7$(1),e.Y8G("ngIf",!n.approveSignature)}}function _a(t,a){1&t&&(e.j41(0,"span",96),e.EFF(1,"*"),e.k0s())}const L=function(){return{minRows:3,maxRows:6}};function ua(t,a){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"div",91),e.DNE(2,da,9,2,"ng-container",48),e.j41(3,"p",92),e.DNE(4,_a,2,0,"span",93),e.EFF(5," \u8bf7\u586b\u5199\u540c\u610f\u539f\u56e0\uff1a "),e.k0s(),e.j41(6,"nz-input-group")(7,"textarea",94),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reason=o)}),e.k0s()()()()}if(2&t){const n=e.XpG();e.R7$(2),e.Y8G("ngIf",null==n.nodeInfo||null==n.nodeInfo.prop?null:n.nodeInfo.prop.requireSignature),e.R7$(2),e.Y8G("ngIf",null==n.nodeInfo||null==n.nodeInfo.prop?null:n.nodeInfo.prop.requireApprovalNote),e.R7$(3),e.Y8G("ngModel",n.reason)("nzAutosize",e.lJ4(4,L))}}function ga(t,a){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"div",91)(2,"p",92)(3,"span",96),e.EFF(4,"*"),e.k0s(),e.EFF(5," \u8bf7\u586b\u5199\u62d2\u7edd\u539f\u56e0\uff1a"),e.k0s(),e.j41(6,"nz-input-group")(7,"textarea",103),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reason=o)}),e.k0s()()()()}if(2&t){const n=e.XpG();e.R7$(7),e.Y8G("ngModel",n.reason)("nzAutosize",e.lJ4(2,L))}}function ma(t,a){if(1&t&&e.nrm(0,"nz-option",109),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function fa(t,a){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"div",91)(2,"div",104)(3,"label",105)(4,"span",96),e.EFF(5,"*"),e.k0s(),e.EFF(6," \u6284\u9001\u4eba\u5458\uff1a"),e.k0s(),e.j41(7,"nz-select",106),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.ccUsers=o)}),e.DNE(8,ma,1,2,"nz-option",107),e.k0s()(),e.j41(9,"div",104)(10,"label",105)(11,"span",96),e.EFF(12,"*"),e.k0s(),e.EFF(13," \u6284\u9001\u8bf4\u660e\uff1a"),e.k0s(),e.j41(14,"nz-input-group")(15,"textarea",108),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reason=o)}),e.k0s()()()()()}if(2&t){const n=e.XpG();e.R7$(7),e.Y8G("ngModel",n.ccUsers)("nzMode","multiple")("nzPlaceHolder","\u8bf7\u9009\u62e9\u6284\u9001\u4eba\u5458")("nzShowSearch",!0)("nzAllowClear",!0),e.R7$(1),e.Y8G("ngForOf",n.availableUsers),e.R7$(7),e.Y8G("ngModel",n.reason)("nzAutosize",e.lJ4(8,L))}}function ha(t,a){if(1&t&&e.nrm(0,"nz-option",109),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function Ca(t,a){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"div",91)(2,"div",104)(3,"label",105)(4,"span",96),e.EFF(5,"*"),e.k0s(),e.EFF(6," \u8f6c\u4ea4\u4eba\u5458\uff1a"),e.k0s(),e.j41(7,"nz-select",110),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.transferUser=o)}),e.DNE(8,ha,1,2,"nz-option",107),e.k0s()(),e.j41(9,"div",104)(10,"label",105)(11,"span",96),e.EFF(12,"*"),e.k0s(),e.EFF(13," \u8f6c\u4ea4\u8bf4\u660e\uff1a"),e.k0s(),e.j41(14,"nz-input-group")(15,"textarea",111),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reason=o)}),e.k0s()()()()()}if(2&t){const n=e.XpG();e.R7$(7),e.Y8G("ngModel",n.transferUser)("nzPlaceHolder","\u8bf7\u9009\u62e9\u8f6c\u4ea4\u4eba\u5458")("nzShowSearch",!0)("nzAllowClear",!0),e.R7$(1),e.Y8G("ngForOf",n.availableUsers),e.R7$(7),e.Y8G("ngModel",n.reason)("nzAutosize",e.lJ4(7,L))}}function ba(t,a){if(1&t&&e.nrm(0,"nz-option",109),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function va(t,a){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"div",91)(2,"div",104)(3,"label",105)(4,"span",96),e.EFF(5,"*"),e.k0s(),e.EFF(6," \u52a0\u7b7e\u7c7b\u578b\uff1a"),e.k0s(),e.j41(7,"nz-radio-group",112),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.addSignType=o)}),e.j41(8,"label",113),e.EFF(9,"\u524d\u52a0\u7b7e"),e.k0s(),e.j41(10,"label",113),e.EFF(11,"\u540e\u52a0\u7b7e"),e.k0s()()(),e.j41(12,"div",104)(13,"label",105)(14,"span",96),e.EFF(15,"*"),e.k0s(),e.EFF(16," \u52a0\u7b7e\u4eba\u5458\uff1a"),e.k0s(),e.j41(17,"nz-select",114),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.addSignUsers=o)}),e.DNE(18,ba,1,2,"nz-option",107),e.k0s()(),e.j41(19,"div",104)(20,"label",105)(21,"span",96),e.EFF(22,"*"),e.k0s(),e.EFF(23," \u52a0\u7b7e\u8bf4\u660e\uff1a"),e.k0s(),e.j41(24,"nz-input-group")(25,"textarea",115),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reason=o)}),e.k0s()()()()()}if(2&t){const n=e.XpG();e.R7$(7),e.Y8G("ngModel",n.addSignType),e.R7$(1),e.Y8G("nzValue",n.AddSignType.PRE_SIGN),e.R7$(2),e.Y8G("nzValue",n.AddSignType.POST_SIGN),e.R7$(7),e.Y8G("ngModel",n.addSignUsers)("nzMode","multiple")("nzPlaceHolder","\u8bf7\u9009\u62e9\u52a0\u7b7e\u4eba\u5458")("nzShowSearch",!0)("nzAllowClear",!0),e.R7$(1),e.Y8G("ngForOf",n.availableUsers),e.R7$(7),e.Y8G("ngModel",n.reason)("nzAutosize",e.lJ4(11,L))}}function xa(t,a){if(1&t&&e.nrm(0,"nz-option",109),2&t){const n=a.$implicit;e.Y8G("nzValue",n.key)("nzLabel",n.value)}}function wa(t,a){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"div",91)(2,"div",104)(3,"label",105)(4,"span",96),e.EFF(5,"*"),e.k0s(),e.EFF(6," \u9000\u56de\u8282\u70b9\uff1a"),e.k0s(),e.j41(7,"nz-select",116),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.returnNode=o)}),e.DNE(8,xa,1,2,"nz-option",107),e.k0s()(),e.j41(9,"div",104)(10,"label",105)(11,"span",96),e.EFF(12,"*"),e.k0s(),e.EFF(13," \u9000\u56de\u8bf4\u660e\uff1a"),e.k0s(),e.j41(14,"nz-input-group")(15,"textarea",117),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reason=o)}),e.k0s()()()()()}if(2&t){const n=e.XpG();e.R7$(7),e.Y8G("ngModel",n.returnNode)("nzPlaceHolder","\u8bf7\u9009\u62e9\u9000\u56de\u8282\u70b9")("nzShowSearch",!0)("nzAllowClear",!0),e.R7$(1),e.Y8G("ngForOf",n.availableReturnNodes),e.R7$(7),e.Y8G("ngModel",n.reason)("nzAutosize",e.lJ4(7,L))}}function Ma(t,a){if(1&t){const n=e.RV6();e.j41(0,"div")(1,"div",91)(2,"p",92),e.EFF(3,"\u63d0\u4ea4\u8bf4\u660e\uff1a"),e.k0s(),e.j41(4,"nz-input-group")(5,"textarea",118),e.bIt("ngModelChange",function(o){e.eBV(n);const r=e.XpG();return e.Njj(r.reason=o)}),e.k0s()()()()}if(2&t){const n=e.XpG();e.R7$(5),e.Y8G("ngModel",n.reason)("nzAutosize",e.lJ4(2,L))}}let Se=(()=>{class t{constructor(n,i,o,r,s,u,U,Re){this.modal=n,this.message=i,this.upmsApiService=o,this.flowApiService=r,this.dataHandlerService=s,this.flowInstanceApiService=u,this.drawerService=U,this.route=Re,this.activeTabIndex=0,this.dataHistories=[],this.instanceDetail=null,this.instanceTasks=[],this.nodeInfo=null,this.currTask=null,this.comments=[],this.newComment="",this.isSubmittingComment=!1,this.approveModalVisible=!1,this.rejectModalVisible=!1,this.ccModalVisible=!1,this.transferModalVisible=!1,this.addSignModalVisible=!1,this.returnModalVisible=!1,this.resubmitModalVisible=!1,this.approveSignature=null,this.ccUsers=[],this.transferUser=null,this.addSignUsers=[],this.addSignType=ce.PRE_SIGN,this.availableUsers=[],this.availableReturnNodes=[],this.dataDeleted=!1,this.approvalView=V.TODO,this.reloadFlows=new e.bkB,this.AddSignType=ce,this.ApprovalView=V,this.Object=Object,this.getAvatarColor=Ae,this.FormAccessEnum=E,this.NodeType=h;const dn=this.route.snapshot.paramMap.get("no");dn&&u.detail(dn).subscribe({next:Ra=>{this.onSelectFlow(V.TODO,Ra.data)}})}ngOnInit(){}onSelectFlow(n,i){this.approvalView=n,this.selectedInstance=i,this.selectedInstance&&this.loadInstanceDetail(i)}loadInstanceDetail(n,i=!1){i&&this.reloadFlows.emit(),this.flowInstanceApiService.detail(n.no).subscribe({next:o=>{this.instanceDetail=o.data,this.flowApiService.eruptFlowBuild(this.instanceDetail.erupt).subscribe({next:r=>{this.eruptBuild=null,setTimeout(()=>{this.dataHandlerService.initErupt(r.data),this.eruptBuild=r.data,this.flowInstanceApiService.eruptData(n.id).subscribe({next:s=>{s.success?(this.dataHandlerService.objectToEruptValue(s.data,this.eruptBuild),this.dataDeleted=!1):this.dataDeleted=!0}})},30)}})}}),this.flowInstanceApiService.tasks(n.id).subscribe({next:o=>{const r=o.data||[];for(let s=0;s<r.length;){if(!r[s].nodeId){s++;continue}let u=1;for(;s+u<r.length&&r[s+u].nodeId===r[s].nodeId;)u++;if(u>1){r[s].nodeRowspan=u;for(let U=1;U<u;U++)r[s+U].nodeId=""}s+=u}this.instanceTasks=r}}),this.flowInstanceApiService.commentList(n.id).subscribe({next:o=>{this.comments=o.data||[]}}),this.getDataHistories(n.id),this.approvalView==V.TODO&&this.flowInstanceApiService.currTask(n.id,this.approvalView).subscribe({next:o=>{this.currTask=o.data,this.flowInstanceApiService.taskNodeInfo(o.data.id).subscribe({next:r=>{this.nodeInfo=r.data}})}})}approve(){this.reason=null,this.approveModalVisible=!0}reject(){this.reason=null,this.rejectModalVisible=!0}cc(){this.reason=null,this.ccUsers=[],this.loadAvailableUsers(),this.ccModalVisible=!0}submitApprove(){if(this.nodeInfo?.prop?.requireApprovalNote&&!this.reason?.trim())return void this.message.warning("\u8bf7\u586b\u5199\u540c\u610f\u539f\u56e0");let n;this.approveModalVisible=!0,Object.keys(this.nodeInfo?.prop?.formAccesses||{}).length&&(n=this.dataHandlerService.eruptValueToObject(this.eruptBuild)),this.flowInstanceApiService.agree(this.currTask.id,this.reason,this.approveSignature,n).subscribe(i=>{this.approveModalVisible=!1,this.reason=null,this.message.success("\u5ba1\u6279\u5df2\u540c\u610f"),this.selectedInstance=null,this.loadInstanceDetail(this.selectedInstance,!0)})}submitReject(){this.reason?.trim()?this.flowInstanceApiService.refuse(this.currTask.id,this.reason).subscribe(n=>{this.rejectModalVisible=!1,this.reason=null,this.message.success("\u5ba1\u6279\u5df2\u62d2\u7edd"),this.selectedInstance=null,this.loadInstanceDetail(this.selectedInstance,!0)}):this.message.warning("\u8bf7\u586b\u5199\u62d2\u7edd\u539f\u56e0")}submitCc(){0!==this.ccUsers.length?this.reason?.trim()?this.flowInstanceApiService.cc(this.currTask.id,this.ccUsers,this.reason).subscribe(n=>{this.reason=null,this.ccUsers=[],this.ccModalVisible=!1,this.message.success("\u6284\u9001\u6210\u529f"),this.selectedInstance?.id&&this.loadInstanceDetail(this.selectedInstance)}):this.message.warning("\u8bf7\u586b\u5199\u6284\u9001\u8bf4\u660e"):this.message.warning("\u8bf7\u9009\u62e9\u6284\u9001\u4eba\u5458")}submitTransfer(){this.transferUser?this.reason?.trim()?this.flowInstanceApiService.transfer(this.currTask.id,this.transferUser,this.reason).subscribe(n=>{this.transferModalVisible=!1,this.message.success("\u8f6c\u4ea4\u6210\u529f"),this.transferModalVisible=!1,this.reason=null,this.transferUser=null,this.selectedInstance?.id&&this.loadInstanceDetail(this.selectedInstance)}):this.message.warning("\u8bf7\u586b\u5199\u8f6c\u4ea4\u8bf4\u660e"):this.message.warning("\u8bf7\u9009\u62e9\u8f6c\u4ea4\u4eba\u5458")}submitAddSign(){this.addSignType?0!==this.addSignUsers.length?this.reason?.trim()?this.flowInstanceApiService.addSign(this.currTask.id,this.addSignType,this.addSignUsers,this.reason).subscribe(n=>{this.message.success("\u52a0\u7b7e\u6210\u529f"),this.addSignModalVisible=!1,this.selectedInstance?.id&&this.loadInstanceDetail(this.selectedInstance)}):this.message.warning("\u8bf7\u586b\u5199\u52a0\u7b7e\u8bf4\u660e"):this.message.warning("\u8bf7\u9009\u62e9\u52a0\u7b7e\u4eba\u5458"):this.message.warning("\u8bf7\u9009\u62e9\u52a0\u7b7e\u7c7b\u578b")}submitReturn(){this.returnNode?this.reason.trim()?this.flowInstanceApiService.rollback(this.currTask.id,this.returnNode,this.reason).subscribe(n=>{this.message.success("\u9000\u56de\u6210\u529f"),this.returnModalVisible=!1,this.reason=null,this.returnNode=null,this.loadInstanceDetail(this.selectedInstance)}):this.message.warning("\u8bf7\u586b\u5199\u9000\u56de\u8bf4\u660e"):this.message.warning("\u8bf7\u9009\u62e9\u9000\u56de\u8282\u70b9")}transfer(){this.transferUser=null,this.reason=null,this.loadAvailableUsers(),this.transferModalVisible=!0}addSigner(){this.addSignUsers=[],this.reason=null,this.addSignType=ce.PRE_SIGN,this.loadAvailableUsers(),this.addSignModalVisible=!0}return(){this.returnNode=null,this.reason=null,this.returnModalVisible=!0,this.flowInstanceApiService.availableReturnNodes(this.currTask.id).subscribe({next:n=>{this.availableReturnNodes=n.data||[]}})}resubmit(){this.reason=null,this.resubmitModalVisible=!0}submitResubmit(){let n=this.dataHandlerService.eruptValueToObject(this.eruptBuild);this.flowInstanceApiService.resubmit(this.currTask.id,this.reason,n).subscribe(i=>{this.resubmitModalVisible=!1,this.reason=null,this.message.success("\u63d0\u4ea4\u6210\u529f"),this.selectedInstance=null,this.loadInstanceDetail(this.selectedInstance,!0)})}modify(){let n=this.dataHandlerService.eruptValueToObject(this.eruptBuild);this.flowInstanceApiService.updateData(this.selectedInstance.id,n).subscribe({next:i=>{this.message.success("\u4fee\u6539\u6210\u529f"),this.getDataHistories(this.selectedInstance.id)}})}getDataHistories(n){this.flowInstanceApiService.dataHistories(n).subscribe({next:i=>{this.dataHistories=i.data}})}copyToClipboard(n){n&&navigator.clipboard.writeText(n).then(()=>{this.message.success("\u7f16\u53f7\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f")})}withdraw(){this.flowInstanceApiService.withdraw(this.selectedInstance.id,"\u64a4\u56de").subscribe({next:n=>{this.message.success("\u64a4\u56de\u6210\u529f"),this.loadInstanceDetail(this.selectedInstance)}})}urge(){this.flowInstanceApiService.urge(this.selectedInstance.id,"\u50ac\u529e").subscribe({next:n=>{this.message.success("\u50ac\u529e\u6210\u529f"),this.loadInstanceDetail(this.selectedInstance)}})}onTabChange(n){this.activeTabIndex=n}submitComment(){!this.newComment.trim()||!this.selectedInstance?.id||(this.isSubmittingComment=!0,this.flowInstanceApiService.commentCreate(Number(this.selectedInstance.id),this.newComment).subscribe({next:()=>{this.message.success("\u8bc4\u8bba\u63d0\u4ea4\u6210\u529f"),this.newComment="",this.selectedInstance?.id&&this.flowInstanceApiService.commentList(Number(this.selectedInstance.id)).subscribe(n=>{this.comments=n.data||[]})},complete:()=>{this.isSubmittingComment=!1}}))}openSign(){this.modal.create({nzTitle:"\u7b7e\u540d",nzContent:Er.L,nzMaskClosable:!1,nzWidth:"50%",nzOkText:"\u4fdd\u5b58",nzCancelText:"\u53d6\u6d88",nzOnOk:n=>{this.approveSignature=n.getSign()},nzOnCancel:()=>{}})}viewFlow(){let n=this.drawerService.create({nzTitle:"\u67e5\u770b\u6d41\u7a0b",nzContent:Ge,nzContentParams:{eruptBuild:this.eruptBuild,modelValue:this.selectedInstance.rule,readonly:!0},nzBodyStyle:{padding:"0",background:"rgb(245 245 245)"},nzPlacement:"bottom",nzHeight:"85%",nzFooter:null});this.flowInstanceApiService.progress(this.selectedInstance.id).subscribe(i=>{n.getContentComponent().progress=i.data})}showDiff(n){let i=this.modal.create({nzTitle:"\u53d8\u66f4\u8be6\u60c5",nzContent:Nr.sd,nzBodyStyle:{height:"500px"},nzWidth:"60%",nzFooter:null,nzCancelText:null});i.componentInstance.nzEditorMode="diff",i.componentInstance.nzEditorOption={language:"json",readOnly:!0},i.componentInstance.nzOriginalText=n.beforeData,i.componentInstance.writeValue(n.afterData)}loadAvailableUsers(){this.upmsApiService.users().subscribe(n=>{this.availableUsers=n.data})}copyLink(){let n=location.origin+"/#/fill/flow/approval-detail/"+this.selectedInstance.no;navigator.clipboard.writeText(n).then(()=>{this.message.success("\u5730\u5740\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f")})}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(g.N_),e.rXU(R.xh),e.rXU(Fe),e.rXU(S),e.rXU(ne.u),e.rXU(he),e.rXU(k.Nf),e.rXU(Ie.nX))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["flow-approval-detail"]],inputs:{selectedInstance:"selectedInstance",approvalView:"approvalView"},outputs:{reloadFlows:"reloadFlows"},decls:17,vars:9,consts:[["class","approval-detail",4,"ngIf","ngIfElse"],["emptyDetail",""],["nzTitle","\u540c\u610f\u5ba1\u6279","nzOkText","\u786e\u5b9a","nzCancelText","\u53d6\u6d88",3,"nzVisible","nzVisibleChange","nzOnOk","nzOnCancel"],[4,"nzModalContent"],["nzTitle","\u62d2\u7edd\u5ba1\u6279","nzOkText","\u786e\u5b9a","nzCancelText","\u53d6\u6d88","nzOkDanger","true",3,"nzVisible","nzVisibleChange","nzOnOk","nzOnCancel"],["nzTitle","\u6284\u9001\u5ba1\u6279","nzOkText","\u786e\u5b9a","nzCancelText","\u53d6\u6d88",3,"nzVisible","nzVisibleChange","nzOnOk","nzOnCancel"],["nzTitle","\u8f6c\u4ea4\u5ba1\u6279","nzOkText","\u786e\u5b9a","nzCancelText","\u53d6\u6d88",3,"nzVisible","nzVisibleChange","nzOnOk","nzOnCancel"],["nzTitle","\u52a0\u7b7e\u5ba1\u6279","nzOkText","\u786e\u5b9a","nzCancelText","\u53d6\u6d88",3,"nzVisible","nzVisibleChange","nzOnOk","nzOnCancel"],["nzTitle","\u9000\u56de\u5ba1\u6279","nzOkText","\u786e\u5b9a","nzCancelText","\u53d6\u6d88","nzOkDanger","true",3,"nzVisible","nzVisibleChange","nzOnOk","nzOnCancel"],["nzTitle","\u91cd\u65b0\u63d0\u4ea4","nzOkText","\u786e\u5b9a","nzCancelText","\u53d6\u6d88",3,"nzVisible","nzVisibleChange","nzOnOk","nzOnCancel"],[1,"approval-detail"],[1,"detail-header"],[1,"header-left"],[1,"item-id",2,"cursor","pointer",3,"click"],["nz-icon","","nzType","copy","nzTheme","outline",1,"copy-icon"],[1,"header-right"],["nz-button","","nzType","text","nzSize","small","nz-tooltip","","nzTooltipTitle","\u94fe\u63a5",3,"click"],["nz-icon","","nzType","link","nzTheme","outline"],["nz-button","","nzType","text","nzSize","small","nz-tooltip","","nzTooltipTitle","\u5237\u65b0",3,"click"],["nz-icon","","nzType","reload","nzTheme","outline"],["class","detail-content",4,"ngIf"],["class","fixed-bottom-actions",4,"ngIf"],[1,"detail-content"],[1,"content-header"],[1,"content-title"],["nz-button","",2,"margin-left","auto",3,"click"],[1,"submitter-info-large"],[1,"submitter-details"],[1,"submitter-name-large"],[1,"submit-time"],[1,"detail-tabs",3,"nzSelectedIndex","nzSelectedIndexChange"],["nzTitle","\u5ba1\u6279\u4fe1\u606f"],[1,"tab-content"],["class","section",4,"ngIf"],["nzTitle","\u5ba1\u6279\u8bb0\u5f55"],[1,"section"],[4,"ngIf","ngIfElse"],["noTasks",""],[3,"nzTitle"],[1,"comment-form"],[3,"nzSuffix"],["nz-input","","placeholder","\u8bf7\u8f93\u5165\u8bc4\u8bba\u5185\u5bb9...",3,"ngModel","ngModelChange","keyup.enter"],["commentSuffix",""],["class","comments-list",4,"ngIf","ngIfElse"],["noComments",""],["nzTitle","\u6570\u636e\u53d8\u66f4\u8bb0\u5f55"],[1,"records-table",3,"nzShowPagination","nzSize","nzData"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"eruptBuild","readonly","formAccesses","defaultFormAccess"],[2,"text-align","center","margin","100px 0","color","#F44336"],[1,"records-table",3,"nzData","nzShowPagination","nzSize"],["recordsTable",""],[3,"rowSpan",4,"ngIf"],[1,"approval-info"],[1,"approval-name"],[1,"time-info"],[3,"rowSpan"],["nzSize","small",1,"mr-sm",3,"nzText","ngStyle","nzSrc"],["nz-image","","alt","signature",2,"cursor","pointer","margin-top","4px","width","100px","border","1px solid #f0f0f0",3,"nzSrc"],["nzNotFoundImage","simple","nzNotFoundContent","\u6682\u65e0\u5ba1\u6279\u8bb0\u5f55"],["nz-button","","nzType","primary","nzSize","small",3,"disabled","click"],["nz-icon","","nzType","send","nzTheme","outline"],[1,"comments-list"],["class","comment-item",4,"ngFor","ngForOf"],[1,"comment-item"],[1,"comment-header"],[1,"comment-user"],["nzSize","small",3,"nzText","ngStyle","nzSrc"],[1,"comment-username"],[1,"comment-time"],[1,"comment-content"],["nzNotFoundImage","simple","nzNotFoundContent","\u6682\u65e0\u8bc4\u8bba\u5185\u5bb9"],["nz-button","","nzSize","small",3,"click"],[1,"fixed-bottom-actions"],[1,"action-buttons"],["nz-button","","nzSize","default","nzType","primary","nzGhost","",1,"action-button",3,"click"],["nz-icon","","nzType","check","nzTheme","outline"],["nz-button","","nzSize","default","nzDanger","",1,"action-button",3,"click"],["nz-icon","","nzType","close","nzTheme","outline"],["nz-button","","nzSize","default","class","action-button",3,"click",4,"ngIf"],["nz-button","","nzSize","default",1,"action-button",3,"click"],["nz-icon","","nzType","swap","nzTheme","outline"],["nz-icon","","nzType","user-add","nzTheme","outline"],["nz-icon","","nzType","rollback","nzTheme","outline"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-icon","","nzType","bell","nzTheme","outline"],["nz-icon","","nzType","undo","nzTheme","outline"],[1,"detail-section","empty-detail"],[1,"empty-content",2,"margin-top","20%"],["nzNotFoundImage","simple"],[1,"modal-content"],[1,"modal-description"],["style","color: #f00",4,"ngIf"],["nz-input","","placeholder","\u8bf7\u8f93\u5165\u540c\u610f\u539f\u56e0...",1,"reason-textarea",3,"ngModel","nzAutosize","ngModelChange"],[2,"margin-bottom","16px"],[2,"color","#f00"],[2,"width","100%","height","200px","position","relative","border","1px solid #d9d9d9","border-radius","2px"],["nz-button","","nzType","default","nzShape","circle","style","position: absolute;;top: 42%;left: 50%;transform: translate(-50%);",3,"click",4,"ngIf"],["nz-button","","nzType","default","nzShape","circle",2,"position","absolute","right","16px","top","16px",3,"click"],["nz-icon","","nzType","clear","nzTheme","outline"],["alt","",2,"height","200px","width","100%",3,"src"],["nz-button","","nzType","default","nzShape","circle",2,"position","absolute",";top","42%","left","50%","transform","translate(-50%)",3,"click"],["nz-input","","placeholder","\u8bf7\u8f93\u5165\u62d2\u7edd\u539f\u56e0...",1,"reason-textarea",3,"ngModel","nzAutosize","ngModelChange"],[1,"form-item"],[1,"form-label"],[1,"cc-user-select",3,"ngModel","nzMode","nzPlaceHolder","nzShowSearch","nzAllowClear","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nz-input","","placeholder","\u8bf7\u8f93\u5165\u6284\u9001\u8bf4\u660e...",1,"reason-textarea",3,"ngModel","nzAutosize","ngModelChange"],[3,"nzValue","nzLabel"],[1,"transfer-user-select",3,"ngModel","nzPlaceHolder","nzShowSearch","nzAllowClear","ngModelChange"],["nz-input","","placeholder","\u8bf7\u8f93\u5165\u8f6c\u4ea4\u8bf4\u660e...",1,"reason-textarea",3,"ngModel","nzAutosize","ngModelChange"],[1,"add-sign-type-group",3,"ngModel","ngModelChange"],["nz-radio","",3,"nzValue"],[1,"add-sign-user-select",3,"ngModel","nzMode","nzPlaceHolder","nzShowSearch","nzAllowClear","ngModelChange"],["nz-input","","placeholder","\u8bf7\u8f93\u5165\u52a0\u7b7e\u8bf4\u660e...",1,"reason-textarea",3,"ngModel","nzAutosize","ngModelChange"],[1,"return-node-select",3,"ngModel","nzPlaceHolder","nzShowSearch","nzAllowClear","ngModelChange"],["nz-input","","placeholder","\u8bf7\u8f93\u5165\u9000\u56de\u8bf4\u660e...",1,"reason-textarea",3,"ngModel","nzAutosize","ngModelChange"],["nz-input","","placeholder","\u63d0\u4ea4\u8bf4\u660e...",1,"reason-textarea",3,"ngModel","nzAutosize","ngModelChange"]],template:function(i,o){if(1&i&&(e.DNE(0,sa,13,3,"div",0),e.DNE(1,la,3,0,"ng-template",null,1,e.C5r),e.j41(3,"nz-modal",2),e.bIt("nzVisibleChange",function(s){return o.approveModalVisible=s})("nzOnOk",function(){return o.submitApprove()})("nzOnCancel",function(){return o.approveModalVisible=!1}),e.DNE(4,ua,8,5,"div",3),e.k0s(),e.j41(5,"nz-modal",4),e.bIt("nzVisibleChange",function(s){return o.rejectModalVisible=s})("nzOnOk",function(){return o.submitReject()})("nzOnCancel",function(){return o.rejectModalVisible=!1}),e.DNE(6,ga,8,3,"div",3),e.k0s(),e.j41(7,"nz-modal",5),e.bIt("nzVisibleChange",function(s){return o.ccModalVisible=s})("nzOnOk",function(){return o.submitCc()})("nzOnCancel",function(){return o.ccModalVisible=!1}),e.DNE(8,fa,16,9,"div",3),e.k0s(),e.j41(9,"nz-modal",6),e.bIt("nzVisibleChange",function(s){return o.transferModalVisible=s})("nzOnOk",function(){return o.submitTransfer()})("nzOnCancel",function(){return o.transferModalVisible=!1}),e.DNE(10,Ca,16,8,"div",3),e.k0s(),e.j41(11,"nz-modal",7),e.bIt("nzVisibleChange",function(s){return o.addSignModalVisible=s})("nzOnOk",function(){return o.submitAddSign()})("nzOnCancel",function(){return o.addSignModalVisible=!1}),e.DNE(12,va,26,12,"div",3),e.k0s(),e.j41(13,"nz-modal",8),e.bIt("nzVisibleChange",function(s){return o.returnModalVisible=s})("nzOnOk",function(){return o.submitReturn()})("nzOnCancel",function(){return o.returnModalVisible=!1}),e.DNE(14,wa,16,8,"div",3),e.k0s(),e.j41(15,"nz-modal",9),e.bIt("nzVisibleChange",function(s){return o.resubmitModalVisible=s})("nzOnOk",function(){return o.submitResubmit()})("nzOnCancel",function(){return o.resubmitModalVisible=!1}),e.DNE(16,Ma,6,3,"div",3),e.k0s()),2&i){const r=e.sdS(2);e.Y8G("ngIf",o.selectedInstance)("ngIfElse",r),e.R7$(3),e.Y8G("nzVisible",o.approveModalVisible),e.R7$(2),e.Y8G("nzVisible",o.rejectModalVisible),e.R7$(2),e.Y8G("nzVisible",o.ccModalVisible),e.R7$(2),e.Y8G("nzVisible",o.transferModalVisible),e.R7$(2),e.Y8G("nzVisible",o.addSignModalVisible),e.R7$(2),e.Y8G("nzVisible",o.returnModalVisible),e.R7$(2),e.Y8G("nzVisible",o.resubmitModalVisible)}},dependencies:[d.Sq,d.bT,d.B3,l.me,l.BC,l.vS,v.aO,M.c,T.p,j.LH,y.ld,y.WI,z.Dn,g.F2,g.A9,P.CP,P.SO,P._4,P.IL,P.aj,P.kt,Y.JZ,Y.rE,x.Sy,x.tg,x.c9,x.vN,H.s,I.lx,I.i3,Me.PM,se.RW,cn.r,fe,d.vh,q.$],styles:["[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]{background:#fff;display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]{padding:12px 16px;border-bottom:1px solid #e5e5e5;display:flex;justify-content:space-between;align-items:center;flex-shrink:0}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-left[_ngcontent-%COMP%]   .item-id[_ngcontent-%COMP%]{font-size:14px;color:#666}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-header[_ngcontent-%COMP%]   .header-right[_ngcontent-%COMP%]{display:flex;gap:8px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:16px 16px 70px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:12px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .content-header[_ngcontent-%COMP%]   .content-title[_ngcontent-%COMP%]{margin:0;font-size:25px;font-weight:600;color:#333}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .submitter-info-large[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:12px;padding:12px;background-color:#fafafa;border-radius:4px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .submitter-info-large[_ngcontent-%COMP%]   .avatar-large[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:18px;font-weight:600}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .submitter-info-large[_ngcontent-%COMP%]   .submitter-details[_ngcontent-%COMP%]{display:flex;align-items:flex-end;justify-content:center;gap:4px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .submitter-info-large[_ngcontent-%COMP%]   .submitter-details[_ngcontent-%COMP%]   .submitter-name-large[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .submitter-info-large[_ngcontent-%COMP%]   .submitter-details[_ngcontent-%COMP%]   .submitter-dept[_ngcontent-%COMP%]{font-size:14px;color:#666}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .submitter-info-large[_ngcontent-%COMP%]   .submitter-details[_ngcontent-%COMP%]   .submit-time[_ngcontent-%COMP%]{font-size:13px;color:#999}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]     .ant-tabs-nav{margin-bottom:16px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#333;margin-bottom:16px;padding-bottom:8px;border-bottom:1px solid #e5e5e5}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .detail-descriptions[_ngcontent-%COMP%]     .ant-descriptions-item-label{font-weight:500;color:#666}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .expense-table[_ngcontent-%COMP%]{margin-bottom:16px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .expense-table[_ngcontent-%COMP%]     .ant-table-thead>tr>th{background-color:#fafafa;font-weight:600;color:#333}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .expense-summary[_ngcontent-%COMP%]{background-color:#fafafa;padding:16px;border-radius:6px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .expense-summary[_ngcontent-%COMP%]   .summary-descriptions[_ngcontent-%COMP%]     .ant-descriptions-item-label{font-weight:500;color:#666}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .records-table[_ngcontent-%COMP%]     .ant-table-thead>tr>th{background-color:#fafafa;font-weight:600;color:#333}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .records-table[_ngcontent-%COMP%]   .approval-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .records-table[_ngcontent-%COMP%]   .approval-info[_ngcontent-%COMP%]   .avatar-small[_ngcontent-%COMP%]{width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:10px;font-weight:500}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .records-table[_ngcontent-%COMP%]   .approval-info[_ngcontent-%COMP%]   .approval-name[_ngcontent-%COMP%]{font-size:13px;color:#333}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .detail-content[_ngcontent-%COMP%]   .detail-tabs[_ngcontent-%COMP%]   .tab-content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .records-table[_ngcontent-%COMP%]   .time-info[_ngcontent-%COMP%]   .time-detail[_ngcontent-%COMP%]{font-size:12px;color:#999;margin-top:2px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .fixed-bottom-actions[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;background:white;border-top:1px solid #e5e5e5;display:flex;box-shadow:0 -2px 8px #0000000f;z-index:10;flex-shrink:0;padding:0 16px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .fixed-bottom-actions[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .fixed-bottom-actions[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{margin:12px 4px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comment-form[_ngcontent-%COMP%]{margin-bottom:0;padding:16px;background-color:#fafafa}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comment-form[_ngcontent-%COMP%]     .ant-input-group-wrapper{width:100%}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comment-form[_ngcontent-%COMP%]     .ant-input{border-radius:6px 0 0 6px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comment-form[_ngcontent-%COMP%]     .ant-btn{border-radius:0 6px 6px 0;height:32px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comments-list[_ngcontent-%COMP%]   .comment-item[_ngcontent-%COMP%]{transition:background-color .3s ease;padding:16px;border-bottom:1px solid #f0f0f0}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comments-list[_ngcontent-%COMP%]   .comment-item[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comments-list[_ngcontent-%COMP%]   .comment-item[_ngcontent-%COMP%]:last-child{border-bottom:none;margin-bottom:0}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comments-list[_ngcontent-%COMP%]   .comment-item[_ngcontent-%COMP%]   .comment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comments-list[_ngcontent-%COMP%]   .comment-item[_ngcontent-%COMP%]   .comment-header[_ngcontent-%COMP%]   .comment-user[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comments-list[_ngcontent-%COMP%]   .comment-item[_ngcontent-%COMP%]   .comment-header[_ngcontent-%COMP%]   .comment-user[_ngcontent-%COMP%]   .avatar-small[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:12px;font-weight:500}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comments-list[_ngcontent-%COMP%]   .comment-item[_ngcontent-%COMP%]   .comment-header[_ngcontent-%COMP%]   .comment-user[_ngcontent-%COMP%]   .comment-username[_ngcontent-%COMP%]{font-weight:500;color:#333}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comments-list[_ngcontent-%COMP%]   .comment-item[_ngcontent-%COMP%]   .comment-header[_ngcontent-%COMP%]   .comment-time[_ngcontent-%COMP%]{font-size:12px;color:#999}[_nghost-%COMP%]   .approval-detail[_ngcontent-%COMP%]   .comments-list[_ngcontent-%COMP%]   .comment-item[_ngcontent-%COMP%]   .comment-content[_ngcontent-%COMP%]{color:#333;line-height:1.5;padding-left:32px}  .ant-modal .modal-content .modal-description{margin-bottom:16px;color:#666;font-size:14px}  .ant-modal .modal-content .form-item{margin-bottom:16px}  .ant-modal .modal-content .form-item .form-label{display:block;margin-bottom:8px;font-weight:500;color:#333}  .ant-modal .modal-content .form-item .cc-user-select,   .ant-modal .modal-content .form-item .transfer-user-select,   .ant-modal .modal-content .form-item .add-sign-user-select,   .ant-modal .modal-content .form-item .return-node-select{width:100%}  .ant-modal .modal-content .form-item .add-sign-type-group{width:100%}  .ant-modal .modal-content .form-item .add-sign-type-group label{margin-right:16px;margin-bottom:0}  .ant-modal .modal-content .reason-textarea{width:100%;resize:vertical}  .ant-avatar-string{transform:scale(1) translate(-50%)}  .ant-modal-footer .ant-btn{min-width:80px}@media (max-width: 768px){  .ant-modal{width:90%!important;max-width:400px}  .ant-modal .ant-modal-body{padding:16px}  .ant-modal .ant-modal-footer{padding:12px 16px}  .ant-modal .ant-modal-footer .ant-btn{min-width:70px;height:32px;font-size:14px}.modal-content[_ngcontent-%COMP%]   .form-item[_ngcontent-%COMP%]{margin-bottom:12px}.modal-content[_ngcontent-%COMP%]   .form-item[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{font-size:14px;margin-bottom:6px}.modal-content[_ngcontent-%COMP%]   .reason-textarea[_ngcontent-%COMP%]{font-size:14px}}"]})}}return t})();function za(t,a){if(1&t&&(e.qex(0),e.nrm(1,"nz-option",20),e.bVm()),2&t){const n=a.$implicit;e.R7$(1),e.Y8G("nzValue",n.eruptFlowConfig.id)("nzLabel",n.eruptFlowConfig.name)}}function ya(t,a){1&t&&(e.j41(0,"nz-tag",34),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&t&&(e.R7$(1),e.SpI(" ",e.bMT(2,1,"SUB_FLOW")," "))}function Oa(t,a){if(1&t&&(e.qex(0),e.j41(1,"p",36),e.EFF(2),e.k0s(),e.bVm()),2&t){const n=a.$implicit,i=e.XpG(2).$implicit,o=e.XpG();let r;e.R7$(2),e.JRh(null==(r=o.JSON.parse(null==i?null:i.data))?null:r[n])}}function Fa(t,a){if(1&t&&(e.j41(0,"p",35),e.DNE(1,Oa,3,1,"ng-container",16),e.k0s()),2&t){const n=e.XpG().$implicit;e.R7$(1),e.Y8G("ngForOf",null==n||null==n.eruptFlowConfig||null==n.eruptFlowConfig.setting?null:n.eruptFlowConfig.setting.subTitleFields)}}const Ta=function(t){return{backgroundColor:t}};function Ea(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",21),e.bIt("click",function(){const r=e.eBV(n).$implicit,s=e.XpG();return e.Njj(s.selectInstance(r))}),e.j41(1,"div",22)(2,"h3",23)(3,"p",24),e.EFF(4),e.k0s()(),e.j41(5,"div"),e.DNE(6,ya,3,3,"nz-tag",25),e.j41(7,"nz-tag",26),e.EFF(8),e.nI1(9,"translate"),e.k0s()()(),e.DNE(10,Fa,2,1,"p",27),e.j41(11,"div",28)(12,"div",29),e.nrm(13,"nz-avatar",30),e.j41(14,"span",31),e.EFF(15),e.k0s()(),e.j41(16,"div",32)(17,"span",33),e.EFF(18),e.k0s()()()()}if(2&t){const n=a.$implicit,i=e.XpG();e.AVh("active",(null==n?null:n.id)===(null==i.selectedInstance?null:i.selectedInstance.id)),e.R7$(4),e.JRh(null==n||null==n.eruptFlowConfig?null:n.eruptFlowConfig.name),e.R7$(2),e.Y8G("ngIf",null==n?null:n.parent),e.R7$(2),e.SpI(" ",e.bMT(9,11,null==n?null:n.status)," "),e.R7$(2),e.Y8G("ngIf",(null==n||null==n.eruptFlowConfig||null==n.eruptFlowConfig.setting||null==n.eruptFlowConfig.setting.subTitleFields?null:n.eruptFlowConfig.setting.subTitleFields.length)&&(null==n?null:n.data)),e.R7$(3),e.Y8G("nzText",null==n||null==n.initiatorUser?null:n.initiatorUser.name.substring(0,1))("ngStyle",e.eq3(13,Ta,i.getAvatarColor(null==n||null==n.initiatorUser.name?null:n.initiatorUser.name.substring(0,1))))("nzSrc",null==n||null==n.initiatorUser?null:n.initiatorUser.avatar),e.R7$(2),e.JRh(null==n||null==n.initiatorUser?null:n.initiatorUser.name),e.R7$(3),e.SpI(" ",null==n?null:n.createTime," ")}}const Na=[{path:"management",component:lr},{path:"dashboard",component:Tr},{path:"approval",component:(()=>{class t{constructor(n,i){this.settingSrv=n,this.flowInstanceApiService=i,this.selectedView=V.TODO,this.flowInstances=[],this.todoCount=0,this.selectFlow=null,this.uniqFlowInstances=o=>[...new Map(o.map(r=>[r.eruptFlowConfig.id,r])).values()],this.ApprovalView=V,this.NodeType=h,this.getAvatarColor=Ae,this.JSON=JSON}ngOnInit(){this.loadFlows(V.TODO)}selectInstance(n){this.selectedInstance=n,this.approvalDetail.onSelectFlow(this.selectedView,this.selectedInstance)}onSelectFlow(n){this.loadFlows(this.selectedView,n)}loadFlows(n,i=null,o=!0){this.selectedView=n,this.selectFlow=i,this.selectedInstance=null,this.flowInstanceApiService.list({approvalView:this.selectedView,flowId:i}).subscribe({next:r=>{this.flowInstances=r.data,o&&(this.selectedInstance=this.flowInstances[0]||null,this.selectInstance(this.selectedInstance)),this.selectedView==V.TODO&&(this.todoCount=this.flowInstances.length)}})}reloadFlows(){this.loadFlows(this.selectedView,null,!0)}static{this.\u0275fac=function(i){return new(i||t)(e.rXU(pe.h$),e.rXU(he))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-flow-approval"]],viewQuery:function(i,o){if(1&i&&e.GBs(Se,5),2&i){let r;e.mGM(r=e.lsd())&&(o.approvalDetail=r.first)}},decls:34,vars:23,consts:[[1,"flow-approval-container"],[1,"sidebar"],[1,"navigation-menu"],["nz-menu","","nzMode","inline",1,"approval-menu"],["nz-menu-item","",3,"nzSelected","click"],[2,"display","flex","align-items","center"],["nz-icon","","nzType","clock-circle","nzTheme","outline"],[1,"menu-title"],[1,"menu-badge",2,"margin-left","auto",3,"nzCount"],["nz-icon","","nzType","check-circle","nzTheme","outline"],["nz-icon","","nzType","copy","nzTheme","outline"],["nz-icon","","nzType","rocket","nzTheme","outline"],[1,"main-content"],[1,"list-section"],[1,"list-header"],["nzBorderless","","nzAllowClear","",2,"width","100%",3,"ngModel","nzPlaceHolder","ngModelChange"],[4,"ngFor","ngForOf"],[1,"approval-list"],["class","approval-item",3,"active","click",4,"ngFor","ngForOf"],[1,"detail-section",3,"reloadFlows"],[3,"nzValue","nzLabel"],[1,"approval-item",3,"click"],[1,"item-header"],[1,"item-title"],[2,"margin-bottom","0"],["nzColor","orange","style","margin-right: 6px",4,"ngIf"],[2,"margin-right","0"],["style","margin-bottom: 8px;",4,"ngIf"],[1,"item-footer"],[1,"submitter-info"],["nzSize","small",3,"nzText","ngStyle","nzSrc"],[1,"submitter-name"],[1,"time-info"],[1,"process-time"],["nzColor","orange",2,"margin-right","6px"],[2,"margin-bottom","8px"],[2,"margin-bottom","0.25em"]],template:function(i,o){1&i&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"ul",3)(4,"li",4),e.bIt("click",function(){return o.loadFlows(o.ApprovalView.TODO)}),e.j41(5,"div",5),e.nrm(6,"span",6),e.j41(7,"span",7),e.EFF(8),e.nI1(9,"translate"),e.k0s(),e.nrm(10,"nz-badge",8),e.k0s()(),e.j41(11,"li",4),e.bIt("click",function(){return o.loadFlows(o.ApprovalView.DONE)}),e.nrm(12,"span",9),e.j41(13,"span",7),e.EFF(14),e.nI1(15,"translate"),e.k0s()(),e.j41(16,"li",4),e.bIt("click",function(){return o.loadFlows(o.ApprovalView.CC)}),e.nrm(17,"span",10),e.j41(18,"span",7),e.EFF(19),e.nI1(20,"translate"),e.k0s()(),e.j41(21,"li",4),e.bIt("click",function(){return o.loadFlows(o.ApprovalView.CREATED)}),e.nrm(22,"span",11),e.j41(23,"span",7),e.EFF(24),e.nI1(25,"translate"),e.k0s()()()()(),e.j41(26,"div",12)(27,"div",13)(28,"div",14)(29,"nz-select",15),e.bIt("ngModelChange",function(s){return o.selectFlow=s})("ngModelChange",function(s){return o.onSelectFlow(s)}),e.DNE(30,za,2,2,"ng-container",16),e.k0s()(),e.j41(31,"div",17),e.DNE(32,Ea,19,15,"div",18),e.k0s()(),e.j41(33,"flow-approval-detail",19),e.bIt("reloadFlows",function(){return o.reloadFlows()}),e.k0s()()()),2&i&&(e.xc7("height","calc(100vh - "+(o.settingSrv.layout.reuse?"84px":"44px")+")"),e.R7$(4),e.Y8G("nzSelected",o.ApprovalView.TODO===o.selectedView),e.R7$(4),e.JRh(e.bMT(9,15,"FLOW_TODO")),e.R7$(2),e.Y8G("nzCount",o.todoCount),e.R7$(1),e.Y8G("nzSelected",o.ApprovalView.DONE===o.selectedView),e.R7$(3),e.JRh(e.bMT(15,17,"FLOW_DONE")),e.R7$(2),e.Y8G("nzSelected",o.ApprovalView.CC===o.selectedView),e.R7$(3),e.JRh(e.bMT(20,19,"CC")),e.R7$(2),e.Y8G("nzSelected",o.ApprovalView.CREATED===o.selectedView),e.R7$(3),e.JRh(e.bMT(25,21,"CREATED")),e.R7$(5),e.Y8G("ngModel",o.selectFlow)("nzPlaceHolder","\u6d41\u7a0b\u7b5b\u9009"),e.R7$(1),e.Y8G("ngForOf",o.uniqFlowInstances(o.flowInstances)),e.R7$(2),e.Y8G("ngForOf",o.flowInstances))},dependencies:[d.Sq,d.bT,d.B3,l.BC,l.vS,M.c,we.jS,we.CU,y.ld,y.WI,z.Dn,De.dz,H.s,Me.PM,Se,q.$],styles:["[_nghost-%COMP%]     .flow-approval-container{display:flex;background-color:#f5f5f5;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;overflow:hidden}[_nghost-%COMP%]     .flow-approval-container .sidebar{width:180px;height:100%;background:white;border-right:1px solid #e5e5e5;display:flex;flex-direction:column;transition:all .3s ease;flex-shrink:0}[_nghost-%COMP%]     .flow-approval-container .sidebar.collapsed{width:80px}[_nghost-%COMP%]     .flow-approval-container .sidebar.collapsed .search-text, [_nghost-%COMP%]     .flow-approval-container .sidebar.collapsed .menu-title, [_nghost-%COMP%]     .flow-approval-container .sidebar.collapsed .collapse-text{display:none}[_nghost-%COMP%]     .flow-approval-container .sidebar.collapsed .approval-menu .ant-menu-item, [_nghost-%COMP%]     .flow-approval-container .sidebar.collapsed .approval-menu .ant-menu-submenu-title{justify-content:center;padding:0}[_nghost-%COMP%]     .flow-approval-container .sidebar .sidebar-header{padding:13px;border-bottom:1px solid #e5e5e5;display:flex;align-items:center;justify-content:space-between;flex-shrink:0}[_nghost-%COMP%]     .flow-approval-container .sidebar .sidebar-header .search-section{display:flex;align-items:center;gap:8px;color:#666;font-size:14px}[_nghost-%COMP%]     .flow-approval-container .sidebar .sidebar-header .menu-toggle{color:#666}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu{flex:1}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu{border:none;background:transparent}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-item{height:48px;line-height:48px;margin:0;padding:0 16px;display:flex;align-items:center;gap:12px;transition:all .3s ease}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-item:hover{background-color:#f5f5f5}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-item.ant-menu-item-selected{background-color:#e6f7ff;color:#1890ff;font-weight:500}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-item .menu-title{flex:1;font-size:14px;color:inherit}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-item .menu-badge{margin-left:auto}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-submenu .ant-menu-submenu-title{height:48px;line-height:48px;margin:0;padding:0 16px;display:flex;align-items:center;gap:12px;transition:all .3s ease}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-submenu .ant-menu-submenu-title:hover{background-color:#f5f5f5}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-submenu .ant-menu-submenu-title .ant-menu-title-content{flex:1;font-size:14px;color:#333}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-submenu .ant-menu-sub{background-color:#fafafa;border-left:2px solid #e6f7ff}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-submenu .ant-menu-sub .ant-menu-item{padding-left:48px;font-size:13px;color:#666}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-submenu .ant-menu-sub .ant-menu-item:hover{background-color:#e5e5e5}[_nghost-%COMP%]     .flow-approval-container .sidebar .navigation-menu .approval-menu .ant-menu-submenu .ant-menu-sub .ant-menu-item.ant-menu-item-selected{background-color:#e6f7ff;color:#1890ff;font-weight:500}[_nghost-%COMP%]     .flow-approval-container .sidebar .sidebar-footer{padding:16px;border-top:1px solid #e5e5e5;flex-shrink:0}[_nghost-%COMP%]     .flow-approval-container .sidebar .sidebar-footer .collapse-text{margin-left:8px;font-size:14px;color:#666}[_nghost-%COMP%]     .flow-approval-container .main-content{flex:1;height:100%;display:flex;overflow:hidden}[_nghost-%COMP%]     .flow-approval-container .main-content .list-section{width:260px;height:100%;background:white;border-right:1px solid #e5e5e5;display:flex;flex-direction:column;flex-shrink:0}[_nghost-%COMP%]     .flow-approval-container .main-content .list-section .list-header{padding:8px 0;border-bottom:1px solid #e5e5e5;display:flex;align-items:center;gap:12px;flex-shrink:0}[_nghost-%COMP%]     .flow-approval-container .main-content .list-section .copy-icon{margin-left:6px;font-size:14px;color:#8c8c8c;vertical-align:middle;transition:color .2s}[_nghost-%COMP%]     .flow-approval-container .main-content .list-section .item-id:hover .copy-icon{color:#1890ff}[_nghost-%COMP%]     .flow-approval-container .main-content .list-section .time-filter{display:flex;align-items:center;gap:8px;font-size:14px;color:#333;cursor:pointer}[_nghost-%COMP%]     .flow-approval-container .main-content .list-section .separator{width:1px;height:16px;background-color:#d9d9d9}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list{flex:1;overflow-y:auto}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item{padding:12px;cursor:pointer;transition:all .3s ease;border-bottom:1px solid #e5e5e5}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item:hover{background-color:#fafafa}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item.active{background-color:#e6f7ff;box-shadow:0 2px 8px #1890ff26}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-header .item-title{margin:0;font-size:16px;font-weight:600;color:#333}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-header .status-tag{font-size:12px}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-content{margin-bottom:12px}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-content .item-field{display:flex;margin-bottom:6px;font-size:13px}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-content .item-field .field-label{color:#666;min-width:80px;flex-shrink:0}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-content .item-field .field-value{color:#333;flex:1}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-footer{display:flex;justify-content:space-between;align-items:center}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-footer .submitter-info{display:flex;align-items:center;gap:8px}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-footer .submitter-info .submitter-name{font-size:13px;color:#333}[_nghost-%COMP%]     .flow-approval-container .main-content .approval-list .approval-item .item-footer .time-info .process-time{font-size:12px;color:#999}[_nghost-%COMP%]     .flow-approval-container .detail-section{flex:1;height:100%;background:white;display:flex;flex-direction:column;overflow-y:auto;position:relative}[_nghost-%COMP%]   .node-info[_ngcontent-%COMP%]   .node-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;background-color:#f8f9fa;border-radius:6px;margin-bottom:12px}[_nghost-%COMP%]   .node-info[_ngcontent-%COMP%]   .node-item[_ngcontent-%COMP%]   .node-name[_ngcontent-%COMP%]{font-weight:500;color:#333}[_nghost-%COMP%]   .node-info[_ngcontent-%COMP%]   .node-item[_ngcontent-%COMP%]   .node-type[_ngcontent-%COMP%]{padding:4px 8px;background-color:#e6f7ff;color:#1890ff;border-radius:4px;font-size:12px}[_nghost-%COMP%]   .node-info[_ngcontent-%COMP%]   .node-branches[_ngcontent-%COMP%]{margin-left:24px}[_nghost-%COMP%]   .node-info[_ngcontent-%COMP%]   .node-branches[_ngcontent-%COMP%]   .branch-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;margin-bottom:8px;background-color:#fafafa;border-radius:4px;border-left:3px solid #d9d9d9}[_nghost-%COMP%]   .node-info[_ngcontent-%COMP%]   .node-branches[_ngcontent-%COMP%]   .branch-item[_ngcontent-%COMP%]   .branch-name[_ngcontent-%COMP%]{font-weight:500;color:#333}[_nghost-%COMP%]   .node-info[_ngcontent-%COMP%]   .node-branches[_ngcontent-%COMP%]   .branch-item[_ngcontent-%COMP%]   .branch-type[_ngcontent-%COMP%]{padding:2px 6px;background-color:#f0f0f0;color:#666;border-radius:3px;font-size:11px}"]})}}return t})()},{path:"approval-detail/:no",pathMatch:"full",component:Se}];let Pa=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({imports:[Ie.iI.forChild(Na),Ie.iI]})}}return t})();var ka=c(2602),Ia=c(4959),Ga=c(142);let Sa=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({providers:[S,me,W,Fe],imports:[Te.Rh,Ia.G,Pa,d.MD,l.YN,l.X1,be.q1,D.ad,v.Zw,x.j,k.eq,R.Sg,z.Y3,ie.kT,Q.PQ,y.DH,K.IJ,I.Sw,Z.LE,ve.eT,f.$,G.Sk,_.jw,w.SE,g.U6,N.g9,j.Qt,xe.MC,re.Ti,je.g,_n.pc,Ve.f3,un.z6,we.GP,gn.ZJ,Y.hM,P.$G,mn.rD,Me.Yb,De.W2,H.T,fn.m,ae.V,hn.i3,Cn.$,bn.K9,vn.sH,se._v,xn.WF,wn.ki,Mn.Qb,zn.GB,yn.xQ,On.WN,Fn.x2,Tn.$f,En.jl,ze.GP,ka.Cu,Ga.EruptModule,cn.et]})}}return t})();e.wjB($.Y,[d.YU,d.bT,l.me,l.BC,l.vS,v.aO,M.c,T.p,j.LH,z.Dn,k.vg,k.wk,rn],[]),e.wjB(Be,[d.YU,d.bT,l.me,l.BC,l.vS,M.c,j.LH,z.Dn,ie.Di,rn],[])},9252:(te,oe,c)=>{c.d(oe,{Y:()=>ve});var l=c(7705);te=c.hmd(te);const be=["nodeNameInput"];function D(f,G){if(1&f&&(l.qex(0),l.nrm(1,"span",8),l.bVm()),2&f){const _=l.XpG();l.R7$(1),l.Y8G("nzTooltipTitle",_.model.error)("nzTwotoneColor","#FF4D4F")}}function v(f,G){if(1&f){const _=l.RV6();l.j41(0,"input",16,17),l.bIt("blur",function(){l.eBV(_);const g=l.XpG(2);return l.Njj(g.onBlur())})("ngModelChange",function(g){l.eBV(_);const N=l.XpG(2);return l.Njj(N.model.name=g)}),l.k0s()}if(2&f){const _=l.XpG(2);l.Y8G("ngModel",_.model.name)}}function x(f,G){if(1&f){const _=l.RV6();l.j41(0,"div",18),l.bIt("click",function(){l.eBV(_);const g=l.XpG(2);return l.Njj(g.onEnableEdit())}),l.EFF(1),l.k0s()}if(2&f){const _=l.XpG(2);l.R7$(1),l.SpI("",_.model.name," ")}}function k(f,G){if(1&f){const _=l.RV6();l.j41(0,"span",19),l.bIt("click",function(){l.eBV(_);const g=l.XpG(2);return l.Njj(g.onDelete())}),l.k0s()}}function R(f,G){1&f&&l.nrm(0,"span",20)}function z(f,G){if(1&f){const _=l.RV6();l.j41(0,"div",9)(1,"div",10)(2,"div"),l.DNE(3,v,2,1,"input",11),l.DNE(4,x,2,1,"div",12),l.k0s(),l.DNE(5,k,1,0,"span",13),l.k0s(),l.j41(6,"div",14),l.bIt("click",function(){l.eBV(_);const g=l.XpG();return l.Njj(g.onSelect())}),l.SdG(7),l.DNE(8,R,1,0,"span",15),l.k0s()()}if(2&f){const _=l.XpG();l.xc7("background",_.headerColor)("--shadowColor",_.headerColor),l.Y8G("ngClass",null==_.progress?null:_.progress[_.model.id]),l.R7$(1),l.xc7("background-color",_.headerColor),l.R7$(2),l.Y8G("ngIf",_.enableEdit),l.R7$(1),l.Y8G("ngIf",!_.enableEdit),l.R7$(1),l.Y8G("ngIf",_.showClose&&!_.readonly),l.R7$(3),l.Y8G("ngIf",_.hasConfig&&!_.readonly)}}function ie(f,G){if(1&f){const _=l.RV6();l.j41(0,"app-insert-btn",21),l.bIt("insertNode",function(g){l.eBV(_);const N=l.XpG();return l.Njj(N.onInsertNode(g))})("insertFlexNode",function(g){l.eBV(_);const N=l.XpG();return l.Njj(N.onInsertFlexNode(g))}),l.k0s()}}function Q(f,G){1&f&&(l.qex(0),l.SdG(1,1),l.bVm())}function y(f,G){if(1&f){const _=l.RV6();l.j41(0,"div",22)(1,"button",23),l.bIt("click",function(){l.eBV(_);const g=l.XpG();return l.Njj(g.close())}),l.EFF(2,"Cancel"),l.k0s(),l.j41(3,"button",24),l.bIt("click",function(){l.eBV(_);const g=l.XpG();return l.Njj(g.save())}),l.EFF(4,"Save"),l.k0s()()}}const K=["*",[["","config",""]]],I=function(){return{padding:"16px"}},Z=["*","[config]"];let ve=(()=>{class f{constructor(){this.headerColor="",this.headerIcon="",this.content="",this.readonly=!1,this.showClose=!0,this.showBody=!0,this.hasConfig=!0,this.modelChange=new l.bkB,this.select=new l.bkB,this.delete=new l.bkB,this.insertNode=new l.bkB,this.saveProp=new l.bkB,this.insertFlexNode=new l.bkB,this.showDrawer=!1,this.enableEdit=!1,this.process=te}ngAfterViewInit(){}onEnableEdit(){this.readonly||(this.enableEdit=!0,setTimeout(()=>{this.nodeNameInput&&this.nodeNameInput.nativeElement.focus()}))}onBlur(){this.enableEdit=!1}onSelect(){!this.hasConfig||this.readonly||(this.model.error=null,this.showDrawer=!0,this.select.emit())}onDelete(){this.delete.emit()}onInsertNode(_){this.insertNode.emit(_)}onInsertFlexNode(_){this.insertFlexNode.emit(_)}close(){this.showDrawer=!1}save(){this.saveProp.emit(),this.showDrawer=!1}static{this.\u0275fac=function(w){return new(w||f)}}static{this.\u0275cmp=l.VBU({type:f,selectors:[["erupt-node"]],viewQuery:function(w,g){if(1&w&&l.GBs(be,5),2&w){let N;l.mGM(N=l.lsd())&&(g.nodeNameInput=N.first)}},inputs:{eruptBuild:"eruptBuild",headerColor:"headerColor",headerIcon:"headerIcon",content:"content",readonly:"readonly",model:"model",showClose:"showClose",showBody:"showBody",hasConfig:"hasConfig",progress:"progress"},outputs:{modelChange:"modelChange",select:"select",delete:"delete",insertNode:"insertNode",saveProp:"saveProp",insertFlexNode:"insertFlexNode"},ngContentSelectors:Z,decls:9,vars:9,consts:[[1,"p-node"],[4,"ngIf"],["class","p-node-body",3,"ngClass","background","--shadowColor",4,"ngIf"],[1,"p-node-add"],[3,"insertNode","insertFlexNode",4,"ngIf"],["nzPlacement","right",3,"nzVisible","nzTitle","nzBodyStyle","nzFooter","nzWidth","nzOnClose"],[4,"nzDrawerContent"],["footerTpl",""],["nz-tooltip","","nz-icon","","nzType","warning","nzTheme","twotone",1,"node-err-tip",3,"nzTooltipTitle","nzTwotoneColor"],[1,"p-node-body",3,"ngClass"],[1,"p-node-header"],["style","color: #000;","autofocus","",3,"ngModel","blur","ngModelChange",4,"ngIf"],["class","row-text",3,"click",4,"ngIf"],["class","fa fa-close",3,"click",4,"ngIf"],[1,"p-node-content",3,"click"],["nz-icon","","nzType","arrow-right","class","w-p-node-click",4,"ngIf"],["autofocus","",2,"color","#000",3,"ngModel","blur","ngModelChange"],["nodeNameInput",""],[1,"row-text",3,"click"],[1,"fa","fa-close",3,"click"],["nz-icon","","nzType","arrow-right",1,"w-p-node-click"],[3,"insertNode","insertFlexNode"],[2,"float","right"],["nz-button","",2,"margin-right","8px",3,"click"],["nz-button","","nzType","primary",3,"click"]],template:function(w,g){if(1&w&&(l.NAR(K),l.j41(0,"div",0),l.DNE(1,D,2,2,"ng-container",1),l.DNE(2,z,9,11,"div",2),l.j41(3,"div",3),l.DNE(4,ie,1,0,"app-insert-btn",4),l.k0s()(),l.j41(5,"nz-drawer",5),l.bIt("nzOnClose",function(){return g.close()}),l.DNE(6,Q,2,0,"ng-container",6),l.k0s(),l.DNE(7,y,5,0,"ng-template",null,7,l.C5r)),2&w){const N=l.sdS(8);l.R7$(1),l.Y8G("ngIf",null==g.model?null:g.model.error),l.R7$(1),l.Y8G("ngIf",g.showBody),l.R7$(2),l.Y8G("ngIf",!g.readonly),l.R7$(1),l.Y8G("nzVisible",g.showDrawer)("nzTitle",null==g.model?null:g.model.name)("nzBodyStyle",l.lJ4(8,I))("nzFooter",N)("nzWidth",600)}},styles:['.p-node[_ngcontent-%COMP%]{width:200px;margin-bottom:8px;position:relative}.p-node[_ngcontent-%COMP%]   .node-err-tip[_ngcontent-%COMP%]{z-index:9;position:absolute;right:-30px;top:5px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]{cursor:pointer;background:white;overflow:hidden;border-radius:5px;box-shadow:0 0 5px #d8d8d8}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:0 10px;color:#fff;height:25px;font-size:13px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   .row-text[_ngcontent-%COMP%]:hover{text-decoration:underline}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   .node-del[_ngcontent-%COMP%]{display:none}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:flex;align-items:center}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%] > div[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{margin-left:3px;width:150px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:150px;border:none;border-radius:5px}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-header[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-content[_ngcontent-%COMP%]{padding:7px 6px 7px 7px;min-height:40px;display:flex;justify-content:space-between;align-items:center;font-size:15px;background:white;margin:0 4px 4px;border-radius:5px;color:#656363;position:relative}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]   .p-node-content[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:92%;word-wrap:break-word}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]:hover{box-shadow:0 0 5px 0 var(--shadowColor)}.p-node[_ngcontent-%COMP%]   .p-node-body[_ngcontent-%COMP%]:hover   .node-del[_ngcontent-%COMP%]{display:inline}.p-node[_ngcontent-%COMP%]   .p-node-add[_ngcontent-%COMP%]{position:relative;display:flex;justify-content:center;align-items:center;height:80px}.p-node[_ngcontent-%COMP%]   .p-node-add[_ngcontent-%COMP%]:before{position:absolute;content:"";width:3px;height:80px;background:#d9d9d9}.p-node[_ngcontent-%COMP%]   .p-node-add[_ngcontent-%COMP%]:after{content:"";position:absolute;top:80px;left:50%;transform:translate(-50%);width:0;border-style:solid;border-width:8px 6px 4px;border-color:#d9d9d9 transparent transparent}']})}}return f})()}}]);